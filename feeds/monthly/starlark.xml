<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"><channel><title>GitHub Trending: Starlark, This month</title><link>https://github.com/trending/starlark?since=monthly</link><description>The top repositories on GitHub for starlark, measured monthly</description><pubDate>Thu, 06 Feb 2020 01:10:44 GMT</pubDate><lastBuildDate>Thu, 06 Feb 2020 01:10:44 GMT</lastBuildDate><generator>PyRSS2Gen-1.1.0</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><ttl>720</ttl><item><title>googleapis/googleapis #1 in Starlark, This month</title><link>https://github.com/googleapis/googleapis</link><description>&lt;p&gt;&lt;i&gt;Public interface definitions of Google APIs.&lt;/i&gt;&lt;/p&gt;&lt;div id="readme" class="md" data-path="README.md"&gt;&lt;article class="markdown-body entry-content p-5" itemprop="text"&gt;&lt;h1&gt;&lt;a id="user-content-google-apis" class="anchor" aria-hidden="true" href="#google-apis"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Google APIs&lt;/h1&gt;
&lt;p&gt;This repository contains the original interface definitions of public
Google APIs that support both REST and gRPC protocols. Reading the
original interface definitions can provide a better understanding of
Google APIs and help you to utilize them more efficiently. You can also
use these definitions with open source tools to generate client
libraries, documentation, and other artifacts.&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-building" class="anchor" aria-hidden="true" href="#building"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Building&lt;/h2&gt;
&lt;h3&gt;&lt;a id="user-content-bazel" class="anchor" aria-hidden="true" href="#bazel"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Bazel&lt;/h3&gt;
&lt;p&gt;The recommended way to build the API client libraries is through
&lt;a href="https://bazel.build/" rel="nofollow"&gt;Bazel&lt;/a&gt; &amp;gt;= 2.0.0.&lt;/p&gt;
&lt;p&gt;First, &lt;a href="https://docs.bazel.build/versions/master/install.html" rel="nofollow"&gt;install bazel&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To build all libraries:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bazel build //...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;To test all libraries:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bazel test //...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;To build one library in all languages:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bazel build //google/example/library/v1/...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;To build the Java package for one library:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bazel build //google/example/library/v1:google-cloud-library-v1-java
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Bazel packages exist in all the libraries for Java, Go, Python, Ruby, Node.js, PHP and C#.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-artman" class="anchor" aria-hidden="true" href="#artman"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Artman&lt;/h3&gt;
&lt;p&gt;API client libraries can be built directly from files in this repo using
&lt;a href="https://github.com/googleapis/artman"&gt;Artman&lt;/a&gt;. The latest generation status can
be tracked &lt;a href="https://circleci.com/gh/googleapis/googleapis" rel="nofollow"&gt;here&lt;/a&gt; which currently
has status &lt;a href="https://circleci.com/gh/googleapis/googleapis" rel="nofollow"&gt;&lt;img src="https://camo.githubusercontent.com/f0d5dc44605e60aac4050e897c24a1f1de9810e3/68747470733a2f2f636972636c6563692e636f6d2f67682f676f6f676c65617069732f676f6f676c65617069732e7376673f7374796c653d737667" alt="CircleCI" data-canonical-src="https://circleci.com/gh/googleapis/googleapis.svg?style=svg" style="max-width:100%;"&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To build the Java package for one library:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;artman --config google/example/library/artman_library_example_v1.yaml generate java_gapic
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Artman can only build one library in one language at a time.&lt;/p&gt;
&lt;p&gt;For more details on all Google APIs and developer tools, see the &lt;a href="https://developers.google.com/products/" rel="nofollow"&gt;Google
Developers&lt;/a&gt; site.&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-overview" class="anchor" aria-hidden="true" href="#overview"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Overview&lt;/h2&gt;
&lt;p&gt;Google APIs are typically deployed as API services that are hosted
under different DNS names. One API service may implement multiple APIs
and multiple versions of the same API.&lt;/p&gt;
&lt;p&gt;Google APIs use &lt;a href="https://github.com/google/protobuf"&gt;Protocol Buffers&lt;/a&gt;
version 3 (proto3) as their Interface Definition Language (IDL) to
define the API interface and the structure of the payload messages. The
same interface definition is used for both REST and RPC versions of the
API, which can be accessed over different wire protocols.&lt;/p&gt;
&lt;p&gt;There are several ways of accessing Google APIs:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;JSON over HTTP: You can access all Google APIs directly using JSON
over HTTP, using
&lt;a href="https://developers.google.com/api-client-library" rel="nofollow"&gt;Google API client library&lt;/a&gt;
or third-party API client libraries.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Protocol Buffers over gRPC: You can access Google APIs published
in this repository through &lt;a href="https://github.com/grpc"&gt;GRPC&lt;/a&gt;, which is
a high-performance binary RPC protocol over HTTP/2. It offers many
useful features, including request/response multiplex and full-duplex
streaming.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://cloud.google.com/apis/docs/cloud-client-libraries" rel="nofollow"&gt;Google Cloud Client Libraries&lt;/a&gt;:
You can use these libraries to access Google Cloud APIs. They are based
on gRPC for better performance and provide idiomatic client surface for
better developer experience.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;&lt;a id="user-content-discussions" class="anchor" aria-hidden="true" href="#discussions"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Discussions&lt;/h2&gt;
&lt;p&gt;This repo contains copies of Google API definitions and related files.  For
discussions or to raise issues about
&lt;a href="https://github.com/googleapis"&gt;Google API client libraries&lt;/a&gt;,
&lt;a href="https://github.com/grpc"&gt;GRPC&lt;/a&gt; or
&lt;a href="https://github.com/googlecloudplatform"&gt;Google Cloud Client Libraries&lt;/a&gt; please
refer to the repos associated with each area.&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-repository-structure" class="anchor" aria-hidden="true" href="#repository-structure"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Repository Structure&lt;/h2&gt;
&lt;p&gt;This repository uses a directory hierarchy that reflects the Google
API product structure. In general, every API has its own root
directory, and each major version of the API has its own subdirectory.
The proto package names exactly match the directory: this makes it
easy to locate the proto definitions and ensures that the generated
client libraries have idiomatic namespaces in most programming
languages. Alongside the API directories live the configuration files
for the &lt;a href="https://github.com/googleapis/toolkit"&gt;GAPIC toolkit&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; The major version of an API is used to indicate breaking
change to the API.&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-generate-grpc-source-code" class="anchor" aria-hidden="true" href="#generate-grpc-source-code"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Generate gRPC Source Code&lt;/h2&gt;
&lt;p&gt;To generate gRPC source code for Google APIs in this repository, you
first need to install both Protocol Buffers and gRPC on your local
machine, then you can run &lt;code&gt;make LANGUAGE=xxx all&lt;/code&gt; to generate the
source code. You need to integrated the generated source code into
your application build system.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; The Makefile is only intended to generate source code for the
entire repository. It is not for generating linkable client library
for a specific API. Please see other repositories under
&lt;a href="https://github.com/googleapis"&gt;https://github.com/googleapis&lt;/a&gt; for generating linkable client libraries.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-go-grpc-source-code" class="anchor" aria-hidden="true" href="#go-grpc-source-code"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Go gRPC Source Code&lt;/h3&gt;
&lt;p&gt;It is difficult to generate Go gRPC source code from this repository,
since Go has different directory structure.
Please use &lt;a href="https://github.com/google/go-genproto"&gt;this repository&lt;/a&gt; instead.&lt;/p&gt;
&lt;/article&gt;&lt;/div&gt;</description><author>googleapis</author><guid isPermaLink="false">https://github.com/googleapis/googleapis</guid><pubDate>Thu, 06 Feb 2020 00:01:00 GMT</pubDate></item><item><title>bazelbuild/rules_docker #2 in Starlark, This month</title><link>https://github.com/bazelbuild/rules_docker</link><description>&lt;p&gt;&lt;i&gt;Rules for building and handling Docker images with Bazel&lt;/i&gt;&lt;/p&gt;&lt;div id="readme" class="md" data-path="README.md"&gt;&lt;article class="markdown-body entry-content p-5" itemprop="text"&gt;&lt;h1&gt;&lt;a id="user-content-bazel-container-image-rules" class="anchor" aria-hidden="true" href="#bazel-container-image-rules"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Bazel Container Image Rules&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="center"&gt;Travis CI&lt;/th&gt;
&lt;th align="center"&gt;Bazel CI&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="center"&gt;&lt;a href="https://travis-ci.org/bazelbuild/rules_docker" rel="nofollow"&gt;&lt;img src="https://camo.githubusercontent.com/54a3dc6d39ba4cdb23a8a7eca16181e71452e9ab/68747470733a2f2f7472617669732d63692e6f72672f62617a656c6275696c642f72756c65735f646f636b65722e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/bazelbuild/rules_docker.svg?branch=master" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td align="center"&gt;&lt;a href="https://buildkite.com/bazel/docker-rules-docker-postsubmit" rel="nofollow"&gt;&lt;img src="https://camo.githubusercontent.com/1d2007497973d8ec7c8783d208a7a030b8985e7f/68747470733a2f2f62616467652e6275696c646b6974652e636f6d2f36393364373839323235306366643434626565613363643935353733333838323030393335393036613238636433313436642e737667" alt="Build status" data-canonical-src="https://badge.buildkite.com/693d7892250cfd44beea3cd95573388200935906a28cd3146d.svg" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2&gt;&lt;a id="user-content-basic-rules" class="anchor" aria-hidden="true" href="#basic-rules"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Basic Rules&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#container_image-1"&gt;container_image&lt;/a&gt; (&lt;a href="#container_image"&gt;example&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href="#container_bundle-1"&gt;container_bundle&lt;/a&gt; (&lt;a href="#container_bundle"&gt;example&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href="#container_import"&gt;container_import&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#container_load"&gt;container_load&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#container_pull-1"&gt;container_pull&lt;/a&gt; (&lt;a href="#container_pull"&gt;example&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href="#container_push-1"&gt;container_push&lt;/a&gt; (&lt;a href="#container_push"&gt;example&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These rules used to be &lt;code&gt;docker_build&lt;/code&gt;, &lt;code&gt;docker_push&lt;/code&gt;, etc. and the aliases for
these (mostly) legacy names still exist largely for backwards-compatibility.  We
also have &lt;strong&gt;early-stage&lt;/strong&gt; &lt;code&gt;oci_image&lt;/code&gt;, &lt;code&gt;oci_push&lt;/code&gt;, etc. aliases for folks that
enjoy the consistency of a consistent rule prefix.  The only place the
format-specific names currently do any more than alias things is in &lt;code&gt;foo_push&lt;/code&gt;,
where they also specify the appropriate format as which to publish the image.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-overview" class="anchor" aria-hidden="true" href="#overview"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Overview&lt;/h3&gt;
&lt;p&gt;This repository contains a set of rules for pulling down base images, augmenting
them with build artifacts and assets, and publishing those images.
&lt;strong&gt;These rules do not require / use Docker for pulling, building, or pushing
images.&lt;/strong&gt;  This means:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;They can be used to develop Docker containers on OSX without
&lt;code&gt;boot2docker&lt;/code&gt; or &lt;code&gt;docker-machine&lt;/code&gt; installed. Note use of these rules on Windows
is currently not supported.&lt;/li&gt;
&lt;li&gt;They do not require root access on your workstation.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Also, unlike traditional container builds (e.g. Dockerfile), the Docker images
produced by &lt;code&gt;container_image&lt;/code&gt; are deterministic / reproducible.&lt;/p&gt;
&lt;p&gt;To get started with building Docker images, check out the
&lt;a href="https://github.com/bazelbuild/rules_docker/tree/master/testing/examples"&gt;examples&lt;/a&gt;
that build the same images using both rules_docker and a Dockerfile.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; &lt;code&gt;container_push&lt;/code&gt; and &lt;code&gt;container_pull&lt;/code&gt; make use of
&lt;a href="https://github.com/google/containerregistry"&gt;google/containerregistry&lt;/a&gt; for
registry interactions.&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-language-rules" class="anchor" aria-hidden="true" href="#language-rules"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Language Rules&lt;/h2&gt;
&lt;p&gt;Note: Some of these rules are not supported on Mac. Specifically &lt;code&gt;go_image&lt;/code&gt;
cannot be used from Bazel running on a Mac. Other rules may also fail
arbitrarily on Mac due to unforseen toolchain issues that need to be resolved in
Bazel and upstream rules repos. Please see &lt;a href="https://github.com/bazelbuild/rules_docker/issues/943"&gt;#943&lt;/a&gt;
for more details.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#py_image"&gt;py_image&lt;/a&gt; (&lt;a href="https://docs.bazel.build/versions/master/be/python.html#py_binary" rel="nofollow"&gt;signature&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href="#py3_image"&gt;py3_image&lt;/a&gt; (&lt;a href="https://docs.bazel.build/versions/master/be/python.html#py_binary" rel="nofollow"&gt;signature&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href="#nodejs_image"&gt;nodejs_image&lt;/a&gt; (&lt;a href="https://github.com/bazelbuild/rules_nodejs#usage"&gt;usage&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href="#java_image"&gt;java_image&lt;/a&gt; (&lt;a href="https://docs.bazel.build/versions/master/be/java.html#java_binary" rel="nofollow"&gt;signature&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href="#war_image"&gt;war_image&lt;/a&gt; (&lt;a href="https://docs.bazel.build/versions/master/be/java.html#java_library" rel="nofollow"&gt;signature&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href="#scala_image"&gt;scala_image&lt;/a&gt; (&lt;a href="https://github.com/bazelbuild/rules_scala#scala_binary"&gt;signature&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href="#groovy_image"&gt;groovy_image&lt;/a&gt; (&lt;a href="https://github.com/bazelbuild/rules_groovy#groovy_binary"&gt;signature&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href="#cc_image"&gt;cc_image&lt;/a&gt; (&lt;a href="https://docs.bazel.build/versions/master/be/c-cpp.html#cc_binary" rel="nofollow"&gt;signature&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href="#go_image"&gt;go_image&lt;/a&gt; (&lt;a href="https://github.com/bazelbuild/rules_go#go_binary"&gt;signature&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href="#rust_image"&gt;rust_image&lt;/a&gt; (&lt;a href="https://github.com/bazelbuild/rules_rust#rust_binary"&gt;signature&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href="#d_image"&gt;d_image&lt;/a&gt; (&lt;a href="https://github.com/bazelbuild/rules_d#d_binary"&gt;signature&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It is notable that: &lt;code&gt;cc_image&lt;/code&gt;, &lt;code&gt;go_image&lt;/code&gt;, &lt;code&gt;rust_image&lt;/code&gt;, and &lt;code&gt;d_image&lt;/code&gt;
also allow you to specify an external binary target.&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-docker-rules" class="anchor" aria-hidden="true" href="#docker-rules"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Docker Rules&lt;/h2&gt;
&lt;p&gt;This repo now includes rules that provide additional functionality
to install packages and run commands inside docker containers. These
rules, however, require a docker binary is present and properly
configured. These rules include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="docker/package_managers/README.md"&gt;Package manager rules&lt;/a&gt;: rules to install
apt-get packages.&lt;/li&gt;
&lt;li&gt;&lt;a href="docker/util/README.md"&gt;Docker run rules&lt;/a&gt;: rules to run commands inside docker
containers.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;&lt;a id="user-content-overview-1" class="anchor" aria-hidden="true" href="#overview-1"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Overview&lt;/h3&gt;
&lt;p&gt;In addition to low-level rules for building containers, this repository
provides a set of higher-level rules for containerizing applications.  The idea
behind these rules is to make containerizing an application built via a
&lt;code&gt;lang_binary&lt;/code&gt; rule as simple as changing it to &lt;code&gt;lang_image&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;By default these higher level rules make use of the &lt;a href="https://github.com/googlecloudplatform/distroless"&gt;&lt;code&gt;distroless&lt;/code&gt;&lt;/a&gt; language runtimes, but these
can be overridden via the &lt;code&gt;base="..."&lt;/code&gt; attribute (e.g. with a &lt;code&gt;container_pull&lt;/code&gt;
or &lt;code&gt;container_image&lt;/code&gt; target).&lt;/p&gt;
&lt;p&gt;Note also that these rules do not expose any docker related attributes. If you
need to add a custom &lt;code&gt;env&lt;/code&gt; or &lt;code&gt;symlink&lt;/code&gt; to a &lt;code&gt;lang_image&lt;/code&gt;, you must use
&lt;code&gt;container_image&lt;/code&gt; targets for this purpose. Specifically, you can use as base for your
&lt;code&gt;lang_image&lt;/code&gt; target a &lt;code&gt;container_image&lt;/code&gt; target that adds e.g., custom &lt;code&gt;env&lt;/code&gt; or &lt;code&gt;symlink&lt;/code&gt;.
Please see &lt;a href="#go_image-custom-base"&gt;go_image (custom base)&lt;/a&gt; for an example.&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-setup" class="anchor" aria-hidden="true" href="#setup"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Setup&lt;/h2&gt;
&lt;p&gt;Add the following to your &lt;code&gt;WORKSPACE&lt;/code&gt; file to add the external repositories:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@bazel_tools//tools/build_defs/repo:http.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;http_archive&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Download the rules_docker repository at release v0.14.1&lt;/span&gt;
http_archive(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;io_bazel_rules_docker&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;sha256&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;dc97fccceacd4c6be14e800b2a00693d5e8d07f69ee187babfd04a80a9f8e250&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;strip_prefix&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;rules_docker-0.14.1&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;urls&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;https://github.com/bazelbuild/rules_docker/releases/download/v0.14.1/rules_docker-v0.14.1.tar.gz&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
)

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; OPTIONAL: Call this to override the default docker toolchain configuration.&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; This call should be placed BEFORE the call to "container_repositories" below&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; to actually override the default toolchain configuration.&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Note this is only required if you actually want to call&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; docker_toolchain_configure with a custom attr; please read the toolchains&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; docs in /toolchains/docker/ before blindly adding this to your WORKSPACE.&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; BEGIN OPTIONAL segment:&lt;/span&gt;
load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//toolchains/docker:toolchain.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;docker_toolchain_configure&lt;/span&gt;&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;toolchain_configure&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;
)
docker_toolchain_configure(
  &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;docker_config&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; OPTIONAL: Path to a directory which has a custom docker client config.json.&lt;/span&gt;
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; See https://docs.docker.com/engine/reference/commandline/cli/#configuration-files&lt;/span&gt;
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; for more details.&lt;/span&gt;
  &lt;span class="pl-v"&gt;client_config&lt;/span&gt;&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&amp;lt;enter absolute path to your docker config directory here&amp;gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; OPTIONAL: Path to the docker binary.&lt;/span&gt;
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Should be set explcitly for remote execution.&lt;/span&gt;
  &lt;span class="pl-v"&gt;docker_path&lt;/span&gt;&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&amp;lt;enter absolute path to the docker binary (in the remote exec env) here&amp;gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; OPTIONAL: Path to the gzip binary.&lt;/span&gt;
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Either gzip_path or gzip_target should be set explcitly for remote execution.&lt;/span&gt;
  &lt;span class="pl-v"&gt;gzip_path&lt;/span&gt;&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&amp;lt;enter absolute path to the gzip binary (in the remote exec env) here&amp;gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; OPTIONAL: Bazel target for the gzip tool.&lt;/span&gt;
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Either gzip_path or gzip_target should be set explcitly for remote execution.&lt;/span&gt;
  &lt;span class="pl-v"&gt;gzip_target&lt;/span&gt;&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&amp;lt;enter absolute path (i.e., must start with repo name @...//:...) to an executable gzip target&amp;gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; OPTIONAL: Path to the xz binary.&lt;/span&gt;
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Should be set explcitly for remote execution.&lt;/span&gt;
  &lt;span class="pl-v"&gt;xz_path&lt;/span&gt;&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&amp;lt;enter absolute path to the xz binary (in the remote exec env) here&amp;gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; OPTIONAL: List of additional flags to pass to the docker command.&lt;/span&gt;
  &lt;span class="pl-v"&gt;docker_flags&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;--tls&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;--log-level=info&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
  ],

)
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; End of OPTIONAL segment.&lt;/span&gt;

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//repositories:repositories.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;container_repositories&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)
container_repositories()

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; This is NOT needed when going through the language lang_image&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; "repositories" function(s).&lt;/span&gt;
load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//repositories:deps.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-v"&gt;container_deps&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;deps&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

container_deps()

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//container:container.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;container_pull&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

container_pull(
  &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;java_base&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-v"&gt;registry&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;gcr.io&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-v"&gt;repository&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;distroless/java&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; 'tag' is also supported, but digest is encouraged for reproducibility.&lt;/span&gt;
  &lt;span class="pl-v"&gt;digest&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;sha256:deadbeef&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;&lt;a id="user-content-known-issues" class="anchor" aria-hidden="true" href="#known-issues"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Known Issues&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Bazel does not deal well with diamond dependencies.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If the repositories that are imported by &lt;code&gt;container_repositories()&lt;/code&gt; have already been
imported (at a different version) by other rules you called in your &lt;code&gt;WORKSPACE&lt;/code&gt;, which
are placed above the call to &lt;code&gt;container_repositories()&lt;/code&gt;, arbitrary errors might
ocurr. If you get errors related to external repositories, you will likely
not be able to use &lt;code&gt;container_repositories()&lt;/code&gt; and will have to import
directly in your &lt;code&gt;WORKSPACE&lt;/code&gt; all the required dependencies (see the most up
to date impl of &lt;code&gt;container_repositories()&lt;/code&gt; for details).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ImportError: No module named moves.urllib.parse&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This is an example of an error due to a diamond dependency. If you get this
error, make sure to import rules_docker before other libraries, so that
&lt;em&gt;six&lt;/em&gt; can be patched properly.&lt;/p&gt;
&lt;p&gt;See &lt;a href="https://github.com/bazelbuild/rules_docker/issues/1022"&gt;https://github.com/bazelbuild/rules_docker/issues/1022&lt;/a&gt; for more details.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Ensure your project has a &lt;code&gt;BUILD&lt;/code&gt; or &lt;code&gt;BUILD.bazel&lt;/code&gt; file at the top level. This
can be a blank file if necessary. Otherwise you might see and error that looks
like:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;Unable to load package for //:WORKSPACE: BUILD file not found in any of the following directories.
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;&lt;a id="user-content-using-with-docker-locally" class="anchor" aria-hidden="true" href="#using-with-docker-locally"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Using with Docker locally.&lt;/h2&gt;
&lt;p&gt;Suppose you have a &lt;code&gt;container_image&lt;/code&gt; target &lt;code&gt;//my/image:helloworld&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;container_image(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;helloworld&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-c1"&gt;...&lt;/span&gt;
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can load this into your local Docker client by running:
&lt;code&gt;bazel run my/image:helloworld&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;For the &lt;code&gt;lang_image&lt;/code&gt; targets, this will also &lt;strong&gt;run&lt;/strong&gt; the
container to maximize compatibility with &lt;code&gt;lang_binary&lt;/code&gt; rules.  You can suppress
this behavior by passing the single flag: &lt;code&gt;bazel run :foo -- --norun&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Alternatively, you can build a &lt;code&gt;docker load&lt;/code&gt; compatible bundle with:
&lt;code&gt;bazel build my/image:helloworld.tar&lt;/code&gt;.  This will produce the file:
&lt;code&gt;bazel-bin/my/image/helloworld.tar&lt;/code&gt;, which you can load into
your local Docker client by running:
&lt;code&gt;docker load -i bazel-bin/my/image/helloworld.tar&lt;/code&gt;.  Building
this target can be expensive for large images.&lt;/p&gt;
&lt;p&gt;These work with both &lt;code&gt;container_image&lt;/code&gt;, &lt;code&gt;container_bundle&lt;/code&gt;, and the
&lt;code&gt;lang_image&lt;/code&gt; rules.  For everything except
&lt;code&gt;container_bundle&lt;/code&gt;, the image name will be &lt;code&gt;bazel/my/image:helloworld&lt;/code&gt;.
For &lt;code&gt;container_bundle&lt;/code&gt;, it will apply the tags you have specified.&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-authentication" class="anchor" aria-hidden="true" href="#authentication"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Authentication&lt;/h2&gt;
&lt;p&gt;You can use these rules to access private images using standard Docker
authentication methods.  e.g. to utilize the &lt;a href="https://gcr.io" rel="nofollow"&gt;Google Container Registry&lt;/a&gt;. See
&lt;a href="https://cloud.google.com/container-registry/docs/advanced-authentication" rel="nofollow"&gt;here&lt;/a&gt; for authentication methods.&lt;/p&gt;
&lt;p&gt;See also:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/awslabs/amazon-ecr-credential-helper"&gt;Amazon ECR Docker Credential Helper&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/Azure/acr-docker-credential-helper"&gt;Azure Docker Credential Helper&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Once you've setup your docker client configuration, see &lt;a href="#container_pull-custom-client-configuration"&gt;here&lt;/a&gt;
for an example of how to use container_pull with custom docker authentication credentials
and &lt;a href="#container_push-custom-client-configuration"&gt;here&lt;/a&gt; for an example of how
to use container_push with custom docker authentication credentials.&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-varying-image-names" class="anchor" aria-hidden="true" href="#varying-image-names"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Varying image names&lt;/h2&gt;
&lt;p&gt;A common request from folks using &lt;code&gt;container_push&lt;/code&gt; or &lt;code&gt;container_bundle&lt;/code&gt; is to
be able to vary the tag that is pushed or embedded.  There are two options
at present for doing this.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-stamping" class="anchor" aria-hidden="true" href="#stamping"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Stamping&lt;/h3&gt;
&lt;p&gt;The first option is to use stamping. Stamping is enabled when a supported
attribute contains a python format placeholder (eg &lt;code&gt;{BUILD_USER}&lt;/code&gt;).&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; A common pattern when users want to avoid trampling&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; on each other's images during development.&lt;/span&gt;
container_push(
  &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;publish&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,

  &lt;span class="pl-v"&gt;format&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;Docker&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,

  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Any of these components may have variables.&lt;/span&gt;
  &lt;span class="pl-v"&gt;registry&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;gcr.io&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-v"&gt;repository&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;my-project/my-image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-v"&gt;tag&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;span class="pl-c1"&gt;{BUILD_USER}&lt;/span&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The next natural question is: "Well what variables can I use?"  This
option consumes the workspace-status variables Bazel defines in
&lt;code&gt;stable-status.txt&lt;/code&gt; and &lt;code&gt;volatile-status.txt&lt;/code&gt;.  These files will appear
in the target's runfiles:&lt;/p&gt;
&lt;div class="highlight highlight-source-shell"&gt;&lt;pre&gt;$ bazel build //docker/testdata:push_stamp
...

$ cat bazel-bin/docker/testdata/push_stamp.runfiles/io_bazel_rules_docker/stable-status.txt
BUILD_EMBED_LABEL
BUILD_HOST bazel
BUILD_USER mattmoor

$ cat bazel-bin/docker/testdata/push_stamp.runfiles/io_bazel_rules_docker/volatile-status.txt
BUILD_TIMESTAMP 1498740967769
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can augment these variables via &lt;code&gt;--workspace_status_command&lt;/code&gt;,
including through the use of &lt;a href="https://github.com/kubernetes/kubernetes/blob/81ce94ae1d8f5d04058eeb214e9af498afe78ff2/build/root/.bazelrc#L6"&gt;&lt;code&gt;.bazelrc&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-make-variables" class="anchor" aria-hidden="true" href="#make-variables"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Make variables&lt;/h3&gt;
&lt;p&gt;The second option is to employ &lt;code&gt;Makefile&lt;/code&gt;-style variables:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;container_bundle(
  &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;bundle&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,

  &lt;span class="pl-v"&gt;images&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; {
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;gcr.io/$(project)/frontend:latest&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;//frontend:image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;gcr.io/$(project)/backend:latest&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;//backend:image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
  }
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;These variables are specified on the CLI using:&lt;/p&gt;
&lt;div class="highlight highlight-source-shell"&gt;&lt;pre&gt;   bazel build --define project=blah //path/to:bundle&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;&lt;a id="user-content-debugging-lang_image-rules" class="anchor" aria-hidden="true" href="#debugging-lang_image-rules"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Debugging &lt;code&gt;lang_image&lt;/code&gt; rules&lt;/h2&gt;
&lt;p&gt;By default the &lt;code&gt;lang_image&lt;/code&gt; rules use the &lt;code&gt;distroless&lt;/code&gt; base runtime images,
which are optimized to be the minimal set of things your application needs
at runtime.  That can make debugging these containers difficult because they
lack even a basic shell for exploring the filesystem.&lt;/p&gt;
&lt;p&gt;To address this, we publish variants of the &lt;code&gt;distroless&lt;/code&gt; runtime images tagged
&lt;code&gt;:debug&lt;/code&gt;, which are the exact-same images, but with additions such as &lt;code&gt;busybox&lt;/code&gt;
to make debugging easier.&lt;/p&gt;
&lt;p&gt;For example (in this repo):&lt;/p&gt;
&lt;div class="highlight highlight-source-shell"&gt;&lt;pre&gt;$ bazel run -c dbg testdata:go_image
...
INFO: Build completed successfully, 5 total actions

INFO: Running &lt;span class="pl-c1"&gt;command&lt;/span&gt; line: bazel-bin/testdata/go_image
Loaded image ID: sha256:9c5c2167a1db080a64b5b401b43b3c5cdabb265b26cf7a60aabe04a20da79e24
Tagging 9c5c2167a1db080a64b5b401b43b3c5cdabb265b26cf7a60aabe04a20da79e24 as bazel/testdata:go_image
Hello, world&lt;span class="pl-k"&gt;!&lt;/span&gt;

$ docker run -ti --rm --entrypoint=sh bazel/testdata:go_image -c &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;echo Hello, busybox.&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;
Hello, busybox.&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;&lt;a id="user-content-examples" class="anchor" aria-hidden="true" href="#examples"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Examples&lt;/h2&gt;
&lt;h3&gt;&lt;a id="user-content-container_image" class="anchor" aria-hidden="true" href="#container_image"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;container_image&lt;/h3&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;container_image(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;app&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; References container_pull from WORKSPACE (above)&lt;/span&gt;
    &lt;span class="pl-v"&gt;base&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@java_base//image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;files&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;//java/com/example/app:Hello_deploy.jar&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
    &lt;span class="pl-v"&gt;cmd&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;Hello_deploy.jar&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;]
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Hint: if you want to put files in specific directories inside the image
use &lt;a href="https://docs.bazel.build/versions/master/be/pkg.html" rel="nofollow"&gt;&lt;code&gt;pkg_tar&lt;/code&gt; rule&lt;/a&gt;
to create the desired directory structure and pass that to &lt;code&gt;container_image&lt;/code&gt; via
&lt;code&gt;tars&lt;/code&gt; attribute. Note you might need to set &lt;code&gt;strip_prefix = "."&lt;/code&gt; or &lt;code&gt;strip_prefix = "{some directory}"&lt;/code&gt;
in your rule for the files to not be flattened.
See &lt;a href="https://github.com/bazelbuild/bazel/issues/2176"&gt;Bazel upstream issue 2176&lt;/a&gt; and
&lt;a href="https://github.com/bazelbuild/rules_docker/issues/317"&gt;rules_docker issue 317&lt;/a&gt;
for more details.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-cc_image" class="anchor" aria-hidden="true" href="#cc_image"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;cc_image&lt;/h3&gt;
&lt;p&gt;To use &lt;code&gt;cc_image&lt;/code&gt;, add the following to &lt;code&gt;WORKSPACE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//repositories:repositories.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;container_repositories&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

container_repositories()

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//cc:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;_cc_image_repos&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

_cc_image_repos()&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then in your &lt;code&gt;BUILD&lt;/code&gt; file, simply rewrite &lt;code&gt;cc_binary&lt;/code&gt; to &lt;code&gt;cc_image&lt;/code&gt; with the
following import:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//cc:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;cc_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

cc_image(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;cc_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;srcs&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;cc_image.cc&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
    &lt;span class="pl-v"&gt;deps&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:cc_image_library&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
)&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;&lt;a id="user-content-cc_image-external-binary" class="anchor" aria-hidden="true" href="#cc_image-external-binary"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;cc_image (external binary)&lt;/h3&gt;
&lt;p&gt;To use &lt;code&gt;cc_image&lt;/code&gt; (or &lt;code&gt;go_image&lt;/code&gt;, &lt;code&gt;d_image&lt;/code&gt;, &lt;code&gt;rust_image&lt;/code&gt;) with an external
&lt;code&gt;cc_binary&lt;/code&gt; (or the like) target, then your &lt;code&gt;BUILD&lt;/code&gt; file should instead look
like:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//cc:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;cc_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

cc_binary(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;cc_binary&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;srcs&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;cc_binary.cc&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
    &lt;span class="pl-v"&gt;deps&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:cc_library&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
)

cc_image(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;cc_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;binary&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:cc_binary&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you need to modify somehow the container produced by
&lt;code&gt;cc_image&lt;/code&gt; (e.g., &lt;code&gt;env&lt;/code&gt;, &lt;code&gt;symlink&lt;/code&gt;), see note above in
&lt;a href="#overview-1"&gt;Language Rules Overview&lt;/a&gt; about how to do this
and see &lt;a href="#go_image-custom-base"&gt;go_image (custom base)&lt;/a&gt; example below.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-py_image" class="anchor" aria-hidden="true" href="#py_image"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;py_image&lt;/h3&gt;
&lt;p&gt;To use &lt;code&gt;py_image&lt;/code&gt;, add the following to &lt;code&gt;WORKSPACE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//repositories:repositories.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;container_repositories&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

container_repositories()

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//python:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;_py_image_repos&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

_py_image_repos()&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then in your &lt;code&gt;BUILD&lt;/code&gt; file, simply rewrite &lt;code&gt;py_binary&lt;/code&gt; to &lt;code&gt;py_image&lt;/code&gt; with the
following import:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//python:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;py_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

py_image(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;py_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;srcs&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;py_image.py&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
    &lt;span class="pl-v"&gt;deps&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:py_image_library&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
    &lt;span class="pl-v"&gt;main&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;py_image.py&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you need to modify somehow the container produced by
&lt;code&gt;py_image&lt;/code&gt; (e.g., &lt;code&gt;env&lt;/code&gt;, &lt;code&gt;symlink&lt;/code&gt;), see note above in
&lt;a href="#overview-1"&gt;Language Rules Overview&lt;/a&gt; about how to do this
and see &lt;a href="#go_image-custom-base"&gt;go_image (custom base)&lt;/a&gt; example below.&lt;/p&gt;
&lt;p&gt;If you are using &lt;code&gt;py_image&lt;/code&gt; with a custom base that has python tools installed
in a location different to the default base, please see
&lt;a href="#python-tools"&gt;Python tools&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-py_image-fine-layering" class="anchor" aria-hidden="true" href="#py_image-fine-layering"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;py_image (fine layering)&lt;/h3&gt;
&lt;p&gt;For Python and Java's &lt;code&gt;lang_image&lt;/code&gt; rules, you can factor
dependencies that don't change into their own layers by overriding the
&lt;code&gt;layers=[]&lt;/code&gt; attribute.  Consider this sample from the &lt;code&gt;rules_k8s&lt;/code&gt; repository:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;py_image(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;server&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;srcs&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;server.py&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; "layers" is just like "deps", but it also moves the dependencies each into&lt;/span&gt;
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; their own layer, which can dramatically improve developer cycle time.  For&lt;/span&gt;
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; example here, the grpcio layer is ~40MB, but the rest of the app is only&lt;/span&gt;
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; ~400KB.  By partitioning things this way, the large grpcio layer remains&lt;/span&gt;
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; unchanging and we can reduce the amount of image data we repush by ~99%!&lt;/span&gt;
    &lt;span class="pl-v"&gt;layers&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [
        requirement(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;grpcio&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;),
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;//examples/hellogrpc/proto:py&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    ],
    &lt;span class="pl-v"&gt;main&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;server.py&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can also implement more complex fine layering strategies by using the
&lt;code&gt;py_layer&lt;/code&gt; rule and its &lt;code&gt;filter&lt;/code&gt; attribute.  For example:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Suppose that we are synthesizing an image that depends on a complex set&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; of libraries that we want to break into layers.&lt;/span&gt;
&lt;span class="pl-c1"&gt;LIBS&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;//pkg/complex_library&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; ...&lt;/span&gt;
]
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; First, we extract all transitive dependencies of LIBS that are under //pkg/common.&lt;/span&gt;
py_layer(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;common_deps&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;deps&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-c1"&gt;LIBS&lt;/span&gt;,
    &lt;span class="pl-v"&gt;filter&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;//pkg/common&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Then, we further extract all external dependencies of the deps under //pkg/common.&lt;/span&gt;
py_layer(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;common_external_deps&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;deps&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:common_deps&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
    &lt;span class="pl-v"&gt;filter&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; We also extract all external dependencies of LIBS, which is a superset of&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; ":common_external_deps".&lt;/span&gt;
py_layer(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;external_deps&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;deps&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-c1"&gt;LIBS&lt;/span&gt;,
    &lt;span class="pl-v"&gt;filter&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Finally, we create the image, stacking the above filtered layers on top of one&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; another in the "layers" attribute.  The layers are applied in order, and any&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; dependencies already added to the image will not be added again.  Therefore,&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; ":external_deps" will only add the external dependencies not present in&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; ":common_external_deps".&lt;/span&gt;
py_image(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;deps&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-c1"&gt;LIBS&lt;/span&gt;,
    &lt;span class="pl-v"&gt;layers&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:common_external_deps&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:common_deps&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:external_deps&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    ],
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; ...&lt;/span&gt;
)&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;&lt;a id="user-content-py3_image" class="anchor" aria-hidden="true" href="#py3_image"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;py3_image&lt;/h3&gt;
&lt;p&gt;To use a Python 3 runtime instead of the default of Python 2, use &lt;code&gt;py3_image&lt;/code&gt;,
instead of &lt;code&gt;py_image&lt;/code&gt;.  The other semantics are identical.&lt;/p&gt;
&lt;p&gt;If you need to modify somehow the container produced by
&lt;code&gt;py3_image&lt;/code&gt; (e.g., &lt;code&gt;env&lt;/code&gt;, &lt;code&gt;symlink&lt;/code&gt;), see note above in
&lt;a href="#overview-1"&gt;Language Rules Overview&lt;/a&gt; about how to do this
and see &lt;a href="#go_image-custom-base"&gt;go_image (custom base)&lt;/a&gt; example below.&lt;/p&gt;
&lt;p&gt;If you are using &lt;code&gt;py3_image&lt;/code&gt; with a custom base that has python tools installed
in a location different to the default base, please see
&lt;a href="#python-tools"&gt;Python tools&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-nodejs_image" class="anchor" aria-hidden="true" href="#nodejs_image"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;nodejs_image&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;It is notable that unlike the other image rules, &lt;code&gt;nodejs_image&lt;/code&gt; is not
currently using the &lt;code&gt;gcr.io/distroless/nodejs&lt;/code&gt; image for a handful of reasons.&lt;/strong&gt;
This is a switch we plan to make, when we can manage it.  We are currently
utilizing the &lt;code&gt;gcr.io/google-appengine/debian9&lt;/code&gt; image as our base.&lt;/p&gt;
&lt;p&gt;To use &lt;code&gt;nodejs_image&lt;/code&gt;, add the following to &lt;code&gt;WORKSPACE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@bazel_tools//tools/build_defs/repo:http.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;http_archive&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

http_archive(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;build_bazel_rules_nodejs&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Replace with a real SHA256 checksum&lt;/span&gt;
    &lt;span class="pl-v"&gt;sha256&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;span class="pl-c1"&gt;{SHA256}&lt;/span&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Replace with a real release version&lt;/span&gt;
    &lt;span class="pl-v"&gt;urls&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;https://github.com/bazelbuild/rules_nodejs/releases/download/&lt;span class="pl-c1"&gt;{VERSION}&lt;/span&gt;/rules_nodejs-&lt;span class="pl-c1"&gt;{VERSION}&lt;/span&gt;.tar.gz&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
)


load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@build_bazel_rules_nodejs//:index.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;npm_install&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Install your declared Node.js dependencies&lt;/span&gt;
npm_install(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;npm&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;package_json&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;//:package.json&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;yarn_lock&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;//:yarn.lock&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//repositories:repositories.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;container_repositories&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

container_repositories()

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//nodejs:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;_nodejs_image_repos&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

_nodejs_image_repos()&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note: See note about diamond dependencies in &lt;a href="#setup"&gt;setup&lt;/a&gt;
if you run into issues related to external repos after adding these
lines to your &lt;code&gt;WORKSPACE&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Then in your &lt;code&gt;BUILD&lt;/code&gt; file, simply rewrite &lt;code&gt;nodejs_binary&lt;/code&gt; to &lt;code&gt;nodejs_image&lt;/code&gt; with
the following import:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//nodejs:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;nodejs_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

nodejs_image(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;nodejs_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;entry_point&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@your_workspace//path/to:file.js&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; npm deps will be put into their own layer&lt;/span&gt;
    &lt;span class="pl-v"&gt;data&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:file.js&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@npm//some-npm-dep&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
    &lt;span class="pl-c1"&gt;...&lt;/span&gt;
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you need to modify somehow the container produced by
&lt;code&gt;nodejs_image&lt;/code&gt; (e.g., &lt;code&gt;env&lt;/code&gt;, &lt;code&gt;symlink&lt;/code&gt;), see note above in
&lt;a href="#overview-1"&gt;Language Rules Overview&lt;/a&gt; about how to do this
and see &lt;a href="#go_image-custom-base"&gt;go_image (custom base)&lt;/a&gt; example below.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-go_image" class="anchor" aria-hidden="true" href="#go_image"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;go_image&lt;/h3&gt;
&lt;p&gt;To use &lt;code&gt;go_image&lt;/code&gt;, add the following to &lt;code&gt;WORKSPACE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@bazel_tools//tools/build_defs/repo:http.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;http_archive&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//repositories:repositories.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;container_repositories&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

container_repositories()

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//go:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;_go_image_repos&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

_go_image_repos()&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note: See note about diamond dependencies in &lt;a href="#setup"&gt;setup&lt;/a&gt;
if you run into issues related to external repos after adding these
lines to your &lt;code&gt;WORKSPACE&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Then in your &lt;code&gt;BUILD&lt;/code&gt; file, simply rewrite &lt;code&gt;go_binary&lt;/code&gt; to &lt;code&gt;go_image&lt;/code&gt; with the
following import:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//go:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;go_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

go_image(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;go_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;srcs&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;main.go&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
    &lt;span class="pl-v"&gt;importpath&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;github.com/your/path/here&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that it is important to explicitly build this target with the
&lt;code&gt;--platforms=@io_bazel_rules_go//go/toolchain:linux_amd64&lt;/code&gt; flag
as the binary should be built for Linux since it will run in a Linux container.&lt;/p&gt;
&lt;p&gt;If you need to modify somehow the container produced by
&lt;code&gt;go_image&lt;/code&gt; (e.g., &lt;code&gt;env&lt;/code&gt;, &lt;code&gt;symlink&lt;/code&gt;), see note above in
&lt;a href="#overview-1"&gt;Language Rules Overview&lt;/a&gt; about how to do this and
see example below.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-go_image-custom-base" class="anchor" aria-hidden="true" href="#go_image-custom-base"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;go_image (custom base)&lt;/h3&gt;
&lt;p&gt;To use a custom base image, with any of the &lt;code&gt;lang_image&lt;/code&gt;
rules, you can override the default &lt;code&gt;base="..."&lt;/code&gt; attribute.  Consider this
modified sample from the &lt;code&gt;distroless&lt;/code&gt; repository:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@bazel_tools//tools/build_defs/pkg:pkg.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;pkg_tar&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Create a passwd file with a root and nonroot user and uid.&lt;/span&gt;
passwd_entry(
    &lt;span class="pl-v"&gt;username&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;root&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;uid&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-c1"&gt;0&lt;/span&gt;,
    &lt;span class="pl-v"&gt;gid&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-c1"&gt;0&lt;/span&gt;,
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;root_user&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

passwd_entry(
    &lt;span class="pl-v"&gt;username&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;nonroot&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;info&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;nonroot&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;uid&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-c1"&gt;1002&lt;/span&gt;,
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;nonroot_user&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

passwd_file(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;passwd&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;entries&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:root_user&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:nonroot_user&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    ],
)

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Create a tar file containing the created passwd file&lt;/span&gt;
pkg_tar(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;passwd_tar&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;srcs&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:passwd&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
    &lt;span class="pl-v"&gt;mode&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;0o644&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;package_dir&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;etc&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Include it in our base image as a tar.&lt;/span&gt;
container_image(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;passwd_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;base&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@go_image_base//image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;tars&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:passwd_tar&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
    &lt;span class="pl-v"&gt;user&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;nonroot&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Simple go program to print out the username and uid.&lt;/span&gt;
go_image(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;user&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;srcs&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;user.go&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Override the base image.&lt;/span&gt;
    &lt;span class="pl-v"&gt;base&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:passwd_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;&lt;a id="user-content-java_image" class="anchor" aria-hidden="true" href="#java_image"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;java_image&lt;/h3&gt;
&lt;p&gt;To use &lt;code&gt;java_image&lt;/code&gt;, add the following to &lt;code&gt;WORKSPACE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//repositories:repositories.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;container_repositories&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

container_repositories()

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//java:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;_java_image_repos&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

_java_image_repos()&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then in your &lt;code&gt;BUILD&lt;/code&gt; file, simply rewrite &lt;code&gt;java_binary&lt;/code&gt; to &lt;code&gt;java_image&lt;/code&gt; with the
following import:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//java:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;java_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

java_image(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;java_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;srcs&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;Binary.java&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Put these runfiles into their own layer.&lt;/span&gt;
    &lt;span class="pl-v"&gt;layers&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:java_image_library&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
    &lt;span class="pl-v"&gt;main_class&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;examples.images.Binary&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you need to modify somehow the container produced by
&lt;code&gt;java_image&lt;/code&gt; (e.g., &lt;code&gt;env&lt;/code&gt;, &lt;code&gt;symlink&lt;/code&gt;), see note above in
&lt;a href="#overview-1"&gt;Language Rules Overview&lt;/a&gt; about how to do this
and see &lt;a href="#go_image-custom-base"&gt;go_image (custom base)&lt;/a&gt; example.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-war_image" class="anchor" aria-hidden="true" href="#war_image"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;war_image&lt;/h3&gt;
&lt;p&gt;To use &lt;code&gt;war_image&lt;/code&gt;, add the following to &lt;code&gt;WORKSPACE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//repositories:repositories.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;container_repositories&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

container_repositories()

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//java:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;_java_image_repos&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

_java_image_repos()&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note: See note about diamond dependencies in &lt;a href="#setup"&gt;setup&lt;/a&gt;
if you run into issues related to external repos after adding these
lines to your &lt;code&gt;WORKSPACE&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Then in your &lt;code&gt;BUILD&lt;/code&gt; file, simply rewrite &lt;code&gt;java_war&lt;/code&gt; to &lt;code&gt;war_image&lt;/code&gt; with the
following import:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//java:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;war_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

war_image(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;war_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;srcs&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;Servlet.java&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Put these JARs into their own layers.&lt;/span&gt;
    &lt;span class="pl-v"&gt;layers&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:java_image_library&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@javax_servlet_api//jar:jar&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    ],
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The produced image uses Jetty 9.x to serve the web application. Servlets included in the web application need to follow the API specification 3.0. For best compatibility, use a &lt;a href="https://search.maven.org/search?q=g:org.mortbay.jetty%20AND%20a:servlet-api&amp;amp;core=gav" rel="nofollow"&gt;Servlet dependency provided by the Jetty project&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;A Servlet implementation needs to declare the &lt;code&gt;@WebServlet&lt;/code&gt; annotation to be auto-discovered. The use of a &lt;code&gt;web.xml&lt;/code&gt; to declare the Servlet URL mapping is not supported.&lt;/p&gt;
&lt;p&gt;If you need to modify somehow the container produced by
&lt;code&gt;war_image&lt;/code&gt; (e.g., &lt;code&gt;env&lt;/code&gt;, &lt;code&gt;symlink&lt;/code&gt;), see note above in
&lt;a href="#overview-1"&gt;Language Rules Overview&lt;/a&gt; about how to do this
and see &lt;a href="#go_image-custom-base"&gt;go_image (custom base)&lt;/a&gt; example.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-scala_image" class="anchor" aria-hidden="true" href="#scala_image"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;scala_image&lt;/h3&gt;
&lt;p&gt;To use &lt;code&gt;scala_image&lt;/code&gt;, add the following to &lt;code&gt;WORKSPACE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@bazel_tools//tools/build_defs/repo:http.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;http_archive&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; You *must* import the Scala rules before setting up the scala_image rules.&lt;/span&gt;
http_archive(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;io_bazel_rules_scala&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Replace with a real SHA256 checksum&lt;/span&gt;
    &lt;span class="pl-v"&gt;sha256&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;span class="pl-c1"&gt;{SHA256}&lt;/span&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Replace with a real commit SHA&lt;/span&gt;
    &lt;span class="pl-v"&gt;strip_prefix&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;rules_scala-&lt;span class="pl-c1"&gt;{HEAD}&lt;/span&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;urls&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;https://github.com/bazelbuild/rules_scala/archive/&lt;span class="pl-c1"&gt;{HEAD}&lt;/span&gt;.tar.gz&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
)

load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_scala//scala:scala.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;scala_repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

scala_repositories()

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//repositories:repositories.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;container_repositories&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

container_repositories()

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//scala:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;_scala_image_repos&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

_scala_image_repos()&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note: See note about diamond dependencies in &lt;a href="#setup"&gt;setup&lt;/a&gt;
if you run into issues related to external repos after adding these
lines to your &lt;code&gt;WORKSPACE&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Then in your &lt;code&gt;BUILD&lt;/code&gt; file, simply rewrite &lt;code&gt;scala_binary&lt;/code&gt; to &lt;code&gt;scala_image&lt;/code&gt; with the
following import:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//scala:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;scala_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

scala_image(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;scala_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;srcs&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;Binary.scala&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
    &lt;span class="pl-v"&gt;main_class&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;examples.images.Binary&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you need to modify somehow the container produced by
&lt;code&gt;scala_image&lt;/code&gt; (e.g., &lt;code&gt;env&lt;/code&gt;, &lt;code&gt;symlink&lt;/code&gt;), see note above in
&lt;a href="#overview-1"&gt;Language Rules Overview&lt;/a&gt; about how to do this
and see &lt;a href="#go_image-custom-base"&gt;go_image (custom base)&lt;/a&gt; example.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-groovy_image" class="anchor" aria-hidden="true" href="#groovy_image"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;groovy_image&lt;/h3&gt;
&lt;p&gt;To use &lt;code&gt;groovy_image&lt;/code&gt;, add the following to &lt;code&gt;WORKSPACE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@bazel_tools//tools/build_defs/repo:http.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;http_archive&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; You *must* import the Groovy rules before setting up the groovy_image rules.&lt;/span&gt;
http_archive(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;io_bazel_rules_groovy&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Replace with a real SHA256 checksum&lt;/span&gt;
    &lt;span class="pl-v"&gt;sha256&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;span class="pl-c1"&gt;{SHA256}&lt;/span&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Replace with a real commit SHA&lt;/span&gt;
    &lt;span class="pl-v"&gt;strip_prefix&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;rules_groovy-&lt;span class="pl-c1"&gt;{HEAD}&lt;/span&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;urls&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;https://github.com/bazelbuild/rules_groovy/archive/&lt;span class="pl-c1"&gt;{HEAD}&lt;/span&gt;.tar.gz&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
)

load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_groovy//groovy:groovy.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;groovy_repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

groovy_repositories()

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//repositories:repositories.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;container_repositories&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

container_repositories()

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//groovy:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;_groovy_image_repos&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

_groovy_image_repos()&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note: See note about diamond dependencies in &lt;a href="#setup"&gt;setup&lt;/a&gt;
if you run into issues related to external repos after adding these
lines to your &lt;code&gt;WORKSPACE&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Then in your &lt;code&gt;BUILD&lt;/code&gt; file, simply rewrite &lt;code&gt;groovy_binary&lt;/code&gt; to &lt;code&gt;groovy_image&lt;/code&gt; with the
following import:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//groovy:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;groovy_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

groovy_image(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;groovy_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;srcs&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;Binary.groovy&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
    &lt;span class="pl-v"&gt;main_class&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;examples.images.Binary&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you need to modify somehow the container produced by
&lt;code&gt;groovy_image&lt;/code&gt; (e.g., &lt;code&gt;env&lt;/code&gt;, &lt;code&gt;symlink&lt;/code&gt;), see note above in
&lt;a href="#overview-1"&gt;Language Rules Overview&lt;/a&gt; about how to do this
and see &lt;a href="#go_image-custom-base"&gt;go_image (custom base)&lt;/a&gt; example.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-rust_image" class="anchor" aria-hidden="true" href="#rust_image"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;rust_image&lt;/h3&gt;
&lt;p&gt;To use &lt;code&gt;rust_image&lt;/code&gt;, add the following to &lt;code&gt;WORKSPACE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@bazel_tools//tools/build_defs/repo:http.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;http_archive&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; You *must* import the Rust rules before setting up the rust_image rules.&lt;/span&gt;
http_archive(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;io_bazel_rules_rust&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Replace with a real SHA256 checksum&lt;/span&gt;
    &lt;span class="pl-v"&gt;sha256&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;span class="pl-c1"&gt;{SHA256}&lt;/span&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Replace with a real commit SHA&lt;/span&gt;
    &lt;span class="pl-v"&gt;strip_prefix&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;rules_rust-&lt;span class="pl-c1"&gt;{HEAD}&lt;/span&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;urls&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;https://github.com/bazelbuild/rules_rust/archive/&lt;span class="pl-c1"&gt;{HEAD}&lt;/span&gt;.tar.gz&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
)

load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_rust//rust:repositories.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;rust_repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

rust_repositories()

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//repositories:repositories.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;container_repositories&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

container_repositories()

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//rust:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;_rust_image_repos&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

_rust_image_repos()&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note: See note about diamond dependencies in &lt;a href="#setup"&gt;setup&lt;/a&gt;
if you run into issues related to external repos after adding these
lines to your &lt;code&gt;WORKSPACE&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Then in your &lt;code&gt;BUILD&lt;/code&gt; file, simply rewrite &lt;code&gt;rust_binary&lt;/code&gt; to &lt;code&gt;rust_image&lt;/code&gt; with the
following import:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//rust:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;rust_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

rust_image(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;rust_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;srcs&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;main.rs&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you need to modify somehow the container produced by
&lt;code&gt;rust_image&lt;/code&gt; (e.g., &lt;code&gt;env&lt;/code&gt;, &lt;code&gt;symlink&lt;/code&gt;), see note above in
&lt;a href="#overview-1"&gt;Language Rules Overview&lt;/a&gt; about how to do this
and see &lt;a href="#go_image-custom-base"&gt;go_image (custom base)&lt;/a&gt; example.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-d_image" class="anchor" aria-hidden="true" href="#d_image"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;d_image&lt;/h3&gt;
&lt;p&gt;To use &lt;code&gt;d_image&lt;/code&gt;, add the following to &lt;code&gt;WORKSPACE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@bazel_tools//tools/build_defs/repo:http.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;http_archive&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; You *must* import the D rules before setting up the d_image rules.&lt;/span&gt;
http_archive(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;io_bazel_rules_d&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Replace with a real SHA256 checksum&lt;/span&gt;
    &lt;span class="pl-v"&gt;sha256&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;span class="pl-c1"&gt;{SHA256}&lt;/span&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Replace with a real commit SHA&lt;/span&gt;
    &lt;span class="pl-v"&gt;strip_prefix&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;rules_d-&lt;span class="pl-c1"&gt;{HEAD}&lt;/span&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;urls&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;https://github.com/bazelbuild/rules_d/archive/&lt;span class="pl-c1"&gt;{HEAD}&lt;/span&gt;.tar.gz&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
)

load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_d//d:d.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;d_repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

d_repositories()

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//repositories:repositories.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;container_repositories&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

container_repositories()

load(
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//d:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;_d_image_repos&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;repositories&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

_d_image_repos()&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note: See note about diamond dependencies in &lt;a href="#setup"&gt;setup&lt;/a&gt;
if you run into issues related to external repos after adding these
lines to your &lt;code&gt;WORKSPACE&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Then in your &lt;code&gt;BUILD&lt;/code&gt; file, simply rewrite &lt;code&gt;d_binary&lt;/code&gt; to &lt;code&gt;d_image&lt;/code&gt; with the
following import:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//d:image.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;d_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

d_image(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;d_image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;srcs&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; [&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;main.d&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;],
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you need to modify somehow the container produced by
&lt;code&gt;d_image&lt;/code&gt; (e.g., &lt;code&gt;env&lt;/code&gt;, &lt;code&gt;symlink&lt;/code&gt;), see note above in
&lt;a href="#overview-1"&gt;Language Rules Overview&lt;/a&gt; about how to do this
and see &lt;a href="#go_image-custom-base"&gt;go_image (custom base)&lt;/a&gt; example.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;NOTE: all application image rules support the &lt;code&gt;args&lt;/code&gt; string_list
attribute.  If specified, they will be appended directly after the
container ENTRYPOINT binary name.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;&lt;a id="user-content-container_bundle" class="anchor" aria-hidden="true" href="#container_bundle"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;container_bundle&lt;/h3&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;container_bundle(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;bundle&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;images&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; {
        &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; A set of images to bundle up into a single tarball.&lt;/span&gt;
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;gcr.io/foo/bar:bazz&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:app&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;gcr.io/foo/bar:blah&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;//my:sidecar&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;gcr.io/foo/bar:booo&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@your//random:image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    }
)&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;&lt;a id="user-content-container_pull" class="anchor" aria-hidden="true" href="#container_pull"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;container_pull&lt;/h3&gt;
&lt;p&gt;In &lt;code&gt;WORKSPACE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;container_pull(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;base&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;registry&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;gcr.io&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;repository&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;my-project/my-base&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; 'tag' is also supported, but digest is encouraged for reproducibility.&lt;/span&gt;
    &lt;span class="pl-v"&gt;digest&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;sha256:deadbeef&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This can then be referenced in &lt;code&gt;BUILD&lt;/code&gt; files as &lt;code&gt;@base//image&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;To get the correct digest one can run &lt;code&gt;docker manifest inspect gcr.io/my-project/my-base:tag&lt;/code&gt; once &lt;a href="https://docs.docker.com/engine/reference/commandline/manifest_inspect" rel="nofollow"&gt;experimental docker cli featuers are enabled&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;See &lt;a href="#container_pull-custom-client-configuration"&gt;here&lt;/a&gt; for an example of how
to use container_pull with custom docker authentication credentials.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-container_push" class="anchor" aria-hidden="true" href="#container_push"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;container_push&lt;/h3&gt;
&lt;p&gt;This target pushes on &lt;code&gt;bazel run :push_foo&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;container_push(
   &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;push_foo&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
   &lt;span class="pl-v"&gt;image&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:foo&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
   &lt;span class="pl-v"&gt;format&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;Docker&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
   &lt;span class="pl-v"&gt;registry&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;gcr.io&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
   &lt;span class="pl-v"&gt;repository&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;my-project/my-image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
   &lt;span class="pl-v"&gt;tag&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;dev&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We also support the &lt;code&gt;docker_push&lt;/code&gt; (from &lt;code&gt;docker/docker.bzl&lt;/code&gt;) and &lt;code&gt;oci_push&lt;/code&gt;
(from &lt;code&gt;oci/oci.bzl&lt;/code&gt;) aliases, which bake in the &lt;code&gt;format = "..."&lt;/code&gt; attribute.&lt;/p&gt;
&lt;p&gt;See &lt;a href="#container_push-custom-client-configuration"&gt;here&lt;/a&gt; for an example of how
to use container_push with custom docker authentication credentials.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-container_push-custom-client-configuration" class="anchor" aria-hidden="true" href="#container_push-custom-client-configuration"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;container_push (Custom client configuration)&lt;/h3&gt;
&lt;p&gt;If you wish to use container_push using custom docker authentication credentials,
in &lt;code&gt;WORKSPACE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Download the rules_docker repository&lt;/span&gt;
http_archive(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;io_bazel_rules_docker&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-c1"&gt;...&lt;/span&gt;
)

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Load the macro that allows you to customize the docker toolchain configuration.&lt;/span&gt;
load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//toolchains/docker:toolchain.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;docker_toolchain_configure&lt;/span&gt;&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;toolchain_configure&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;
)

docker_toolchain_configure(
  &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;docker_config&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Replace this with an absolute path to a directory which has a custom docker&lt;/span&gt;
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; client config.json. Note relative paths are not supported.&lt;/span&gt;
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Docker allows you to specify custom authentication credentials&lt;/span&gt;
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; in the client configuration JSON file.&lt;/span&gt;
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; See https://docs.docker.com/engine/reference/commandline/cli/#configuration-files&lt;/span&gt;
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; for more details.&lt;/span&gt;
  &lt;span class="pl-v"&gt;client_config&lt;/span&gt;&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;/path/to/docker/client/config-dir&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In &lt;code&gt;BUILD&lt;/code&gt; file:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//container:container.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;container_push&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

container_push(
   &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;push_foo&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
   &lt;span class="pl-v"&gt;image&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;:foo&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
   &lt;span class="pl-v"&gt;format&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;Docker&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
   &lt;span class="pl-v"&gt;registry&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;gcr.io&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
   &lt;span class="pl-v"&gt;repository&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;my-project/my-image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
   &lt;span class="pl-v"&gt;tag&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;dev&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;&lt;a id="user-content-container_pull-dockerhub" class="anchor" aria-hidden="true" href="#container_pull-dockerhub"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;container_pull (DockerHub)&lt;/h3&gt;
&lt;p&gt;In &lt;code&gt;WORKSPACE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;container_pull(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;official_ubuntu&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;registry&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;index.docker.io&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;repository&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;library/ubuntu&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;tag&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;14.04&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This can then be referenced in &lt;code&gt;BUILD&lt;/code&gt; files as &lt;code&gt;@official_ubuntu//image&lt;/code&gt;.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-container_pull-quayio" class="anchor" aria-hidden="true" href="#container_pull-quayio"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;container_pull (Quay.io)&lt;/h3&gt;
&lt;p&gt;In &lt;code&gt;WORKSPACE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;container_pull(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;etcd&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;registry&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;quay.io&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;repository&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;coreos/etcd&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;tag&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;latest&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This can then be referenced in &lt;code&gt;BUILD&lt;/code&gt; files as &lt;code&gt;@etcd//image&lt;/code&gt;.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-container_pull-bintrayio" class="anchor" aria-hidden="true" href="#container_pull-bintrayio"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;container_pull (Bintray.io)&lt;/h3&gt;
&lt;p&gt;In &lt;code&gt;WORKSPACE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;container_pull(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;artifactory&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;registry&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;docker.bintray.io&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;repository&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;jfrog/artifactory-pro&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This can then be referenced in &lt;code&gt;BUILD&lt;/code&gt; files as &lt;code&gt;@artifactory//image&lt;/code&gt;.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-container_pull-gitlab" class="anchor" aria-hidden="true" href="#container_pull-gitlab"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;container_pull (Gitlab)&lt;/h3&gt;
&lt;p&gt;In &lt;code&gt;WORKSPACE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;container_pull(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;gitlab&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;registry&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;registry.gitlab.com&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;repository&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;username/project/image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;tag&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;tag&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This can then be referenced in &lt;code&gt;BUILD&lt;/code&gt; files as &lt;code&gt;@gitlab//image&lt;/code&gt;.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-container_pull-custom-client-configuration" class="anchor" aria-hidden="true" href="#container_pull-custom-client-configuration"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;container_pull (Custom client configuration)&lt;/h3&gt;
&lt;p&gt;If you specified a docker client directory using the &lt;code&gt;client_config&lt;/code&gt; attribute
to the docker toolchain configuration described &lt;a href="#setup"&gt;here&lt;/a&gt;, you
can use a container_pull that uses the authentication credentials from the
specified docker client directory as follows:&lt;/p&gt;
&lt;p&gt;In &lt;code&gt;WORKSPACE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@io_bazel_rules_docker//toolchains/docker:toolchain.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;docker_toolchain_configure&lt;/span&gt;&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;toolchain_configure&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;
)

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Configure the docker toolchain.&lt;/span&gt;
docker_toolchain_configure(
  &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;docker_config&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Path to the directory which has a custom docker client config.json with&lt;/span&gt;
  &lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; authentication credentials for registry.gitlab.com (used in this example).&lt;/span&gt;
  &lt;span class="pl-v"&gt;client_config&lt;/span&gt;&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;/path/to/docker/client/config&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; Load the custom version of container_pull created by the docker toolchain&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;#&lt;/span&gt; configuration.&lt;/span&gt;
load(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;@docker_config//:pull.bzl&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-v"&gt;authenticated_container_pull&lt;/span&gt;&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;container_pull&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;)

authenticated_container_pull(
    &lt;span class="pl-v"&gt;name&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;gitlab&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;registry&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;registry.gitlab.com&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;repository&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;username/project/image&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-v"&gt;tag&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;tag&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This can then be referenced in &lt;code&gt;BUILD&lt;/code&gt; files as &lt;code&gt;@gitlab//image&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; This should only be used if a custom &lt;code&gt;client_config&lt;/code&gt; was set. If you want
to use the DOCKER_CONFIG env variable or the default home directory
use the standard &lt;code&gt;container_pull&lt;/code&gt; rule.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; This will only work on systems with Python &amp;gt;2.7.6&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-python-tools" class="anchor" aria-hidden="true" href="#python-tools"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Python tools&lt;/h2&gt;
&lt;p&gt;Starting with Bazel 0.25.0 it's possible to configure python toolchains
for &lt;code&gt;rules_docker&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;To use these features you need to enable the flags in the &lt;code&gt;.bazelrc&lt;/code&gt;
file at the root of this project.&lt;/p&gt;
&lt;p&gt;Use of these features require a python toolchain to be registered.
&lt;code&gt;//py_images/image.bzl:deps&lt;/code&gt; and &lt;code&gt;//py3_images/image.bzl:deps&lt;/code&gt; register a
default python toolchain (&lt;code&gt;//toolchains/python:container_py_toolchain&lt;/code&gt;)
that defines the path to python tools inside the default container used
for these rules.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-known-issues-1" class="anchor" aria-hidden="true" href="#known-issues-1"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Known issues&lt;/h3&gt;
&lt;p&gt;If you are using a custom base for &lt;code&gt;py_image&lt;/code&gt; or &lt;code&gt;py3_image&lt;/code&gt; builds that has
python tools installed in a different location to those defined in
&lt;code&gt;//toolchains/python:container_py_toolchain&lt;/code&gt;, you will need to create a
toolchain that points to these paths and register it &lt;em&gt;before&lt;/em&gt; the call to
&lt;code&gt;py*_images/image.bzl:deps&lt;/code&gt; in your &lt;code&gt;WORKSPACE&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Use of python toolchain features, currently, only supports picking one
version of python for execution of host tools. &lt;code&gt;rules_docker&lt;/code&gt; heavily depends
on execution of python host tools that are only compatible with python 2.
Flags in the recommended &lt;code&gt;.bazelrc&lt;/code&gt; file force all host tools to use python 2.
If your project requires using host tools that are only compatible with
python 3 you will not be able to use these features at the moment. We
expect this issue to be resolved before use of python toolchain features
becomes the default.&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-updating-the-distroless-base-images" class="anchor" aria-hidden="true" href="#updating-the-distroless-base-images"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Updating the &lt;code&gt;distroless&lt;/code&gt; base images.&lt;/h2&gt;
&lt;p&gt;The digest references to the &lt;code&gt;distroless&lt;/code&gt; base images must be updated over time
to pick up bug fixes and security patches.  To facilitate this, the files
containing the digest references are generated by &lt;code&gt;tools/update_deps.py&lt;/code&gt;.  To
update all of the dependencies, please run (from the root of the repository):&lt;/p&gt;
&lt;div class="highlight highlight-source-shell"&gt;&lt;pre&gt;./update_deps.sh&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Image references should not be updated individually because these images have
shared layers and letting them diverge could result in sub-optimal push and pull
performance.&lt;/p&gt;
&lt;p&gt;&lt;a name="user-content-container_pull"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-container_pull-1" class="anchor" aria-hidden="true" href="#container_pull-1"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;container_pull&lt;/h2&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;container_pull(name, registry, repository, digest, tag)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A repository rule that pulls down a Docker base image in a manner suitable for
use with &lt;code&gt;container_image&lt;/code&gt;'s &lt;code&gt;base&lt;/code&gt; attribute.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; container_pull now supports authentication using custom docker client
configuration. See &lt;a href="#container_pull-custom-client-configuration"&gt;here&lt;/a&gt; for details.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; Set &lt;code&gt;PULLER_TIMEOUT&lt;/code&gt; env variable to change the default 600s timeout.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; Set &lt;code&gt;DOCKER_REPO_CACHE&lt;/code&gt; env variable to make the container puller
cache downloaded layers at the directory specified as a value to this env
variable. The caching feature hasn't been thoroughly tested and may be thread
unsafe. If you notice flakiness after enabling it, see the warning below on how
to workaround it.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; &lt;code&gt;container_pull&lt;/code&gt; is suspected to have thread safety issues. To
ensure multiple container_pull(s) don't execute concurrently, please use the
bazel startup flag &lt;code&gt;--loading_phase_threads=1&lt;/code&gt; in your bazel invocation.&lt;/p&gt;
&lt;table&gt;
  
    
    
  
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th colspan="2"&gt;Attributes&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;name&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Name, required&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;Unique name for this repository rule.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;registry&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Registry Domain; required&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;The registry from which to pull the base image.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;repository&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Repository; required&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;The `repository` of images to pull from.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;digest&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;string; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;The `digest` of the Docker image to pull from the specified
           `repository`.&lt;/p&gt;
        &lt;p&gt;
          &lt;strong&gt;Note:&lt;/strong&gt; For reproducible builds, use of `digest`
          is recommended.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;tag&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;string; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;The `tag` of the Docker image to pull from the specified `repository`.
           If neither this nor `digest` is specified, this attribute defaults
           to `latest`.  If both are specified, then `tag` is ignored.&lt;/p&gt;
        &lt;p&gt;
          &lt;strong&gt;Note:&lt;/strong&gt; For reproducible builds, use of `digest`
          is recommended.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;os&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;string; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;When the specified image refers to a multi-platform
           &lt;a href="https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list" rel="nofollow"&gt;
           manifest list&lt;/a&gt;, the desired operating system. For example,
           &lt;code&gt;linux&lt;/code&gt; or
           &lt;code&gt;windows&lt;/code&gt;.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;os_version&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;string; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;When the specified image refers to a multi-platform
           &lt;a href="https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list" rel="nofollow"&gt;
           manifest list&lt;/a&gt;, the desired operating system version. For example,
           &lt;code&gt;10.0.10586&lt;/code&gt;.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;os_features&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;string list; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;When the specified image refers to a multi-platform
           &lt;a href="https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list" rel="nofollow"&gt;
           manifest list&lt;/a&gt;, the desired operating system features. For example,
           on Windows this might be &lt;code&gt;["win32k"]&lt;/code&gt;.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;architecture&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;string; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;When the specified image refers to a multi-platform
           &lt;a href="https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list" rel="nofollow"&gt;
           manifest list&lt;/a&gt;, the desired CPU architecture. For example,
           &lt;code&gt;amd64&lt;/code&gt; or &lt;code&gt;arm&lt;/code&gt;.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;cpu_variant&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;string; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;When the specified image refers to a multi-platform
           &lt;a href="https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list" rel="nofollow"&gt;
           manifest list&lt;/a&gt;, the desired CPU variant. For example, for ARM you
           may need to use &lt;code&gt;v6&lt;/code&gt; or &lt;code&gt;v7&lt;/code&gt;.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;platform_features&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;string list; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;When the specified image refers to a multi-platform
           &lt;a href="https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list" rel="nofollow"&gt;
           manifest list&lt;/a&gt;, the desired features. For example, this may
           include CPU features such as &lt;code&gt;["sse4", "aes"]&lt;/code&gt;.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;puller_darwin&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;label; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;A Mac 64-bit binary that implements the functionality provided by
           &lt;code&gt;//container/go/cmd/puller&lt;/code&gt;. Visible for testing purposes
           only.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;puller_linux&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;label; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;A Linux 64-bit binary that implements the functionality provided by
           &lt;code&gt;//container/go/cmd/puller&lt;/code&gt;. Visible for testing purposes
           only.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;docker_client_config&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;string; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;Specifies the directory to look for the docker client configuration. Don't use this directly.
           Specify the docker configuration directory using a custom docker toolchain configuration. Look
           for the &lt;code&gt;client_config&lt;/code&gt; attribute in &lt;code&gt;docker_toolchain_configure&lt;/code&gt; &lt;a href="#setup"&gt;here&lt;/a&gt; for
           details. See &lt;a href="#container_pull-custom-client-configuration"&gt;here&lt;/a&gt; for an example on
           how to use &lt;code&gt;container_pull&lt;/code&gt; after configuring the docker toolchain&lt;/p&gt;
        &lt;p&gt;When left unspecified (ie not set explicitly or set by the docker toolchain), docker will use
        the directory specified via the DOCKER_CONFIG environment variable. If DOCKER_CONFIG isn't set,
        docker falls back to $HOME/.docker.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;a name="user-content-container_push"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-container_push-1" class="anchor" aria-hidden="true" href="#container_push-1"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;container_push&lt;/h2&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;container_push(name, image, registry, repository, tag)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;An executable rule that pushes a Docker image to a Docker registry on &lt;code&gt;bazel run&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; container_push now supports authentication using custom docker client
configuration. See &lt;a href="#container_push-custom-client-configuration"&gt;here&lt;/a&gt; for details.&lt;/p&gt;
&lt;table&gt;
  
    
    
  
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th colspan="2"&gt;Attributes&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;name&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Name, required&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;Unique name for this rule.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;format&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Kind, required&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;The desired format of the published image.  Currently, this supports
	   &lt;code&gt;Docker&lt;/code&gt; and &lt;code&gt;OCI&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;image&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Label; required&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;The label containing a Docker image to publish.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;registry&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Registry Domain; required&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;The registry to which to publish the image.&lt;/p&gt;
	&lt;p&gt;This field supports stamp variables.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;repository&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Repository; required&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;The `repository` of images to which to push.&lt;/p&gt;
	&lt;p&gt;This field supports stamp variables.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;tag&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;string; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;The `tag` of the Docker image to push to the specified `repository`.
           This attribute defaults to `latest`.&lt;/p&gt;
	&lt;p&gt;This field supports stamp variables.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;stamp&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Bool; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;Deprecated: it is now automatically inferred.&lt;/p&gt;
        &lt;p&gt;If true, enable use of workspace status variables
        (e.g. &lt;code&gt;BUILD_USER&lt;/code&gt;, &lt;code&gt;BUILD_EMBED_LABEL&lt;/code&gt;,
        and custom values set using &lt;code&gt;--workspace_status_command&lt;/code&gt;)
        in tags.&lt;/p&gt;
        &lt;p&gt;These fields are specified in the tag using Python format
        syntax, e.g.
        &lt;code&gt;example.org/{BUILD_USER}/image:{BUILD_EMBED_LABEL}&lt;/code&gt;.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;a name="user-content-container_layer"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-container_layer" class="anchor" aria-hidden="true" href="#container_layer"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;container_layer&lt;/h2&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;container_layer(data_path, directory, empty_dirs, files, mode, tars, debs, symlinks, env)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A rule that assembles data into a tarball which can be use as in &lt;code&gt;layers&lt;/code&gt; attr in &lt;code&gt;container_image&lt;/code&gt; rule.&lt;/p&gt;
&lt;table&gt;
  
    
    
  
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th colspan="2"&gt;Implicit output targets&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;&lt;i&gt;name&lt;/i&gt;-layer.tar&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;A tarball of current layer&lt;/code&gt;
        &lt;p&gt;
            A data tarball corresponding to the layer.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;table&gt;
  
    
    
  
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th colspan="2"&gt;Attributes&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;name&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;Name, required&lt;/code&gt;
        &lt;p&gt;A unique name for this rule.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;data_path&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;String, optional&lt;/code&gt;
        &lt;p&gt;Root path of the files.&lt;/p&gt;
        &lt;p&gt;
          The directory structure from the files is preserved inside the
          Docker image, but a prefix path determined by `data_path`
          is removed from the directory structure. This path can
          be absolute from the workspace root if starting with a `/` or
          relative to the rule's directory. A relative path may starts with "./"
          (or be ".") but cannot use go up with "..". By default, the
          `data_path` attribute is unused, and all files should have no prefix.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;directory&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;String, optional&lt;/code&gt;
        &lt;p&gt;Target directory.&lt;/p&gt;
        &lt;p&gt;
          The directory in which to expand the specified files, defaulting to '/'.
          Only makes sense accompanying one of files/tars/debs.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;empty_dirs&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;List of directories, optional&lt;/code&gt;
        &lt;p&gt;Directory to add to the layer.&lt;/p&gt;
        &lt;p&gt;
          A list of empty directories that should be created in the Docker image.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;files&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;List of files, optional&lt;/code&gt;
        &lt;p&gt;File to add to the layer.&lt;/p&gt;
        &lt;p&gt;
          A list of files that should be included in the Docker image.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;mode&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;String, default to 0o555&lt;/code&gt;
        &lt;p&gt;
          Set the mode of files added by the &lt;code&gt;files&lt;/code&gt; attribute.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;tars&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;List of files, optional&lt;/code&gt;
        &lt;p&gt;Tar file to extract in the layer.&lt;/p&gt;
        &lt;p&gt;
          A list of tar files whose content should be in the Docker image.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;debs&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;List of files, optional&lt;/code&gt;
        &lt;p&gt;Debian package to install.&lt;/p&gt;
        &lt;p&gt;
          A list of debian packages that will be installed in the Docker image.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;symlinks&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;Dictionary, optional&lt;/code&gt;
        &lt;p&gt;Symlinks to create in the Docker image.&lt;/p&gt;
        &lt;p&gt;
          &lt;code&gt;
          symlinks = {
           "/path/to/link": "/path/to/target",
           ...
          },
          &lt;/code&gt;
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;env&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;Dictionary from strings to strings, optional&lt;/code&gt;
        &lt;p&gt;&lt;a href="https://docs.docker.com/engine/reference/builder/#env" rel="nofollow"&gt;Dictionary
               from environment variable names to their values when running the
               Docker image.&lt;/a&gt;&lt;/p&gt;
        &lt;p&gt;
          &lt;code&gt;
          env = {
            "FOO": "bar",
            ...
          },
          &lt;/code&gt;
        &lt;/p&gt;
	&lt;p&gt;The values of this field support make variables (e.g., &lt;code&gt;$(FOO)&lt;/code&gt;) and stamp variables; keys support make variables as well.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;a name="user-content-container_image"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-container_image-1" class="anchor" aria-hidden="true" href="#container_image-1"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;container_image&lt;/h2&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;container_image(name, base, data_path, directory, files, legacy_repository_naming, mode, tars, debs, symlinks, entrypoint, cmd, creation_time, env, labels, ports, volumes, workdir, layers, repository)&lt;/pre&gt;&lt;/div&gt;
&lt;table&gt;
  
    
    
  
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th colspan="2"&gt;Implicit output targets&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;&lt;i&gt;name&lt;/i&gt;.tar&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;The full Docker image&lt;/code&gt;
        &lt;p&gt;
            A full Docker image containing all the layers, identical to
            what &lt;code&gt;docker save&lt;/code&gt; would return. This is
            only generated on demand.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;&lt;i&gt;name&lt;/i&gt;.digest&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;The full Docker image's digest&lt;/code&gt;
        &lt;p&gt;
            An image digest that can be used to refer to that image. Unlike tags,
            digest references are immutable i.e. always refer to the same content.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;&lt;i&gt;name&lt;/i&gt;-layer.tar&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;An image of the current layer&lt;/code&gt;
        &lt;p&gt;
            A Docker image containing only the layer corresponding to
            that target. It is used for incremental loading of the layer.
        &lt;/p&gt;
        &lt;p&gt;
            &lt;b&gt;Note:&lt;/b&gt; this target is not suitable for direct consumption.
            It is used for incremental loading and non-docker rules should
            depends on the Docker image (&lt;i&gt;name&lt;/i&gt;.tar) instead.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;&lt;i&gt;name&lt;/i&gt;&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;Incremental image loader&lt;/code&gt;
        &lt;p&gt;
            The incremental image loader. It will load only changed
            layers inside the Docker registry.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;table&gt;
  
    
    
  
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th colspan="2"&gt;Attributes&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;name&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;Name, required&lt;/code&gt;
        &lt;p&gt;A unique name for this rule.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;base&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;File, optional&lt;/code&gt;
        &lt;p&gt;
            The base layers on top of which to overlay this layer, equivalent to
            FROM.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;data_path&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;String, optional&lt;/code&gt;
        &lt;p&gt;Root path of the files.&lt;/p&gt;
        &lt;p&gt;
          The directory structure from the files is preserved inside the
          Docker image, but a prefix path determined by `data_path`
          is removed from the directory structure. This path can
          be absolute from the workspace root if starting with a `/` or
          relative to the rule's directory. A relative path may starts with "./"
          (or be ".") but cannot use go up with "..". By default, the
          `data_path` attribute is unused, and all files should have no prefix.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;directory&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;String, optional&lt;/code&gt;
        &lt;p&gt;Target directory.&lt;/p&gt;
        &lt;p&gt;
          The directory in which to expand the specified files, defaulting to '/'.
          Only makes sense accompanying one of files/tars/debs.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;files&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;List of files, optional&lt;/code&gt;
        &lt;p&gt;File to add to the layer.&lt;/p&gt;
        &lt;p&gt;
          A list of files that should be included in the Docker image.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;legacy_repository_naming&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;Bool, default to False&lt;/code&gt;
        &lt;p&gt;
          Whether to use the legacy strategy for setting the repository name
          embedded in the resulting tarball.
          e.g. &lt;code&gt;bazel/{target.replace('/', '_')}&lt;/code&gt;
          vs. &lt;code&gt;bazel/{target}&lt;/code&gt;
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;mode&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;String, default to 0o555&lt;/code&gt;
        &lt;p&gt;
          Set the mode of files added by the &lt;code&gt;files&lt;/code&gt; attribute.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;tars&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;List of files, optional&lt;/code&gt;
        &lt;p&gt;Tar file to extract in the layer.&lt;/p&gt;
        &lt;p&gt;
          A list of tar files whose content should be in the Docker image.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;debs&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;List of files, optional&lt;/code&gt;
        &lt;p&gt;Debian packages to extract.&lt;/p&gt;
        &lt;p&gt;
          Deprecated: A list of debian packages that will be extracted in the Docker image.
          Note that this doesn't actually install the packages. Installation needs apt
          or apt-get which need to be executed within a running container which
          &lt;code&gt;container_image&lt;/code&gt; can't do.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;symlinks&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;Dictionary, optional&lt;/code&gt;
        &lt;p&gt;Symlinks to create in the Docker image.&lt;/p&gt;
        &lt;p&gt;
          &lt;code&gt;
          symlinks = {
           "/path/to/link": "/path/to/target",
           ...
          },
          &lt;/code&gt;
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;user&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;String, optional&lt;/code&gt;
        &lt;p&gt;&lt;a href="https://docs.docker.com/engine/reference/builder/#user" rel="nofollow"&gt;The user
               that the image should run as.&lt;/a&gt;&lt;/p&gt;
        &lt;p&gt;Because building the image never happens inside a Docker container,
               this user does not affect the other actions (e.g.,
               adding files).&lt;/p&gt;
	&lt;p&gt;This field supports stamp variables.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;entrypoint&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;String or string list, optional&lt;/code&gt;
        &lt;p&gt;&lt;a href="https://docs.docker.com/engine/reference/builder/#entrypoint" rel="nofollow"&gt;List
               of entrypoints to add in the image.&lt;/a&gt;&lt;/p&gt;
        &lt;p&gt;
          Set &lt;code&gt;entrypoint&lt;/code&gt; to &lt;code&gt;None&lt;/code&gt;, &lt;code&gt;[]&lt;/code&gt;
          or &lt;code&gt;""&lt;/code&gt; will set the &lt;code&gt;Entrypoint&lt;/code&gt; of the image
          to be &lt;code&gt;null&lt;/code&gt;.
        &lt;/p&gt;
	      &lt;p&gt;This field supports stamp variables.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;cmd&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;String or string list, optional&lt;/code&gt;
        &lt;p&gt;&lt;a href="https://docs.docker.com/engine/reference/builder/#cmd" rel="nofollow"&gt;List
               of commands to execute in the image.&lt;/a&gt;&lt;/p&gt;
        &lt;p&gt;
          Set &lt;code&gt;cmd&lt;/code&gt; to &lt;code&gt;None&lt;/code&gt;, &lt;code&gt;[]&lt;/code&gt;
          or &lt;code&gt;""&lt;/code&gt; will set the &lt;code&gt;Cmd&lt;/code&gt; of the image to be
          &lt;code&gt;null&lt;/code&gt;.
        &lt;/p&gt;
	      &lt;p&gt;This field supports stamp variables.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;creation_time&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;String, optional, default to {BUILD_TIMESTAMP} when stamp = True, otherwise 0&lt;/code&gt;
        &lt;p&gt;The image's creation timestamp.&lt;/p&gt;
        &lt;p&gt;Acceptable formats: Integer or floating point seconds since Unix
           Epoch, RFC 3339 date/time.&lt;/p&gt;
        &lt;p&gt;This field supports stamp variables.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;env&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;Dictionary from strings to strings, optional&lt;/code&gt;
        &lt;p&gt;&lt;a href="https://docs.docker.com/engine/reference/builder/#env" rel="nofollow"&gt;Dictionary
               from environment variable names to their values when running the
               Docker image.&lt;/a&gt;&lt;/p&gt;
        &lt;p&gt;
          &lt;code&gt;
          env = {
            "FOO": "bar",
            ...
          },
          &lt;/code&gt;
        &lt;/p&gt;
	&lt;p&gt;The values of this field support make variables (e.g., &lt;code&gt;$(FOO)&lt;/code&gt;) and stamp variables; keys support make variables as well.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;labels&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;Dictionary from strings to strings, optional&lt;/code&gt;
        &lt;p&gt;&lt;a href="https://docs.docker.com/engine/reference/builder/#label" rel="nofollow"&gt;Dictionary
               from custom metadata names to their values. You can also put a
               file name prefixed by '@' as a value. Then the value is replaced
               with the contents of the file.&lt;/a&gt;&lt;/p&gt;
        &lt;p&gt;
          &lt;code&gt;
          labels = {
            "com.example.foo": "bar",
            "com.example.baz": "@metadata.json",
            ...
          },
          &lt;/code&gt;
        &lt;/p&gt;
	&lt;p&gt;The values of this field support stamp variables.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;ports&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;String list, optional&lt;/code&gt;
        &lt;p&gt;&lt;a href="https://docs.docker.com/engine/reference/builder/#expose" rel="nofollow"&gt;List
               of ports to expose.&lt;/a&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;volumes&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;String list, optional&lt;/code&gt;
        &lt;p&gt;&lt;a href="https://docs.docker.com/engine/reference/builder/#volumes" rel="nofollow"&gt;List
               of volumes to mount.&lt;/a&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;workdir&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;String, optional&lt;/code&gt;
        &lt;p&gt;&lt;a href="https://docs.docker.com/engine/reference/builder/#workdir" rel="nofollow"&gt;Initial
               working directory when running the Docker image.&lt;/a&gt;&lt;/p&gt;
        &lt;p&gt;Because building the image never happens inside a Docker container,
               this working directory does not affect the other actions (e.g.,
               adding files).&lt;/p&gt;
	&lt;p&gt;This field supports stamp variables.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;layers&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;Label list, optional&lt;/code&gt;
        &lt;p&gt;List of `container_layer` targets. &lt;/p&gt;
        &lt;p&gt;The data from each `container_layer` will be part of container image, and the environment variable will be available in the image as well.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;repository&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;code&gt;String, default to `bazel`&lt;/code&gt;
        &lt;p&gt;The repository for the default tag for the image.&lt;/p&gt;
        &lt;p&gt;Images generated by `container_image` are tagged by default to
           `bazel/package_name:target` for a `container_image` target at
           `//package/name:target`. Setting this attribute to
           `gcr.io/dummy` would set the default tag to
           `gcr.io/dummy/package_name:target`.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;stamp&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Bool; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;If true, enable use of workspace status variables
        (e.g. &lt;code&gt;BUILD_USER&lt;/code&gt;, &lt;code&gt;BUILD_EMBED_LABEL&lt;/code&gt;,
        and custom values set using &lt;code&gt;--workspace_status_command&lt;/code&gt;)
        in tags.&lt;/p&gt;
        &lt;p&gt;These fields are specified in attributes using Python format
        syntax, e.g. &lt;code&gt;foo{BUILD_USER}bar&lt;/code&gt;.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;launcher&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Label; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;If present, prefix the image's ENTRYPOINT with this file.
        Note that the launcher should be a container-compatible (OS &amp;amp; Arch)
        single executable file without any runtime dependencies (as none
        of its runfiles will be included in the image).
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;launcher_args&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;String list; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;Optional arguments for the &lt;code&gt;launcher&lt;/code&gt; attribute.
        Only valid when &lt;code&gt;launcher&lt;/code&gt; is specified.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;legacy_run_behavior&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Bool; optional, default to True&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;If set to False, &lt;code&gt;bazel run&lt;/code&gt; on the
        &lt;code&gt;container_image&lt;/code&gt; target will directly invoke
        &lt;code&gt;docker run&lt;/code&gt;.&lt;/p&gt;
        &lt;p&gt;Note that it defaults to &lt;code&gt;False&lt;/code&gt; when using
        &lt;code&gt;&amp;lt;lang&amp;gt;_image&lt;/code&gt; rules.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;docker_run_flags&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;String; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;Optional flags to use with &lt;code&gt;docker run&lt;/code&gt; command.&lt;/p&gt;
        &lt;p&gt;Only used when &lt;code&gt;legacy_run_behavior&lt;/code&gt; is set to
        &lt;code&gt;False&lt;/code&gt;.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;table&gt;
  
    
    
  
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th colspan="2"&gt;Toolchains&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;@io_bazel_rules_docker//toolchains/docker:toolchain_type&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        See &lt;a href="toolchains/docker/readme.md#how-to-use-the-docker-toolchain"&gt;How to use the Docker Toolchain&lt;/a&gt; for details
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;a name="user-content-container_bundle"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-container_bundle-1" class="anchor" aria-hidden="true" href="#container_bundle-1"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;container_bundle&lt;/h2&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;container_bundle(name, images)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A rule that aliases and saves N images into a single &lt;code&gt;docker save&lt;/code&gt; tarball.&lt;/p&gt;
Toolchains
      &lt;table&gt;
  
    
    
  
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th colspan="2"&gt;Attributes&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;name&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Name, required&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;Unique name for this rule.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;images&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Map of Tag to image Label; required&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;A collection of the images to save into the tarball.&lt;/p&gt;
        &lt;p&gt;The keys are the tags with which to alias the image specified by the
           value. These tags may contain make variables (&lt;code&gt;$FOO&lt;/code&gt;),
           and if &lt;code&gt;stamp&lt;/code&gt; is set to true, may also contain workspace
           status variables (&lt;code&gt;{BAR}&lt;/code&gt;).&lt;/p&gt;
        &lt;p&gt;The values may be the output of &lt;code&gt;container_pull&lt;/code&gt;,
           &lt;code&gt;container_image&lt;/code&gt;, or a &lt;code&gt;docker save&lt;/code&gt; tarball.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;&lt;td&gt;&lt;code&gt;stamp&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Bool; optional&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;Deprecated: it is now automatically inferred.&lt;/p&gt;
        &lt;p&gt;If true, enable use of workspace status variables
        (e.g. &lt;code&gt;BUILD_USER&lt;/code&gt;, &lt;code&gt;BUILD_EMBED_LABEL&lt;/code&gt;,
        and custom values set using &lt;code&gt;--workspace_status_command&lt;/code&gt;)
        in tags.&lt;/p&gt;
        &lt;p&gt;These fields are specified in the tag using Python format
        syntax, e.g.
        &lt;code&gt;example.org/{BUILD_USER}/image:{BUILD_EMBED_LABEL}&lt;/code&gt;.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;a name="user-content-container_import"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-container_import" class="anchor" aria-hidden="true" href="#container_import"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;container_import&lt;/h2&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;container_import(name, config, layers)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A rule that imports a docker image into our intermediate form.&lt;/p&gt;
&lt;table&gt;
  
    
    
  
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th colspan="2"&gt;Attributes&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;name&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Name, required&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;Unique name for this rule.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;config&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;The v2.2 image's json configuration; required&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;A json configuration file containing the image's metadata.&lt;/p&gt;
        &lt;p&gt;This appears in `docker save` tarballs as `.json` and is
           referenced by `manifest.json` in the config field.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;layers&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;The list of layer `.tar`s or `.tar.gz`s; required&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;The list of layer &lt;code&gt;.tar.gz&lt;/code&gt; files in the order they
           appear in the &lt;code&gt;config.json&lt;/code&gt;'s layer section, or in the
           order that they appear in &lt;code&gt;docker save&lt;/code&gt; tarballs'
           &lt;code&gt;manifest.json&lt;/code&gt; &lt;code&gt;Layers&lt;/code&gt; field (these may or
           may not be gzipped). Note that the layers should each have a
           different basename.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;a name="user-content-container_load"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-container_load" class="anchor" aria-hidden="true" href="#container_load"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;container_load&lt;/h2&gt;
&lt;div class="highlight highlight-source-python"&gt;&lt;pre&gt;container_load(name, &lt;span class="pl-v"&gt;file&lt;/span&gt;)&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A repository rule that examines the contents of a &lt;code&gt;docker save&lt;/code&gt; tarball and
creates a &lt;code&gt;container_import&lt;/code&gt; target. The created target can be referenced as
&lt;code&gt;@label_name//image&lt;/code&gt;.&lt;/p&gt;
&lt;table&gt;
  
    
    
  
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th colspan="2"&gt;Attributes&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;name&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Name, required&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;Unique name for this rule.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;file&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;The `docker save` tarball file; required&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;A label targeting a single file which is a compressed or
           uncompressed tar, as obtained through `docker save IMAGE`.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2&gt;&lt;a id="user-content-adopters" class="anchor" aria-hidden="true" href="#adopters"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Adopters&lt;/h2&gt;
&lt;p&gt;Here's a (non-exhaustive) list of companies that use &lt;code&gt;rules_docker&lt;/code&gt; in production. Don't see yours? &lt;a href="https://github.com/bazelbuild/rules_docker/edit/master/README.md"&gt;You can add it in a PR!&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/amaizfinance"&gt;Amaiz&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://auradevices.io/" rel="nofollow"&gt;Aura Devices&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://usebutton.com" rel="nofollow"&gt;Button&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://canva.com" rel="nofollow"&gt;Canva&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.etsy.com" rel="nofollow"&gt;Etsy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://evertz.com/" rel="nofollow"&gt;Evertz&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.jetstack.io/" rel="nofollow"&gt;Jetstack&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/kubernetes-sigs/k8s-container-image-promoter"&gt;Kubernetes Container Image Promoter&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://nordstrom.com" rel="nofollow"&gt;Nordstrom&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/kubernetes/test-infra/tree/master/prow"&gt;Prow&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.tink.com" rel="nofollow"&gt;Tink&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.wix.com" rel="nofollow"&gt;Wix&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/article&gt;&lt;/div&gt;</description><author>bazelbuild</author><guid isPermaLink="false">https://github.com/bazelbuild/rules_docker</guid><pubDate>Thu, 06 Feb 2020 00:02:00 GMT</pubDate></item><item><title>bazelbuild/rules_nodejs #3 in Starlark, This month</title><link>https://github.com/bazelbuild/rules_nodejs</link><description>&lt;p&gt;&lt;i&gt;JavaScript and NodeJS rules for Bazel&lt;/i&gt;&lt;/p&gt;&lt;div id="readme" class="md" data-path="README.md"&gt;&lt;article class="markdown-body entry-content p-5" itemprop="text"&gt;&lt;h1&gt;&lt;a id="user-content-javascript-rules-for-bazel" class="anchor" aria-hidden="true" href="#javascript-rules-for-bazel"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;JavaScript rules for Bazel&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="center"&gt;Circle CI&lt;/th&gt;
&lt;th align="center"&gt;Bazel CI&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="center"&gt;&lt;a href="https://circleci.com/gh/bazelbuild/rules_nodejs" rel="nofollow"&gt;&lt;img src="https://camo.githubusercontent.com/fd953ef125782640ff7103c7f626af7a135c034c/68747470733a2f2f636972636c6563692e636f6d2f67682f62617a656c6275696c642f72756c65735f6e6f64656a732e7376673f7374796c653d737667" alt="CircleCI" data-canonical-src="https://circleci.com/gh/bazelbuild/rules_nodejs.svg?style=svg" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td align="center"&gt;&lt;a href="https://buildkite.com/bazel/nodejs-rules-nodejs-postsubmit" rel="nofollow"&gt;&lt;img src="https://camo.githubusercontent.com/aaa3b11a22f6eb0ac53d6386e9e34223bc524f2b/68747470733a2f2f62616467652e6275696c646b6974652e636f6d2f61663161353932623339623131393233656630663532336362623232336464336462643631363239663862633831336330372e7376673f6272616e63683d6d6173746572" alt="Build status" data-canonical-src="https://badge.buildkite.com/af1a592b39b11923ef0f523cbb223dd3dbd61629f8bc813c07.svg?branch=master" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The nodejs rules integrate NodeJS development toolchain and runtime with Bazel.&lt;/p&gt;
&lt;p&gt;This toolchain can be used to build applications that target a browser runtime,
so this repo can be thought of as "JavaScript rules for Bazel" as well. (We would call this &lt;code&gt;rules_javascript&lt;/code&gt; if renames weren't so disruptive.)&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-documentation" class="anchor" aria-hidden="true" href="#documentation"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Documentation&lt;/h2&gt;
&lt;p&gt;Comprehensive documentation for installing and using the rules, including generated API docs:
&lt;a href="https://bazelbuild.github.io/rules_nodejs/" rel="nofollow"&gt;https://bazelbuild.github.io/rules_nodejs/&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-quickstart" class="anchor" aria-hidden="true" href="#quickstart"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Quickstart&lt;/h2&gt;
&lt;p&gt;This is the fastest way to get started.
See the &lt;a href="https://bazelbuild.github.io/rules_nodejs/install.html" rel="nofollow"&gt;installation documentation&lt;/a&gt; for details and alternative methods, or if you already have a Bazel project and you're adding Node/JavaScript support to it.&lt;/p&gt;
&lt;div class="highlight highlight-source-shell"&gt;&lt;pre&gt;$ npm init @bazel&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;or if you prefer yarn,&lt;/p&gt;
&lt;div class="highlight highlight-source-shell"&gt;&lt;pre&gt;$ yarn create @bazel&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;These commands are equivalent to &lt;code&gt;npx @bazel/create&lt;/code&gt; which downloads the latest version of the &lt;code&gt;@bazel/create&lt;/code&gt; package from npm and runs the program contained.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;See the output of the tool for command-line options and next steps.&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-adopters" class="anchor" aria-hidden="true" href="#adopters"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Adopters&lt;/h2&gt;
&lt;p&gt;Thanks to the following active users!&lt;/p&gt;
&lt;p&gt;Open-source repositories:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Angular: &lt;a href="https://github.com/angular/angular"&gt;Angular monorepo&lt;/a&gt;, &lt;a href="https://github.com/angular/angular-cli"&gt;CLI&lt;/a&gt;, &lt;a href="https://github.com/angular/components"&gt;Components&lt;/a&gt;, &lt;a href="https://github.com/angular/universal"&gt;Universal&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Tensorflow: &lt;a href="https://github.com/tensorflow/tfjs"&gt;tf.js&lt;/a&gt; and &lt;a href="https://github.com/tensorflow/tensorboard"&gt;tensorboard&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/SeleniumHQ/selenium"&gt;Selenium&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/ngrx/platform"&gt;NgRX&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/angular/tsickle"&gt;tsickle&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/google/incremental-dom"&gt;incremental-dom&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/dataform-co/dataform"&gt;dataform&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/kubernetes/test-infra"&gt;Kubernetes test-infra&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/improbable-eng/ts-protoc-gen"&gt;ts-protoc-gen&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/thesayyn/protoc-gen-ts"&gt;protoc-gen-ts&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Organizations:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.evertz.com" rel="nofollow"&gt;Evertz&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.lucidchart.com" rel="nofollow"&gt;Lucidchart&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.webdox.cl" rel="nofollow"&gt;Webdox&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.wemaintain.com" rel="nofollow"&gt;WeMaintain&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Not on this list? &lt;a href="https://github.com/bazelbuild/rules_nodejs/edit/master/README.md"&gt;Send a PR&lt;/a&gt; to add your repo or organization!&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-user-testimonials" class="anchor" aria-hidden="true" href="#user-testimonials"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;User testimonials&lt;/h2&gt;
&lt;p&gt;From &lt;a href="https://github.com/lewish"&gt;Lewis Hemens&lt;/a&gt; at Dataform:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;At Dataform we manage a number of NPM packages, Webpack builds, Node services and Java pipelines across two separate repositories. This quickly became hard for us to manage, development was painful and and deploying code required a many manual steps. We decided to dive in and migrate our build system entirely to Bazel. This was a gradual transition that one engineer did over the course of about 2 months, during which we had both Bazel and non bazel build processes in place. Once we had fully migrated, we saw many benefits to all parts of our development workflow:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Faster CI: we enabled the remote build caching which has reduced our average build time from 30 minutes to 5 (for the entire repository)&lt;/li&gt;
&lt;li&gt;Improvements to local development: no more random bash scripts that you forget to run, incremental builds reduced to seconds from minutes&lt;/li&gt;
&lt;li&gt;Simplified deployment processes: we can deploy our code to environments in Kubernetes with just one command that builds and pushes images&lt;/li&gt;
&lt;li&gt;A monorepo that scales: adding new libraries or packages to our repo became easy, which means we do it more and end up write more modular, shared, maintainable code&lt;/li&gt;
&lt;li&gt;Developing across machine types: our engineers have both Macbooks and Linux machines, bazel makes it easy to build code across both&lt;/li&gt;
&lt;li&gt;Developer setup time: New engineers can build all our code with just 3 dependencies - bazel, docker and the JVM. The last engineer to join our team managed to build all our code in &amp;lt; 30 minutes on a brand new, empty laptop&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/article&gt;&lt;/div&gt;</description><author>bazelbuild</author><guid isPermaLink="false">https://github.com/bazelbuild/rules_nodejs</guid><pubDate>Thu, 06 Feb 2020 00:03:00 GMT</pubDate></item></channel></rss>