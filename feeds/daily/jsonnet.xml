<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"><channel><title>GitHub Trending: Jsonnet, Today</title><link>https://github.com/trending/jsonnet?since=daily</link><description>The top repositories on GitHub for jsonnet, measured daily</description><pubDate>Tue, 03 Dec 2019 01:05:10 GMT</pubDate><lastBuildDate>Tue, 03 Dec 2019 01:05:10 GMT</lastBuildDate><generator>PyRSS2Gen-1.1.0</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><ttl>720</ttl><item><title>kubernetes-monitoring/kubernetes-mixin #1 in Jsonnet, Today</title><link>https://github.com/kubernetes-monitoring/kubernetes-mixin</link><description>&lt;p&gt;&lt;i&gt; A set of Grafana dashboards and Prometheus alerts for Kubernetes.&lt;/i&gt;&lt;/p&gt;&lt;div id="readme" class="instapaper_body md" data-path="README.md"&gt;&lt;article class="markdown-body entry-content p-5" itemprop="text"&gt;&lt;h1&gt;&lt;a id="user-content-prometheus-monitoring-mixin-for-kubernetes" class="anchor" aria-hidden="true" href="#prometheus-monitoring-mixin-for-kubernetes"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prometheus Monitoring Mixin for Kubernetes&lt;/h1&gt;
&lt;p&gt;&lt;a href="https://circleci.com/gh/kubernetes-monitoring/kubernetes-mixin" rel="nofollow"&gt;&lt;img src="https://camo.githubusercontent.com/d451e046d04bd62048ed4c44aa9affbb79e7ff97/68747470733a2f2f636972636c6563692e636f6d2f67682f6b756265726e657465732d6d6f6e69746f72696e672f6b756265726e657465732d6d6978696e2f747265652f6d61737465722e7376673f7374796c653d736869656c64" alt="CircleCI" data-canonical-src="https://circleci.com/gh/kubernetes-monitoring/kubernetes-mixin/tree/master.svg?style=shield" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;NOTE: This project is &lt;em&gt;pre-release&lt;/em&gt; stage. Flags, configuration, behaviour and design may change significantly in following releases.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;A set of Grafana dashboards and Prometheus alerts for Kubernetes.&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-releases" class="anchor" aria-hidden="true" href="#releases"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Releases&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Release&lt;/th&gt;
&lt;th&gt;Kubernetes Compatibility&lt;/th&gt;
&lt;th&gt;Prometheus Compatibility&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;master&lt;/td&gt;
&lt;td&gt;Kubernetes 1.14+&lt;/td&gt;
&lt;td&gt;Prometheus 2.11.0+&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;v0.1.x&lt;/td&gt;
&lt;td&gt;Kubernetes 1.13 and before&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;In Kubernetes 1.14 there was a major &lt;a href="https://github.com/kubernetes/enhancements/issues/1206"&gt;metrics overhaul&lt;/a&gt; implemented.
Therefore v0.1.x of this repository is the last release to support Kubernetes 1.13 and previous version on a best effort basis.&lt;/p&gt;
&lt;p&gt;Some alerts now use Prometheus filters made available in Prometheus 2.11.0, which makes this version of Prometheus a dependency.&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-how-to-use" class="anchor" aria-hidden="true" href="#how-to-use"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;How to use&lt;/h2&gt;
&lt;p&gt;This mixin is designed to be vendored into the repo with your infrastructure config.
To do this, use &lt;a href="https://github.com/jsonnet-bundler/jsonnet-bundler"&gt;jsonnet-bundler&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;You then have three options for deploying your dashboards&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Generate the config files and deploy them yourself&lt;/li&gt;
&lt;li&gt;Use ksonnet to deploy this mixin along with Prometheus and Grafana&lt;/li&gt;
&lt;li&gt;Use prometheus-operator to deploy this mixin (TODO)&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;&lt;a id="user-content-generate-config-files" class="anchor" aria-hidden="true" href="#generate-config-files"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Generate config files&lt;/h2&gt;
&lt;p&gt;You can manually generate the alerts, dashboards and rules files, but first you
must install some tools:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ go get github.com/jsonnet-bundler/jsonnet-bundler/cmd/jb
$ brew install jsonnet
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Then, grab the mixin and its dependencies:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ git clone https://github.com/kubernetes-monitoring/kubernetes-mixin
$ cd kubernetes-mixin
$ jb install
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Finally, build the mixin:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ make prometheus_alerts.yaml
$ make prometheus_rules.yaml
$ make dashboards_out
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The &lt;code&gt;prometheus_alerts.yaml&lt;/code&gt; and &lt;code&gt;prometheus_rules.yaml&lt;/code&gt; file then need to passed
to your Prometheus server, and the files in &lt;code&gt;dashboards_out&lt;/code&gt; need to be imported
into you Grafana server.  The exact details will depending on how you deploy your
monitoring stack to Kubernetes.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-dashboards-for-windows-nodes" class="anchor" aria-hidden="true" href="#dashboards-for-windows-nodes"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Dashboards for Windows Nodes&lt;/h3&gt;
&lt;p&gt;There are separate dashboards for windows resources.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Compute Resources / Cluster(Windows)&lt;/li&gt;
&lt;li&gt;Compute Resources / Namespace(Windows)&lt;/li&gt;
&lt;li&gt;Compute Resources / Pod(Windows)&lt;/li&gt;
&lt;li&gt;USE Method / Cluster(Windows)&lt;/li&gt;
&lt;li&gt;USE Method / Node(Windows)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;These dashboards are based on metrics populated by wmi_exporter(&lt;a href="https://github.com/martinlindhe/wmi_exporter"&gt;https://github.com/martinlindhe/wmi_exporter&lt;/a&gt;) from each Windows node.&lt;/p&gt;
&lt;p&gt;Steps to configure wmi_exporter&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Download the latest version(v0.7.0 or higher) of wmi_exporter from release page(&lt;a href="https://github.com/martinlindhe/wmi_exporter/releases/"&gt;https://github.com/martinlindhe/wmi_exporter/releases/&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Install the wmi_exporter service.&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;  msiexec /i &amp;lt;path-to-msi-file&amp;gt; ENABLED_COLLECTORS=cpu,cs,logical_disk,net,os,system,container,memory LISTEN_PORT=&amp;lt;PORT&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start="3"&gt;
&lt;li&gt;Update the Prometheus server to scrap the metrics from wmi_exporter endpoint.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;&lt;a id="user-content-running-the-tests" class="anchor" aria-hidden="true" href="#running-the-tests"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Running the tests&lt;/h2&gt;
&lt;p&gt;Build the mixins, run the tests:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ docker run -v $(pwd):/tmp --entrypoint "/bin/promtool" prom/prometheus:latest test rules /tmp/tests.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;&lt;a id="user-content-using-with-prometheus-ksonnet" class="anchor" aria-hidden="true" href="#using-with-prometheus-ksonnet"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Using with prometheus-ksonnet&lt;/h2&gt;
&lt;p&gt;Alternatively you can also use the mixin with
&lt;a href="https://github.com/kausalco/public/tree/master/prometheus-ksonnet"&gt;prometheus-ksonnet&lt;/a&gt;,
a &lt;a href="https://github.com/ksonnet/ksonnet"&gt;ksonnet&lt;/a&gt; module to deploy a fully-fledged
Prometheus-based monitoring system for Kubernetes:&lt;/p&gt;
&lt;p&gt;Make sure you have the ksonnet v0.8.0:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ brew install https://raw.githubusercontent.com/ksonnet/homebrew-tap/82ef24cb7b454d1857db40e38671426c18cd8820/ks.rb
$ brew pin ks
$ ks version
ksonnet version: v0.8.0
jsonnet version: v0.9.5
client-go version: v1.6.8-beta.0+$Format:%h$
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In your config repo, if you don't have a ksonnet application, make a new one (will copy credentials from current context):&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ ks init &amp;lt;application name&amp;gt;
$ cd &amp;lt;application name&amp;gt;
$ ks env add default
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Grab the kubernetes-jsonnet module using and its dependencies, which include
the kubernetes-mixin:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ go get github.com/jsonnet-bundler/jsonnet-bundler/cmd/jb
$ jb init
$ jb install github.com/kausalco/public/prometheus-ksonnet

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Assuming you want to run in the default namespace ('environment' in ksonnet parlance), add the follow to the file &lt;code&gt;environments/default/main.jsonnet&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;local prometheus = import "prometheus-ksonnet/prometheus-ksonnet.libsonnet";

prometheus {
  _config+:: {
    namespace: "default",
  },
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Apply your config:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ ks apply default
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;&lt;a id="user-content-using-prometheus-operator" class="anchor" aria-hidden="true" href="#using-prometheus-operator"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Using prometheus-operator&lt;/h2&gt;
&lt;p&gt;TODO&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-multi-cluster-support" class="anchor" aria-hidden="true" href="#multi-cluster-support"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Multi-cluster support&lt;/h2&gt;
&lt;p&gt;Kubernetes-mixin can support dashboards across multiple clusters. You need either a multi-cluster &lt;a href="https://github.com/improbable-eng/thanos"&gt;Thanos&lt;/a&gt; installation with &lt;code&gt;external_labels&lt;/code&gt; configured or a &lt;a href="https://github.com/cortexproject/cortex"&gt;Cortex&lt;/a&gt; system where a cluster label exists. To enable this feature you need to configure the following:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    // Opt-in to multiCluster dashboards by overriding this and the clusterLabel.
    showMultiCluster: true,
    clusterLabel: '&amp;lt;your cluster label&amp;gt;',
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;&lt;a id="user-content-customising-the-mixin" class="anchor" aria-hidden="true" href="#customising-the-mixin"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Customising the mixin&lt;/h2&gt;
&lt;p&gt;Kubernetes-mixin allows you to override the selectors used for various jobs,
to match those used in your Prometheus set. You can also customize the dashboard
names and add grafana tags.&lt;/p&gt;
&lt;p&gt;In a new directory, add a file &lt;code&gt;mixin.libsonnet&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;local kubernetes = import "kubernetes-mixin/mixin.libsonnet";

kubernetes {
  _config+:: {
    kubeStateMetricsSelector: 'job="kube-state-metrics"',
    cadvisorSelector: 'job="kubernetes-cadvisor"',
    nodeExporterSelector: 'job="kubernetes-node-exporter"',
    kubeletSelector: 'job="kubernetes-kubelet"',
    grafanaK8s+:: {
      dashboardNamePrefix: 'Mixin / ',
      dashboardTags: ['kubernetes', 'infrastucture'],
    },
  },
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Then, install the kubernetes-mixin:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ jb init
$ jb install github.com/kubernetes-monitoring/kubernetes-mixin
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Generate the alerts, rules and dashboards:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ jsonnet -J vendor -S -e 'std.manifestYamlDoc((import "mixin.libsonnet").prometheusAlerts)' &amp;gt; alerts.yml
$ jsonnet -J vendor -S -e 'std.manifestYamlDoc((import "mixin.libsonnet").prometheusRules)' &amp;gt;files/rules.yml
$ jsonnet -J vendor -m files/dashboards -e '(import "mixin.libsonnet").grafanaDashboards'
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;&lt;a id="user-content-background" class="anchor" aria-hidden="true" href="#background"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Background&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;For more motivation, see
"&lt;a href="https://kccncna17.sched.com/event/CU8K/the-red-method-how-to-instrument-your-services-b-tom-wilkie-kausal?iframe=no&amp;amp;w=100%&amp;amp;sidebar=yes&amp;amp;bg=no" rel="nofollow"&gt;The RED Method: How to instrument your services&lt;/a&gt;" talk from CloudNativeCon Austin.&lt;/li&gt;
&lt;li&gt;For more information about monitoring mixins, see this &lt;a href="https://docs.google.com/document/d/1A9xvzwqnFVSOZ5fD3blKODXfsat5fg6ZhnKu9LK3lB4/edit#" rel="nofollow"&gt;design doc&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/article&gt;&lt;/div&gt;</description><author>kubernetes-monitoring</author><guid isPermaLink="false">https://github.com/kubernetes-monitoring/kubernetes-mixin</guid><pubDate>Tue, 03 Dec 2019 00:01:00 GMT</pubDate></item><item><title>alphagov/govuk-content-schemas #2 in Jsonnet, Today</title><link>https://github.com/alphagov/govuk-content-schemas</link><description>&lt;p&gt;&lt;i&gt;Definitions of the data formats used to represent content on GOV.UK&lt;/i&gt;&lt;/p&gt;&lt;div id="readme" class="instapaper_body md" data-path="README.md"&gt;&lt;article class="markdown-body entry-content p-5" itemprop="text"&gt;&lt;h1&gt;&lt;a id="user-content-govuk-content-schemas" class="anchor" aria-hidden="true" href="#govuk-content-schemas"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;GOV.UK content schemas&lt;/h1&gt;
&lt;p&gt;This repo contains schemas and examples of the content that uses them on GOV.UK.&lt;/p&gt;
&lt;p&gt;The aim of it is to support 'contract testing' between the frontend and
publisher apps by expressing the schema and examples in strict, machine
processable form.&lt;/p&gt;
&lt;p&gt;We use &lt;a href="http://json-schema.org/" rel="nofollow"&gt;JSON Schema&lt;/a&gt; to define the schemas.&lt;/p&gt;
&lt;p&gt;For each schema, there are three possible representations:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;the 'publisher' representation, which is used when a publishing application
transmits data to the content store.&lt;/li&gt;
&lt;li&gt;the 'frontend' representation, which is produced by the content store when a
frontend application requests data&lt;/li&gt;
&lt;li&gt;the 'notification' representation, which is used when broadcasting messages about content
items on the message queue&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;&lt;a id="user-content-howtos" class="anchor" aria-hidden="true" href="#howtos"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Howtos&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="docs/changing-a-schema.md"&gt;How to change a schema&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="docs/adding-a-new-schema.md"&gt;How to add a new content schema&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="docs/working-with-json-schema-keywords.md"&gt;Working with JSON Schema keywords&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="docs/contract-testing-howto.md"&gt;Adding contract tests to your app&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="docs/suggested-workflows.md"&gt;Suggested workflows&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="docs/why-contract-testing.md"&gt;Why do contract testing?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="docs/running-frontend-against-examples.md"&gt;Running your frontend against the examples and random content (content-store not needed)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="docs/deployment.md"&gt;Deployment&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;&lt;a id="user-content-background" class="anchor" aria-hidden="true" href="#background"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Background&lt;/h2&gt;
&lt;h3&gt;&lt;a id="user-content-publisher-schema-defined-using-component-parts" class="anchor" aria-hidden="true" href="#publisher-schema-defined-using-component-parts"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Publisher schema defined using component parts&lt;/h3&gt;
&lt;p&gt;Schemas are built from a single file defined in the formats directory.
An example file defining the schema is available in
&lt;a href="formats/_example.jsonnet"&gt;&lt;code&gt;formats/_example.jsonnet&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;These files are stored in the &lt;code&gt;govuk-content-schemas&lt;/code&gt; repository in the
&lt;a href="/formats"&gt;&lt;code&gt;formats&lt;/code&gt;&lt;/a&gt; subdirectory. A build process (implemented using a
&lt;a href="/Rakefile"&gt;&lt;code&gt;Rakefile&lt;/code&gt;&lt;/a&gt;) combines the three component files into the final
&lt;code&gt;schema.json&lt;/code&gt; file.&lt;/p&gt;
&lt;p&gt;The generated files are all stored in the &lt;a href="/dist/"&gt;&lt;code&gt;dist&lt;/code&gt;&lt;/a&gt; subdirectory.&lt;/p&gt;
&lt;p&gt;The build process applies the rules for the various different schema
representations.&lt;/p&gt;
&lt;p&gt;There are a number of shared definitions that are used across multiple schemas
these are defined in the &lt;a href="formats/shared"&gt;&lt;code&gt;formats/shared&lt;/code&gt;&lt;/a&gt; directory.&lt;/p&gt;
&lt;p&gt;Examples of schemas are available in the &lt;a href="examples"&gt;&lt;code&gt;examples&lt;/code&gt;&lt;/a&gt; directory.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;DO NOT EDIT FILES in the &lt;code&gt;dist&lt;/code&gt; directory directly&lt;/strong&gt;, instead, edit the source
files in the &lt;code&gt;formats&lt;/code&gt; directory.&lt;/p&gt;
&lt;p&gt;In summary the folder structure is:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;dist
└── formats
    └── case_study
        ├── frontend
        │   └── schema.json
        └── publisher
            └── schema.json
examples
└── case_study
    └── frontend
        ├── archived.json
        ├── case_study.json
        └── translated.json
formats
└── case_study.jsonnet

&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;&lt;a id="user-content-validation-of-examples" class="anchor" aria-hidden="true" href="#validation-of-examples"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Validation of examples&lt;/h3&gt;
&lt;p&gt;To validate examples against the generated schemas, use the &lt;code&gt;validate_examples&lt;/code&gt;
Rake task:&lt;/p&gt;
&lt;div class="highlight highlight-source-shell"&gt;&lt;pre&gt;$ bundle &lt;span class="pl-c1"&gt;exec&lt;/span&gt; rake validate_examples&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will print the errors out to the console if validation fails.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-rakefile" class="anchor" aria-hidden="true" href="#rakefile"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Rakefile&lt;/h3&gt;
&lt;p&gt;A &lt;code&gt;Rakefile&lt;/code&gt; exists which combines these scripts. It
automatically re-generates the intermediate schema files and validates all the
examples.&lt;/p&gt;
&lt;p&gt;To invoke the default task just invoke &lt;code&gt;rake&lt;/code&gt; on its own.&lt;/p&gt;
&lt;/article&gt;&lt;/div&gt;</description><author>alphagov</author><guid isPermaLink="false">https://github.com/alphagov/govuk-content-schemas</guid><pubDate>Tue, 03 Dec 2019 00:02:00 GMT</pubDate></item></channel></rss>