<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"><channel><title>GitHub Trending: TSQL, This week</title><link>https://github.com/trending/tsql?since=weekly</link><description>The top repositories on GitHub for tsql, measured weekly</description><pubDate>Sat, 04 Jan 2020 01:10:46 GMT</pubDate><lastBuildDate>Sat, 04 Jan 2020 01:10:46 GMT</lastBuildDate><generator>PyRSS2Gen-1.1.0</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><ttl>720</ttl><item><title>skr-shop/manuals #1 in TSQL, This week</title><link>https://github.com/skr-shop/manuals</link><description>&lt;p&gt;&lt;i&gt;Do design No code 📖&lt;/i&gt;&lt;/p&gt;&lt;div id="readme" class="md" data-path="README.md"&gt;&lt;article class="markdown-body entry-content p-5" itemprop="text"&gt;&lt;h1 align="center"&gt;&lt;a id="user-content-skrshop电商设计手册" class="anchor" aria-hidden="true" href="#skrshop电商设计手册"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;《SkrShop电商设计手册》&lt;/h1&gt;
&lt;p align="center"&gt;Do design No code | 只设计不码码&lt;/p&gt;
&lt;hr&gt;
&lt;p align="center"&gt;   
    &amp;lt;iframe src="&lt;a href="https://ghbtns.com/github-btn.html?user=skr-shop&amp;amp;repo=manuals&amp;amp;type=star&amp;amp;count=true" rel="nofollow"&gt;https://ghbtns.com/github-btn.html?user=skr-shop&amp;amp;repo=manuals&amp;amp;type=star&amp;amp;count=true&lt;/a&gt;" frameborder="0" scrolling="0" width="98px" height="20px" style="min-width: 98px;border: none"&amp;gt;&amp;lt;/iframe&amp;gt;
    &amp;lt;iframe src="&lt;a href="https://ghbtns.com/github-btn.html?user=skr-shop&amp;amp;repo=manuals&amp;amp;type=fork&amp;amp;count=true" rel="nofollow"&gt;https://ghbtns.com/github-btn.html?user=skr-shop&amp;amp;repo=manuals&amp;amp;type=fork&amp;amp;count=true&lt;/a&gt;" frameborder="0" scrolling="0" width="98px" height="20px" style="min-width: 98px;border: none"&amp;gt;&amp;lt;/iframe&amp;gt;
    &amp;lt;iframe src="&lt;a href="https://ghbtns.com/github-btn.html?user=skr-shop&amp;amp;repo=manuals&amp;amp;type=watch&amp;amp;count=true&amp;amp;v=2" rel="nofollow"&gt;https://ghbtns.com/github-btn.html?user=skr-shop&amp;amp;repo=manuals&amp;amp;type=watch&amp;amp;count=true&amp;amp;v=2&lt;/a&gt;" frameborder="0" scrolling="0" width="98px" height="20px" style="min-width: 98px;border: none"&amp;gt;&amp;lt;/iframe&amp;gt;
&lt;/p&gt;
&lt;p align="center"&gt;
    &lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/dbe58cf369e865e02bee095213d20ddbe169844d/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d434325323042592d2d4e432d2d4e44253230342e302d726564"&gt;&lt;img src="https://camo.githubusercontent.com/dbe58cf369e865e02bee095213d20ddbe169844d/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d434325323042592d2d4e432d2d4e44253230342e302d726564" alt="Lisense" data-canonical-src="https://img.shields.io/badge/License-CC%20BY--NC--ND%204.0-red" style="max-width:100%;"&gt;&lt;/a&gt;
&lt;/p&gt;
&lt;p align="center"&gt;&lt;a href="http://skrshop.tech/" rel="nofollow"&gt;skrshop.tech&lt;/a&gt;&lt;/p&gt;
&lt;p align="center"&gt;
    &lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/6231ff293c74cfcea7abf011f099cc4ee3017478/687474703a2f2f63646e2e7469676572622e636e2f32303139313232323136343832392e6a70673f696d6167654d6f6772322f7468756d626e61696c2f3132383078373230212f666f726d61742f776562702f626c75722f3178302f7175616c6974792f39307c696d616765736c696d"&gt;&lt;img width="60%" src="https://camo.githubusercontent.com/6231ff293c74cfcea7abf011f099cc4ee3017478/687474703a2f2f63646e2e7469676572622e636e2f32303139313232323136343832392e6a70673f696d6167654d6f6772322f7468756d626e61696c2f3132383078373230212f666f726d61742f776562702f626c75722f3178302f7175616c6974792f39307c696d616765736c696d" data-canonical-src="http://cdn.tigerb.cn/20191222164829.jpg?imageMogr2/thumbnail/1280x720!/format/webp/blur/1x0/quality/90|imageslim" style="max-width:100%;"&gt;&lt;/a&gt;
&lt;/p&gt;&lt;p&gt;
&lt;/p&gt;&lt;h1&gt;&lt;a id="user-content-版权申明" class="anchor" aria-hidden="true" href="#版权申明"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;版权申明&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;未经版权所有者明确授权，禁止发行本手册及其被实质上修改的版本。&lt;/li&gt;
&lt;li&gt;未经版权所有者事先授权，禁止将此作品及其衍生作品以标准（纸质）书籍形式发行。&lt;/li&gt;
&lt;/ul&gt;
&lt;p align="center"&gt;
    &lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/1a9b3df0d3afe609a121985fa3f5e3873650d2cc/687474703a2f2f63646e2e7469676572622e636e2f7765636861742d626c6f672d7172636f64652e6a70673f696d6167654d6f6772322f7468756d626e61696c2f32363078323630212f666f726d61742f776562702f626c75722f3178302f7175616c6974792f39307c696d616765736c696d"&gt;&lt;img width="25%" src="https://camo.githubusercontent.com/1a9b3df0d3afe609a121985fa3f5e3873650d2cc/687474703a2f2f63646e2e7469676572622e636e2f7765636861742d626c6f672d7172636f64652e6a70673f696d6167654d6f6772322f7468756d626e61696c2f32363078323630212f666f726d61742f776562702f626c75722f3178302f7175616c6974792f39307c696d616765736c696d" data-canonical-src="http://cdn.tigerb.cn/wechat-blog-qrcode.jpg?imageMogr2/thumbnail/260x260!/format/webp/blur/1x0/quality/90|imageslim" style="max-width:100%;"&gt;&lt;/a&gt;
    &lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/01c2b9d6c9c8a91c304e4a8e83589bf52faf0590/68747470733a2f2f6461797574616c6b2e636e2f696d672f7075622d71722e6a706567"&gt;&lt;img width="45%" src="https://camo.githubusercontent.com/01c2b9d6c9c8a91c304e4a8e83589bf52faf0590/68747470733a2f2f6461797574616c6b2e636e2f696d672f7075622d71722e6a706567" data-canonical-src="https://dayutalk.cn/img/pub-qr.jpeg" style="max-width:100%;"&gt;&lt;/a&gt;
    &lt;i&gt;&lt;/i&gt;
&lt;/p&gt;&lt;p&gt;
&lt;/p&gt;&lt;h1&gt;&lt;a id="user-content-star趋势" class="anchor" aria-hidden="true" href="#star趋势"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Star趋势&lt;/h1&gt;
&lt;p&gt;&lt;a href="https://starchart.cc/skr-shop/manuals" rel="nofollow"&gt;&lt;img src="https://camo.githubusercontent.com/131dae2eefb094f24521acd9cec866cc4dd010d1/68747470733a2f2f7374617263686172742e63632f736b722d73686f702f6d616e75616c732e737667" alt="Stargazers over time" data-canonical-src="https://starchart.cc/skr-shop/manuals.svg" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;&lt;a id="user-content-目录" class="anchor" aria-hidden="true" href="#目录"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;目录&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#%E5%89%8D%E8%A8%80"&gt;前言&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#%E6%8A%80%E6%9C%AF%E6%A0%88%E9%80%89%E5%9E%8B"&gt;技术栈选型&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#%E4%BB%A3%E7%A0%81%E4%BB%93%E5%BA%93"&gt;代码仓库&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#%E7%94%A8%E6%88%B7%E4%BD%93%E7%B3%BB"&gt;用户体系&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#%E8%B4%A6%E6%88%B7%E6%9C%8D%E5%8A%A1"&gt;账户服务&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#%E6%9D%83%E9%99%90%E6%9C%8D%E5%8A%A1"&gt;权限服务&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#%E8%B4%AD%E7%89%A9%E4%BD%93%E7%B3%BB"&gt;购物体系&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#%E5%95%86%E5%93%81%E7%B3%BB%E7%BB%9Ftemporal%E4%B8%87%E7%89%A9"&gt;商品系统(Temporal万物)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#%E8%B4%AD%E7%89%A9%E8%BD%A6%E6%9C%8D%E5%8A%A1"&gt;购物车服务&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;订单生成服务&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#%E8%90%A5%E9%94%80%E4%BD%93%E7%B3%BB"&gt;营销体系&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;活动营销系统
&lt;ul&gt;
&lt;li&gt;&lt;a href="#%E9%80%9A%E7%94%A8%E6%8A%BD%E5%A5%96%E5%B7%A5%E5%85%B7glue%E4%B8%87%E8%83%BD%E8%83%B6"&gt;通用抽奖工具(Glue万能胶)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;销售营销系统(满减/买送/加价购/限时购...)&lt;/li&gt;
&lt;li&gt;基础服务
&lt;ul&gt;
&lt;li&gt;优惠券服务&lt;/li&gt;
&lt;li&gt;积分服务&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#%E4%BA%A4%E6%98%93%E4%B8%AD%E5%BF%83"&gt;交易中心&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#%E5%B8%B8%E8%A7%81%E7%AC%AC%E4%B8%89%E6%96%B9%E6%94%AF%E4%BB%98%E6%B5%81%E7%A8%8B"&gt;常见第三方支付流程&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#%E6%94%AF%E4%BB%98%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1"&gt;支付系统设计&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;收银台&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#%E8%AE%A2%E5%8D%95%E4%B8%AD%E5%BF%83"&gt;订单中心&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#%E4%BB%93%E5%82%A8%E7%B3%BB%E7%BB%9F"&gt;仓储系统&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;地址服务&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#%E7%89%A9%E6%B5%81%E7%B3%BB%E7%BB%9F"&gt;物流系统&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#%E5%94%AE%E5%90%8E%E6%9C%8D%E5%8A%A1"&gt;售后服务&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#%E5%9F%BA%E7%A1%80%E6%9C%8D%E5%8A%A1"&gt;基础服务&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;秒抢工具(Gloden-Flash金色闪光)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;&lt;a id="user-content-前言" class="anchor" aria-hidden="true" href="#前言"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;前言&lt;/h1&gt;
&lt;p&gt;一直从事互联网电商开发三年多的时间了，回头想想却对整个业务流程不是很了解，说出去很是惭愧。但是身处互联网电商的环境中，或多或少接触了其中的各个业务，其次周边还有很多从事电商的同事和朋友，这都是资源。于是，我决定和我的同事、盆友们、甚至还有你们去梳理整个流程并分享出来，谈不上结果要做的多么好，至少在每一个我们有能力去做好的地方，一定会细致入微。&lt;/p&gt;
&lt;p&gt;除此之外，同时为了满足我们自身在工作中可能得不到的技术满足感，我们在做整个系统设计的过程中，会去使用我们最想用的技术栈。技术栈这一点我们借助docker去实现，所以最终的结果：一方面我们掌握了业务的东西，另一方面又得到了技术上的满足感，二者兼得。&lt;/p&gt;
&lt;p&gt;最后，出于时间的考虑，我们提出了一个想法&lt;strong&gt;Do design No code&lt;/strong&gt;。**【只设计不码码】**这句话的意思：最终我们设计出来整个系统的数据模型，接口文档，甚至交互过程，以及环境部署等，但是最后我们却不写代码。是吧？如果这样了写代码还有什么意义。当然，也不全是这样，出于时间的考虑当然也会用代码实现出来的，说不定最后正是对面的你去实现的。&lt;/p&gt;
&lt;p&gt;其次，这些内容肯定有考虑不全面或者在上规模的业务中存在更复杂的地方，欢迎指出，我们也希望学习和分享您的经验。&lt;/p&gt;
&lt;h1&gt;&lt;a id="user-content-技术栈选型" class="anchor" aria-hidden="true" href="#技术栈选型"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;技术栈选型&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;- 基础环境
    + k8s
    + docker
- 存储
    + mysql
    + redis
        * codis
        * redis主从
- queue
    + kafka
    + rocketmq
    + rabbitmq
- gw
    + kong
    + zuul
- webserver
    + nginx/openresty
    + envoy
- server
    + go
    + php
- frontend
    + vue
- rpc
    + grpc
    + thrift
- 基础能力
    + 监控
        * zipkin
        * elk
        * falcon
    + 服务发现
        * zookeeper
        * etcd
    + 持续集成
        * ci/cd
- 搜索
    + es
    + solr
&lt;/code&gt;&lt;/pre&gt;
&lt;h1&gt;&lt;a id="user-content-代码仓库" class="anchor" aria-hidden="true" href="#代码仓库"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;代码仓库&lt;/h1&gt;
&lt;p&gt;请您耐心等待...&lt;/p&gt;
&lt;h1&gt;&lt;a id="user-content-用户体系" class="anchor" aria-hidden="true" href="#用户体系"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;用户体系&lt;/h1&gt;
&lt;p&gt;今天，我们开始第一部分&lt;strong&gt;用户体系&lt;/strong&gt;的设计。本文分为如下四大模块：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;架构设计&lt;/li&gt;
&lt;li&gt;数据模型设计&lt;/li&gt;
&lt;li&gt;交互设计&lt;/li&gt;
&lt;li&gt;接口设计&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;&lt;a id="user-content-架构设计" class="anchor" aria-hidden="true" href="#架构设计"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;架构设计&lt;/h2&gt;
&lt;h3&gt;&lt;a id="user-content-简单来看用户体系" class="anchor" aria-hidden="true" href="#简单来看用户体系"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;简单来看用户体系&lt;/h3&gt;
&lt;p&gt;当你第一次接触和用户相关的互联网产品时，或者曾今在我眼里。&lt;strong&gt;用户体系&lt;/strong&gt;无非就是“登录”和“注册”，“修改用户信息”这些，等。简单来做的话，无非我们需要一张表去记录用户的身份信息：注册时(insert操作)，往表里插入一个数据；登录时(select&amp;amp;update操作)，通过用户标识(手机号、邮箱等)判断用户的密码是否正确；修改用户信息(select&amp;amp;update操作)，就是直接update这个uid的用户信息(头像、昵称等)。&lt;/p&gt;
&lt;p align="center"&gt;
    &lt;a href="http://cdn.tigerb.cn/skr-account-smaple-structure.png" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/527f12439e0dcd3e0e54b6450911a018c20c42d2/687474703a2f2f63646e2e7469676572622e636e2f736b722d6163636f756e742d736d61706c652d7374727563747572652e706e67" data-canonical-src="http://cdn.tigerb.cn/skr-account-smaple-structure.png" style="max-width:100%;"&gt;
    &lt;/a&gt;
&lt;/p&gt;
&lt;p&gt;这样设计的确没什么问题，很简单不是么。但是随着业务的发展，一方面我们需要提供统一的用户管理(高内聚)，又要提高系统的可扩展性，所以我想呈现出来的是我理解的&lt;strong&gt;一个基本用户体系应该有的东西&lt;/strong&gt;。&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-一个基本用户体系应该有的东西" class="anchor" aria-hidden="true" href="#一个基本用户体系应该有的东西"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;一个基本用户体系应该有的东西&lt;/h3&gt;
&lt;p&gt;首先我们对原有的用户表进行再一次的抽象(抽离用户注册、登录依赖的字段、第三方登录) -&amp;gt; &lt;strong&gt;账户表&lt;/strong&gt;，为什么这么做？随着业务的发展，以前只维护一个产品，也许某一天又开发新的产品，这样我们就可以统一的维护我们公司所有产品的注册登录逻辑，不同的产品只维护该产品和用户相关的信息即可(具体依赖产品形态)。如下图所示：&lt;/p&gt;
&lt;p align="center"&gt;
    &lt;a href="http://cdn.tigerb.cn/skr-user-system-2.png" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/cd0ad9da715d7209ebd7cb49ae95aa19324df213/687474703a2f2f63646e2e7469676572622e636e2f736b722d757365722d73797374656d2d322e706e67" data-canonical-src="http://cdn.tigerb.cn/skr-user-system-2.png" style="max-width:100%;"&gt;
    &lt;/a&gt;
&lt;/p&gt;
&lt;p&gt;上图中，还提到了第三方登录/员工表/后台权限管理，这些都是一些用户体系基本必备的结构。&lt;/p&gt;
&lt;p&gt;第三方登录：第三方也是登录方式的一种，我们也把它抽象到账户的一部分，如上图所示。其次，关于第三方登录这里存在一个交互方式设计存在的问题，后面交互设计时会提到。&lt;/p&gt;
&lt;p&gt;员工：因为上面我们抽离了账户表，所以内部的管理系统后台也可以统一的使用账户表的登录逻辑，这样全公司在账号这个事情上达到了真正的高内聚。&lt;/p&gt;
&lt;p&gt;提到了员工，我们的内部各种系统后台肯定涉及各种的权限管理，所以这里提到了简单的RBAC(基于角色的权限控制)，具体的逻辑数据模型设计会提到。&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-最终的架构" class="anchor" aria-hidden="true" href="#最终的架构"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;最终的架构&lt;/h3&gt;
&lt;p&gt;随着业务产品形态的越来越复杂，在设计架构的时候，我们需要分析其中的&lt;strong&gt;变与不变&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;变：越来越多的产品个性化用户需求&lt;/li&gt;
&lt;li&gt;不变：注册登录的逻辑&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;最终的结果，我们把原有的用户拆成了&lt;strong&gt;账户&lt;/strong&gt;和&lt;strong&gt;用户&lt;/strong&gt;，同时我们也要在这里明确这两个概念的区别：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;账户：整个体系唯一生产uid的地方，内聚注册登录逻辑，不涉及产品业务需求&lt;/li&gt;
&lt;li&gt;用户：不同产品个性化的用户需求信息&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;最终的架构图如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;第一部分：账户(&lt;strong&gt;服务层&lt;/strong&gt;)&lt;/li&gt;
&lt;li&gt;第二部分：用户(&lt;strong&gt;应用层&lt;/strong&gt;，无限水平扩展)&lt;/li&gt;
&lt;li&gt;第三部分：员工(&lt;strong&gt;应用层&lt;/strong&gt;，员工权限体系)&lt;/li&gt;
&lt;/ul&gt;
&lt;p align="center"&gt;
    &lt;a href="http://cdn.tigerb.cn/skr-account-structure.jpg" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/cbc1d067c6ea1901bc81229808e6561037c5fb51/687474703a2f2f63646e2e7469676572622e636e2f736b722d6163636f756e742d7374727563747572652e6a7067" data-canonical-src="http://cdn.tigerb.cn/skr-account-structure.jpg" style="max-width:100%;"&gt;
    &lt;/a&gt;
&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-数据模型设计" class="anchor" aria-hidden="true" href="#数据模型设计"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;数据模型设计&lt;/h2&gt;
&lt;p&gt;对应上面的架构，我们很容易设计出我们的数据模型(这里假设我们目前只有一个对C端的应用)：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;账户 -&amp;gt; 1.账户表
用户 -&amp;gt; 2.用户表
员工 -&amp;gt; 3.员工表
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;除了上面三张表外，还需要我们的R(role)B(base)A(access)C(control)权限管理,RBAC基于角色的权限管理大家应该很熟悉，这里我就不详细说了，简单的RBAC首先需要：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;4.系统菜单表(菜单即权限)，系统的uri路径
5.权限表(菜单即权限)，具体的权限就是访问系统的菜单
6.角色表，一个角色具有哪些权限
7.员工和角色的关联表，一个员工属于哪个角色
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;好了一个简单的RBAC涉及的表基本罗列出来了，但是在我的工作经历中大家实现的权限管理往往只针对某个系统，这样对于众多的系统后台来说就是乱、重复造轮子、权限管理效率低。所以我在上面的架构设计中把权限作为了一个服务为全系统提供基础服务能力。而达到这个目的的结果我只需要再增加一张表：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;8.后台管理系统表, 登记所有的后台管理系统(这样通过系统id和系统资源uri的id就可以全局构成唯一性，单纯的uri存在重复的可能性，用uri不用url的原因是域名存在变动的可能性)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最后我们的用户体系应该基本就上面8张表。咦，貌似漏掉了第三方登录，我们加上吧，很简单如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;9. 第三方用户登录表，记录不同第三方的用户标示
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最最后就是上面的9张表了，具体的表结构和sql如下：&lt;/p&gt;
&lt;p align="center"&gt;
    &lt;a href="http://cdn.tigerb.cn/skr-account-model.png" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/e1bac95f35c0781e8f5552855703f2db7f051ac1/687474703a2f2f63646e2e7469676572622e636e2f736b722d6163636f756e742d6d6f64656c2d322e706e67" data-canonical-src="http://cdn.tigerb.cn/skr-account-model-2.png" style="max-width:100%;"&gt;
    &lt;/a&gt;
&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-表sql" class="anchor" aria-hidden="true" href="#表sql"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;表sql&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;账户模型&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight highlight-source-sql"&gt;&lt;pre&gt;&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 账户模型&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;account_user&lt;/span&gt;` (
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;账号id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;email&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;30&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;邮箱&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;phone&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;15&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;手机号&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;username&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;30&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;用户名&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;password&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;32&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;密码&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_ip_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;12&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建ip&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;last_login_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;最后一次登录时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;last_login_ip_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;12&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;最后一次登录ip&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;login_times&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;登录次数&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 1:enable, 0:disable, -1:deleted&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  KEY &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_email&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;email&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  KEY &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_phone&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;phone&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  KEY &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_username&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;username&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;账户&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 第三方账户&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;account_platform&lt;/span&gt;` (
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;自增id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;uid&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;账号id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;platform_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;60&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;平台id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;platform_token&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;60&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;平台access_token&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;type&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;平台类型 0:未知,1:facebook,2:google,3:wechat,4:qq,5:weibo,6:twitter&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;nickname&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;60&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;昵称&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;avatar&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;头像&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  KEY &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_uid&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;uid&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  KEY &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_platform_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;platform_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;第三方用户信息&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;用户模型&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight highlight-source-sql"&gt;&lt;pre&gt;&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 用户模型&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;skr_member&lt;/span&gt;` (
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;用户id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;uid&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;账号id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;nickname&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;30&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;昵称&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;avatar&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;头像(相对路径)&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;gender&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; enum(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;male&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;female&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;unknow&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;unknow&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;性别&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;role&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;角色 0:普通用户 1:vip&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  KEY &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_uid&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;uid&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;账户信息&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;员工模型&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight highlight-source-sql"&gt;&lt;pre&gt;&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 员工表&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;staff_info&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;员工id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;uid&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;账号id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;email&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;30&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;员工邮箱&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;phone&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;15&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;员工手机号&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;name&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;30&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;员工姓名&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;nickname&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;30&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;员工昵称&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;avatar&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;员工头像(相对路径)&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;gender&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; enum(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;male&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;female&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;unknow&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;unknow&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;员工性别&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
    KEY &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_uid&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;uid&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
    KEY &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_email&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;email&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
    KEY &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_phone&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;phone&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;员工信息(这里列了大概的信息，多的可以垂直拆表)&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;系统权限管理模型&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight highlight-source-sql"&gt;&lt;pre&gt;&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 权限管理: 系统map&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;auth_ms&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;smallint&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;自增id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;ms_name&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;系统名称&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;ms_desc&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;系描述&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;ms_domain&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;系统域名&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;修改人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 1:enable, 0:disable, -1:deleted&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
    KEY &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_domain&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;ms_domain&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;系统map(登记目前存在的后台系统信息)&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 权限管理: 系统menu&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;auth_ms_menu&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;自增id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;ms_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;smallint&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;系统id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;parent_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;父菜单id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;menu_name&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;菜单名称&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;menu_desc&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;菜描述&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;menu_uri&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;菜单uri&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;is_show&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; enum(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;yes&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;no&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;no&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;是否展示菜单&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;修改人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 1:enable, 0:disable, -1:deleted&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
    KEY &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_ms_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;ms_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
    KEY &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_parent_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;parent_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;系统menu&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 权限管理: 系统权限&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;auth_item&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;自增id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;ms_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;系统id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;menu_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;页面/接口uri&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;修改人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 1:enable, 0:disable, -1:deleted&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
    KEY &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_ms_menu&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;ms_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;menu_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;系统权限&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 权限管理: 系统权限(权限的各个集合)&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;auth_role&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;自增id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;name&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;角色名称&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;desc&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;角描述&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;auth_item_set&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;text&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;权限集合 多个值,号隔开&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;修改人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 1:enable, 0:disable, -1:deleted&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;员工角色&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 权限管理: 角色与员工关系&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;auth_role_staff&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;自增id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;staff_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;员工id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;role_set&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;text&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;角色集合 多个值,号隔开&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;修改人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 1:enable, 0:disable, -1:deleted&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
    KEY &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_staff_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;staff_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;权限角色与员工关系&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;&lt;a id="user-content-交互设计" class="anchor" aria-hidden="true" href="#交互设计"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;交互设计&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;友情提示：一大波图片即将到来，此处图片较多，不清楚的可点击大图查看&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;&lt;a id="user-content-注册" class="anchor" aria-hidden="true" href="#注册"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;注册&lt;/h3&gt;
&lt;p&gt;注册成功之后存在至少两种交互方式：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;注册成功 -&amp;gt; 跳转到登录页面&lt;/li&gt;
&lt;li&gt;注册成功 -&amp;gt; 自动登录 -&amp;gt; 跳转到应用首页(或者其他页面)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;具体交互流程如下：&lt;/p&gt;
&lt;p align="center"&gt;
    &lt;a href="http://cdn.tigerb.cn/skr-account-register-bmpr.png" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/92575fb6952f09ca67814b8ec58015f95a7f0a8b/687474703a2f2f63646e2e7469676572622e636e2f736b722d6163636f756e742d72656769737465722d626d70722e706e67" width="39%" data-canonical-src="http://cdn.tigerb.cn/skr-account-register-bmpr.png" style="max-width:100%;"&gt;
    &lt;/a&gt;
    &lt;a href="http://cdn.tigerb.cn/skr-account-register.jpg" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/16147c3e9824b341e3ba34f081bdff2bb3028d13/687474703a2f2f63646e2e7469676572622e636e2f736b722d6163636f756e742d72656769737465722e6a7067" width="90%" data-canonical-src="http://cdn.tigerb.cn/skr-account-register.jpg" style="max-width:100%;"&gt;
    &lt;/a&gt;
    &lt;a href="http://cdn.tigerb.cn/skr-account-register-result-2.png" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/3fb611a9c87a50bdfb7e3a87d6c22cb909a4844b/687474703a2f2f63646e2e7469676572622e636e2f736b722d6163636f756e742d72656769737465722d726573756c742d322e706e67" width="90%" data-canonical-src="http://cdn.tigerb.cn/skr-account-register-result-2.png" style="max-width:100%;"&gt;
    &lt;/a&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h3&gt;&lt;a id="user-content-登录" class="anchor" aria-hidden="true" href="#登录"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;登录&lt;/h3&gt;
&lt;p align="center"&gt;
    &lt;a href="http://cdn.tigerb.cn/skr-account-login-page.png" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/0334336f1aabf01e658b24fd2f5bff1a3b746173/687474703a2f2f63646e2e7469676572622e636e2f736b722d6163636f756e742d6c6f67696e2d706167652e706e67" width="30%" data-canonical-src="http://cdn.tigerb.cn/skr-account-login-page.png" style="max-width:100%;"&gt;
    &lt;/a&gt;
    &lt;a href="http://cdn.tigerb.cn/skr-account-login-logic.jpg" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/9d30ba9e5f9fcec7c242126c74c4988a7a556655/687474703a2f2f63646e2e7469676572622e636e2f736b722d6163636f756e742d6c6f67696e2d6c6f6769632e6a7067" width="90%" data-canonical-src="http://cdn.tigerb.cn/skr-account-login-logic.jpg" style="max-width:100%;"&gt;
    &lt;/a&gt;
    &lt;a href="http://cdn.tigerb.cn/skr-account-home-page.png" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/37385adb47bb2455710108cf34bbd4134081923f/687474703a2f2f63646e2e7469676572622e636e2f736b722d6163636f756e742d686f6d652d706167652e706e67" width="30%" data-canonical-src="http://cdn.tigerb.cn/skr-account-home-page.png" style="max-width:100%;"&gt;
    &lt;/a&gt;
&lt;/p&gt;
&lt;h5&gt;&lt;a id="user-content-快捷登录" class="anchor" aria-hidden="true" href="#快捷登录"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;快捷登录&lt;/h5&gt;
&lt;p&gt;快捷登录的流程基本和上面一致只是验证密码换成了验证验证码。&lt;/p&gt;
&lt;p align="center"&gt;
    &lt;a href="http://cdn.tigerb.cn/skr-account-simple-login-page.png" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/cdeb488e4cbc80863e13ef98f8d80973172e9e24/687474703a2f2f63646e2e7469676572622e636e2f736b722d6163636f756e742d73696d706c652d6c6f67696e2d706167652e706e67" width="39%" data-canonical-src="http://cdn.tigerb.cn/skr-account-simple-login-page.png" style="max-width:100%;"&gt;
    &lt;/a&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h3&gt;&lt;a id="user-content-第三方登录" class="anchor" aria-hidden="true" href="#第三方登录"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;第三方登录&lt;/h3&gt;
&lt;p&gt;第三方登录的交互其实存在这样的问题：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;第三方账户登录成功后还需要绑定手机号/Email吗？&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;因为我发现有些PM为了提高用户使用的简单快捷性，往往第三方登录成功后会直接产生uid，而不进行账号的绑定。这样之后在再进行账号绑定就涉及账号合并的问题，很麻烦(如果有钱包等)。如果我们一开始就进行绑定操作，这样未来账号的关系就清晰明了便于维护，第三方登录其实就相当于普通账号的别名。
最后这个事情做不做的结果就是，账户表account_user和第三方用户信息表account_platform是的&lt;strong&gt;一对多&lt;/strong&gt;还是&lt;strong&gt;一对一&lt;/strong&gt;的关系。&lt;/p&gt;
&lt;ol start="2"&gt;
&lt;li&gt;如果绑定，已经注册的手机号/Email是否可以绑定？&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这个还好说，一般来说绑定的选择基本是正确的。最后具体的流程图如下：&lt;/p&gt;
&lt;p align="center"&gt;
    &lt;a href="http://cdn.tigerb.cn/skr-account-platform-login.jpg" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/e404f714554704bfdcf7ead462a60a1982229e4a/687474703a2f2f63646e2e7469676572622e636e2f736b722d6163636f756e742d706c6174666f726d2d6c6f67696e2e6a7067" width="100%" data-canonical-src="http://cdn.tigerb.cn/skr-account-platform-login.jpg" style="max-width:100%;"&gt;
    &lt;/a&gt;
&lt;/p&gt;
&lt;p&gt;交互界面图如下：&lt;/p&gt;
&lt;p align="center"&gt;
    &lt;a href="http://cdn.tigerb.cn/skr-account-platform-login-page.png" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/1836ed1552e846c6db3715701548f3efda4e74ac/687474703a2f2f63646e2e7469676572622e636e2f736b722d6163636f756e742d706c6174666f726d2d6c6f67696e2d706167652e706e67" width="39%" data-canonical-src="http://cdn.tigerb.cn/skr-account-platform-login-page.png" style="max-width:100%;"&gt;
    &lt;/a&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h3&gt;&lt;a id="user-content-后台权限管理" class="anchor" aria-hidden="true" href="#后台权限管理"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;后台权限管理&lt;/h3&gt;
&lt;p&gt;首先，我们的后台管理系统需要个响亮的称号，想了一会以前公司用过apollo,于是我准备用mars但突然冒出来个earth，地球万物之根，刚好我们这又是个全业务的基础服务管理系统，哈哈就这样吧～ &lt;strong&gt;Earth System&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Earth System&lt;/strong&gt;的权限管理功能主要分为以下四部分：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;系统管理(The manage system page)
&lt;ul&gt;
&lt;li&gt;编辑页面&lt;/li&gt;
&lt;li&gt;列表页面&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;菜单管理(The menu page)
&lt;ul&gt;
&lt;li&gt;编辑页面&lt;/li&gt;
&lt;li&gt;列表页面&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;角色管理(The role page)
&lt;ul&gt;
&lt;li&gt;编辑页面&lt;/li&gt;
&lt;li&gt;列表页面&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;员工与角色关联管理(The role staff map page)
&lt;ul&gt;
&lt;li&gt;编辑页面&lt;/li&gt;
&lt;li&gt;列表页面&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;具体交互如下：&lt;/p&gt;
&lt;p align="center"&gt;
    &lt;a href="http://cdn.tigerb.cn/skr-earth-2.jpg" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/8302ec03083965919ae59e2ff55b712c3d5281ae/687474703a2f2f63646e2e7469676572622e636e2f736b722d65617274682d322e6a7067" width="100%" data-canonical-src="http://cdn.tigerb.cn/skr-earth-2.jpg" style="max-width:100%;"&gt;
    &lt;/a&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;&lt;a id="user-content-接口设计" class="anchor" aria-hidden="true" href="#接口设计"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;接口设计&lt;/h2&gt;
&lt;h3&gt;&lt;a id="user-content-应用层接口对外" class="anchor" aria-hidden="true" href="#应用层接口对外"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;应用层接口(对外)&lt;/h3&gt;
&lt;p&gt;1.注册接口&lt;/p&gt;
&lt;p&gt;请求参数：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;是否必传&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;username&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;非必传&lt;/td&gt;
&lt;td&gt;用户账号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;email&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;email/phone两者择一&lt;/td&gt;
&lt;td&gt;用户邮箱&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;phone&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;email/phone两者择一&lt;/td&gt;
&lt;td&gt;用户手机号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;code&lt;/td&gt;
&lt;td&gt;int&lt;/td&gt;
&lt;td&gt;必传&lt;/td&gt;
&lt;td&gt;验证码&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;交互方式一(跳转到登录页面)响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;msg&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;OK&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: []
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;交互方式二(跳转到首页页面)响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;msg&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;OK&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;s_token&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户会话标示&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;s_token_expire&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户会话标示过期时间，0不过期&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;username&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户名&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;nickname&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户昵称&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;avatar&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户头像&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;gender&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户性别，male:男，female:女，other:未知&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;2.登录接口&lt;/p&gt;
&lt;p&gt;请求参数：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;是否必传&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;username&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;username/email/phone三者择一&lt;/td&gt;
&lt;td&gt;用户账号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;email&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;username/email/phone三者择一&lt;/td&gt;
&lt;td&gt;用户邮箱&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;phone&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;username/email/phone三者择一&lt;/td&gt;
&lt;td&gt;用户手机号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;password&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;必传&lt;/td&gt;
&lt;td&gt;密码&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;s_token&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户会话标示&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;s_token_expire&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户会话标示过期时间，0不过期&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;nickname&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户昵称&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;username&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户名&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;avatar&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户头像&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;gender&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户性别，male:男，female:女，other:未知&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;3.快捷登录接口&lt;/p&gt;
&lt;p&gt;请求参数：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;是否必传&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;email&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;email/phone两者择一&lt;/td&gt;
&lt;td&gt;用户邮箱&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;phone&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;email/phone两者择一&lt;/td&gt;
&lt;td&gt;用户手机号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;code&lt;/td&gt;
&lt;td&gt;int&lt;/td&gt;
&lt;td&gt;必传&lt;/td&gt;
&lt;td&gt;验证码&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;s_token&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户会话标示&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;s_token_expire&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户会话标示过期时间，0不过期&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;nickname&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户昵称&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;username&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户名&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;avatar&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户头像&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;gender&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户性别，male:男，female:女，other:未知&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;4.第三方登录接口&lt;/p&gt;
&lt;p&gt;请求参数：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;是否必传&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;type&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;必传&lt;/td&gt;
&lt;td&gt;平台类型 1:facebook,2:google,3:wechat,4:qq,5:weibo,6:twitter&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;platform_id&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;必传&lt;/td&gt;
&lt;td&gt;第三方平台用户ID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;platform_token&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;必传&lt;/td&gt;
&lt;td&gt;第三方平台令牌&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;s_token&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户会话标示&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;s_token_expire&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户会话标示过期时间，0不过期&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;username&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户名&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;nickname&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户昵称&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;avatar&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户头像&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;gender&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户性别，male:男，female:女，other:未知&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;5.用户信息修改接口&lt;/p&gt;
&lt;p&gt;请求参数：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;是否必传&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;username&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;非必传&lt;/td&gt;
&lt;td&gt;用户账号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;nickname&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;非必传&lt;/td&gt;
&lt;td&gt;昵称&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;avatar&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;非必传&lt;/td&gt;
&lt;td&gt;头像url&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;gender&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;非必传&lt;/td&gt;
&lt;td&gt;用户性别，male:男，female:女，other:未知&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;username&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户名&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;nickname&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户昵称&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;avatar&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户头像&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;gender&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户性别，male:男，female:女，other:未知&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;6.用户登录状态校验&lt;/p&gt;
&lt;p&gt;请求参数：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;是否必传&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;s_token&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;必传&lt;/td&gt;
&lt;td&gt;用户会话标示&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;s_token_expire&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户会话标示过期时间，0不过期， -1登录失效&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;&lt;a id="user-content-服务接口基础服务对内" class="anchor" aria-hidden="true" href="#服务接口基础服务对内"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;服务接口(基础服务，对内)&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;账户服务：&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;注册&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;请求参数：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;是否必传&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;username&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;非必传&lt;/td&gt;
&lt;td&gt;用户账号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;email&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;email/phone两者择一&lt;/td&gt;
&lt;td&gt;用户邮箱&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;phone&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;email/phone两者择一&lt;/td&gt;
&lt;td&gt;用户手机号&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;交互方式一(跳转到登录页面)响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;msg&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;OK&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;uid&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 账户ID&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;ol start="2"&gt;
&lt;li&gt;登录&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;请求参数：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;是否必传&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;username&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;非必传&lt;/td&gt;
&lt;td&gt;用户账号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;email&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;email/phone两者择一&lt;/td&gt;
&lt;td&gt;用户邮箱&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;phone&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;email/phone两者择一&lt;/td&gt;
&lt;td&gt;用户手机号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;password&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;必传&lt;/td&gt;
&lt;td&gt;密码&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;msg&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;OK&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;uid&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 账户ID&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;ol start="2"&gt;
&lt;li&gt;第三方登录&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;请求参数：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;是否必传&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;type&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;必传&lt;/td&gt;
&lt;td&gt;平台类型 1:facebook,2:google,3:wechat,4:qq,5:weibo,6:twitter&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;platform_id&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;必传&lt;/td&gt;
&lt;td&gt;第三方平台用户ID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;platform_token&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;必传&lt;/td&gt;
&lt;td&gt;第三方平台令牌&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;uid&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 账户ID&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;nickname&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户昵称&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;avatar&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 用户头像&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;权限服务&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;获取系统菜单&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;请求参数：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;是否必传&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ms_id&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;必传&lt;/td&gt;
&lt;td&gt;系统ID&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;msg&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;OK&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;ms_name&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 系统名称&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;ms_desc&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 系描述&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;ms_domain&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 系统域名&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;list&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: [
            {
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;parent_id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 父菜单ID&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;menu_id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 菜单ID&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;menu_name&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 菜单ID&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;menu_desc&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 菜描述&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;menu_uri&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 菜单uri&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;child&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt; : [
                    {
                        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;parent_id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 父菜单ID&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;menu_id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 菜单ID&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;menu_name&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 菜单ID&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;menu_desc&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 菜描述&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;menu_uri&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 菜单uri&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;child&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt; : []
                    }
                ]
            }
        ]
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;ol start="2"&gt;
&lt;li&gt;权限校验&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;请求参数：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;是否必传&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;menu_id&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;必传&lt;/td&gt;
&lt;td&gt;菜单ID&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;msg&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;OK&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: []
}&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;&lt;a id="user-content-购物体系" class="anchor" aria-hidden="true" href="#购物体系"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;购物体系&lt;/h1&gt;
&lt;h2&gt;&lt;a id="user-content-购物车服务" class="anchor" aria-hidden="true" href="#购物车服务"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;购物车服务&lt;/h2&gt;
&lt;p&gt;对于一个电商来讲，购物车是整个购买流程最重要的一步。因为电商发展到今天购物车不仅仅只是为了完成打包下单的功能；也是收藏、对比、促销提醒、相关推荐的重要展示窗口。如此多的能力我们该如何设计保证购物车的高性能、以及良好的扩展能力来满足未来的发展呢？&lt;/p&gt;
&lt;p&gt;今天开始我们就以一个假定的场景来输出一个购物车设计：某某电商平台，是一个多租户模式（我们前面的诸多设计都是多租户模式），用户可以把商品加入到购物车，并切按照商户纬度来展示、排序。当然购物车也支持常规的各种操作：选择、删除、清空、商品失效等。并且有相关的促销能够提醒用户。同时为了监控、运营，要支撑购物车数据同步到监控、数仓等能力。&lt;/p&gt;
&lt;p&gt;本文会从用户使用的角度以及服务端两个角度来讲解系统的能力。本篇我们的主要目的是说清楚购物车的能力以及一些逻辑。下一篇会进行购物车模型设计以及接口定义。&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-用户视角" class="anchor" aria-hidden="true" href="#用户视角"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;用户视角&lt;/h3&gt;
&lt;p&gt;我们先来定义一下在用户侧用户操作购物车的功能有哪些？&lt;/p&gt;
&lt;p&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/071dde2d325f3d620f31d22aa6c4fc020bf0effb/68747470733a2f2f6461797574616c6b2e636e2f696d672f757365722d636172742d632e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/071dde2d325f3d620f31d22aa6c4fc020bf0effb/68747470733a2f2f6461797574616c6b2e636e2f696d672f757365722d636172742d632e706e67" alt="用户则需求" data-canonical-src="https://dayutalk.cn/img/user-cart-c.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;一个购物车基本的能力基本上都在上图中，下面我们一一来分解。&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-操作" class="anchor" aria-hidden="true" href="#操作"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;操作&lt;/h4&gt;
&lt;p&gt;我们从用户的角度来看，购物车对于用户来说可以添加商品到购物车（加购物车、立即购买都属于一种添加方式）；加入进购物车后，不想要了可以删除该商品（删一个、删多个、清空）；想多买可以修改购买数量，发现钱不够可以减少购买数量；或者发现红色的比白色更漂亮，可以在购物车方便的进行更换规格；对于一些价格很贵的商品，能够在购物车添加一些保障服务（其实是绑定的虚拟商品）；在要去结算的时候，还会提供选择能力让用户决定哪些商品真的本次要购买。&lt;/p&gt;
&lt;p&gt;通过上面的描述我们可以看到这个过程是有其内在联系的。这里说一下关于选中功能，业界有两种做法，各有优劣，我们来看一下。淘宝的产品选中状态是保存在客户端的，并且默认不选中，刷新、重新打开APP状态会消失；京东、苏宁这一类是保存在服务端，会记录用户选中状态。针对这两种情况各有优劣。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;客户端：&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;性能，选中/不选中的逻辑直接放在本地做，减少网络请求&lt;/li&gt;
&lt;li&gt;体验，多端不能同步，但是购物车相对来说更像是一个收藏夹，每次用户自己选择也无可厚非&lt;/li&gt;
&lt;li&gt;计算，价格计算时需要上传本地选中商品（也可以本地计算）&lt;/li&gt;
&lt;li&gt;实现，主要靠客户端实现，与服务端无关，研发解耦合&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;服务端：&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;性能，每次操作选中都需要调用服务端，而该操作可能很频繁，除了网络损耗，服务端也需要考虑该如何快速找到修改的商品&lt;/li&gt;
&lt;li&gt;体验，多端同步状态，记录历史状态&lt;/li&gt;
&lt;li&gt;计算，服务端可获取数据，请求时无须上传额外数据&lt;/li&gt;
&lt;li&gt;实现，服务端与客户端需要商定如何交互，以及返回数据（每次选中会导致价格变化），耦合在一起&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;个人认为这两种方式并无谁具备明显优势，完全是一种基于业务模式以及团队情况来做选择。我们这里后续的设计会基于在服务端保存商品选中状态。&lt;/p&gt;
&lt;p&gt;在整个操作逻辑中，有个两个比较重要的地方单独说明一下：购买方式与购物车内修改购买属性&lt;/p&gt;
&lt;h5&gt;&lt;a id="user-content-购买方式" class="anchor" aria-hidden="true" href="#购买方式"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;购买方式&lt;/h5&gt;
&lt;p&gt;主要的购买方式有立即购买、加入购物车、拼团购三种方式。&lt;/p&gt;
&lt;p&gt;首先普通的加入购物车没什么太多要说的。重点来看下立即购买与拼团。&lt;/p&gt;
&lt;p&gt;立即购买在于操作上来说就是选择商品后直接到了订单确认页面，没有购物车中去结算这一步。但是它的实现却可以依赖购物车的逻辑来做，我们来看一下使用购物车与不使用购物车实现这个逻辑有什么差别？&lt;/p&gt;
&lt;p&gt;如果使用购物车来实现，也就是用户点击立即购买时，商品本质上还是加入到购物车中，但这个购物车却与原型的购物车不同，因为该购物车只能加一个商品，并且每次操作都会被覆盖。在视角效果上也是直接从商品详情页面跳转到订单确认页面。来看看这种方式的好处&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;与购物车在订单确认、下单逻辑上一致，内部可以直接通过购物车获取数据&lt;/li&gt;
&lt;li&gt;需要一个独立的专门用于一键购买的购物车来实现，内存有消耗&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;另外一种实现方式使用一个新的数据结构，因为一般来说一键购买更简单，它只需要商品信息、价格信息即可。每次交互均可以根据sku_id来获取。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;订单确认、下单逻辑上需要进行改造，每次请求之间要传递约定参数&lt;/li&gt;
&lt;li&gt;节省内存，上下交互通过sku_id来保证&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;我们会采用使用在服务端一键购买以独立的购物车形式来实现。购物车的数据模型一致，保证了后续处理流程上的一致。&lt;/p&gt;
&lt;p&gt;对于拼团，他其实分为两部分，首先是开团这个动作，当团成立后。我们可以选择将成团的商品加入普通购物车，同时可以加购其它商品。也可以选择将成团商品加入一键购买的购物车，保证成团商品只能买一个。拼团模式更像是加入购物车的一个前置条件。本质上它对于购物车的设计没有影响。&lt;/p&gt;
&lt;h5&gt;&lt;a id="user-content-购物车内修改购买属性" class="anchor" aria-hidden="true" href="#购物车内修改购买属性"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;购物车内修改购买属性&lt;/h5&gt;
&lt;p&gt;这里主要是指可以在购物车便捷的操作一些需要在spu纬度操作的事情，比如：变更规格（也就是更换sku），以及选择绑定到spu纬度的服务（保险、延保等）。&lt;/p&gt;
&lt;p&gt;我们重点说一下选择绑定的服务。例如：我们买一个手机，厂家提供了延保、各种其它附加服务，一般情况这种服务都是虚拟商品。但是这有个特殊情况。这些保障服务首先不能单独购买，其次他是跟主商品的数量息息相关。比如买两个手机，如果选择了加购服务，那么这些服务的数量必须是2，这会是一个联动关系。&lt;/p&gt;
&lt;p&gt;这些保障服务是不能进行单独购买的，它一定要跟特定的商品捆绑销售。&lt;/p&gt;
&lt;p&gt;服务端在存储这部分数据时一定需要考虑如何保存这种层级关系，这部分我们后面模型设计的时候大家会看到。&lt;/p&gt;
&lt;p&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/d73c952e825317d9bb9d7d09ddaf3cc320e6e844/68747470733a2f2f6461797574616c6b2e636e2f696d672f70726f647563742d72656c6174696f6e732e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/d73c952e825317d9bb9d7d09ddaf3cc320e6e844/68747470733a2f2f6461797574616c6b2e636e2f696d672f70726f647563742d72656c6174696f6e732e706e67" alt="绑定商品关系" data-canonical-src="https://dayutalk.cn/img/product-relations.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-提醒" class="anchor" aria-hidden="true" href="#提醒"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;提醒&lt;/h4&gt;
&lt;p&gt;促销提醒很简单，返回的购物车数据，每一个商品应该携带当前的促销信息。这部分重点在于怎么获取促销信息，会在服务端看到。&lt;/p&gt;
&lt;p&gt;然后说下购物车数量的提醒，也就是显示当前购物车商品的数量。一般来说进入到APP就会调用一个接口，获取用户的未读消息数、购物车商品数等。这里是需要非常高的读取速度。那么这种需求该如何满足呢？&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;方案一：&lt;/strong&gt; 我们可以设计一个结构保存了用户相关的这种提醒信息数量，每次直接读取这个数据即可。不需要去跟消息服务、购物车服务打交道拿这些数据。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;方案二：&lt;/strong&gt; 在消息、购物车的模型中均设计一个保存总数量的字段，在读取数据的接口中，通过并发的方式调用这些服务拿到数据后进行聚合，这样在速度上只取决于最慢的服务。&lt;/p&gt;
&lt;p&gt;这里我们的设计会采用 &lt;strong&gt;方案二&lt;/strong&gt;，因为这样在某种程度上效率可以得到保证，同时整个系统的结构数据的一致性更容易得到保障。当然这里有个细节一定要注意，并发读取一定要设计超时，不要因为某个服务读数问题而导致拖累整个接口的性能。&lt;/p&gt;
&lt;p&gt;接下来再来看看促销，这部分除了提醒，还需要提供对应的入口，让用户完成促销的操作。比如说某个商品有券，那么可以直接提供入口去领取；可凑单，有入口进入凑单列表并选择商品等。这部分需要解决的问题是服务端该如何及时从商品纬度拿到这些促销活动。&lt;/p&gt;
&lt;p&gt;从用户的视角看完了，我们再来站在研发的角度看看服务端有哪些事情要做&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-研发视角" class="anchor" aria-hidden="true" href="#研发视角"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;研发视角&lt;/h3&gt;
&lt;p&gt;还是先来看看需求的汇总图：&lt;/p&gt;
&lt;p&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/5fee20ac9583a744951920af67b870bd6e263c0e/68747470733a2f2f6461797574616c6b2e636e2f696d672f757365722d636172742d732e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/5fee20ac9583a744951920af67b870bd6e263c0e/68747470733a2f2f6461797574616c6b2e636e2f696d672f757365722d636172742d732e706e67" alt="服务端则需求" data-canonical-src="https://dayutalk.cn/img/user-cart-s.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-存储" class="anchor" aria-hidden="true" href="#存储"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;存储&lt;/h4&gt;
&lt;p&gt;对于存储，首选肯定是内存存储，至于要不要落库，我觉得没有必要。说下我的理由：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;购物车的数据相对变化非常频繁，落库成本比较高，如果异步方式落库，很难保障一致性&lt;/li&gt;
&lt;li&gt;极端情况，cache奔溃了，仅仅需要用户重新加入购物车，并且我们可以通过cache的持久化机制来保证数据的恢复&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;所以对于购物车，我们只会把数据完全保存在内存中。&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-商品销售类型发生变化" class="anchor" aria-hidden="true" href="#商品销售类型发生变化"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;商品销售类型发生变化&lt;/h4&gt;
&lt;p&gt;现在我们来讨论 &lt;strong&gt;商品销售类型发生变化&lt;/strong&gt; 这个问题。这是什么意思呢？大家想一下：比如我把A商品加入到购物车，但是一直没有结算。这时运营说针对A商品搞一个活动，拿出10个库存5折购。那么问题来了，对于之前购物车中就有该商品的用户该如何处理？&lt;strong&gt;这里解决的主要问题是：购物车有该商品的用户不能直接以5折买&lt;/strong&gt;。几种方案，我们来看一下：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;方案一：&lt;/strong&gt; 促销配置后，所有购物车中有该商品的用户失效或删除，这个方案首先被pass，操作成本太高，并且用户体验差&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;方案二：&lt;/strong&gt; 购物车中要区分同一个SKU，不同销售类型。也就是说在我们的购物车中不是按照SKU的纬度来加商品，而是通过 &lt;strong&gt;SKU+售卖类型&lt;/strong&gt; 来生成一个唯一识别码。&lt;/p&gt;
&lt;p&gt;可以看到 &lt;strong&gt;方案二&lt;/strong&gt; 解决了同一个sku在购物车并存的问题，并且库存之前互相不影响。不过这里又有一个问题？商品的售卖类型（或者说这个标记），该怎么什么地方设置？好像商品系统可以设计、促销系统也可以设置。我们的逻辑中会在促销系统中进行配置。因为商品属于基础逻辑，如果一改就是全局库存受到影响。活动结束后很难做到自动正常售卖。因此这个标记应该落到活动中进行设置（活动设置时会通过促销系统获取该商品之前的活动是否互斥，以确保配置的活动不会互相矛盾）。&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-依赖系统" class="anchor" aria-hidden="true" href="#依赖系统"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;依赖系统&lt;/h4&gt;
&lt;p&gt;购物车系统依赖了非常多的其它系统。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;商品系统&lt;/li&gt;
&lt;li&gt;库存系统&lt;/li&gt;
&lt;li&gt;促销系统&lt;/li&gt;
&lt;li&gt;结算系统&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这些依赖的系统，有的是为了传输数据，有的是为了获取数据。我们按照这两个纬度来看一下。&lt;/p&gt;
&lt;h5&gt;&lt;a id="user-content-促销提醒与计算" class="anchor" aria-hidden="true" href="#促销提醒与计算"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;促销提醒与计算&lt;/h5&gt;
&lt;p&gt;服务端要解决的是促销的提醒与价格计算问题。&lt;/p&gt;
&lt;p&gt;现来说计算，针对这部分最佳的方式是，调用结算中心的价格计算。我们来看一下购物车中的价格计算与订单结算时的价格计算的差异。&lt;/p&gt;
&lt;p&gt;首先购物车中计算价格时不知道用户的地址，这会影响运费的计算；再是不知道用券的情况。那么其实如果解决了这两个问题，我们就可以让价格计算出自同一个逻辑，仅仅是部分入参不同罢了。因此我们这里计算时可以按照最高运费来计算，同时用券默认在购物车都不使用券。对于促销问题这里是可以通过促销系统确认选中的商品可以享受哪些价格的。因此促销的价格应该计算在内。&lt;/p&gt;
&lt;p&gt;接下来在再来说说如何为用户高效的提供促销的信息。先从我们的配置视野出发。&lt;/p&gt;
&lt;p&gt;我们在配置一个促销活动或者发一张券时，都是将多个商品归到一个促销活动或者券的下面。如果按照活动、券的纬度来获取商品效率相对比较高。&lt;/p&gt;
&lt;p&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/2b69d9ecd9bdf347d5c5cdaa2a292f2a2f7cf233/68747470733a2f2f6461797574616c6b2e636e2f696d672f61637469766974792d70726f647563742e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/2b69d9ecd9bdf347d5c5cdaa2a292f2a2f7cf233/68747470733a2f2f6461797574616c6b2e636e2f696d672f61637469766974792d70726f647563742e706e67" alt="活动-商品" data-canonical-src="https://dayutalk.cn/img/activity-product.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;但是在购物车的场景中发生了一个变化。我们是需要从商品纬度获取到该商品的所有活动信息（全平台活动、店铺活动）；
那么购物车中为了展示这些信息该怎么做？很常规的一个做法（也确实不少公司是这样）：把所有活动信息取出来，遍历出所有跟该商品相关的信息。这种做法效率很低，并且无法满足大规模的应用场景，比如双十一期间。&lt;/p&gt;
&lt;p&gt;因此这里为了满足该需求，促销系统需要提供一个能力按照商品获取对应促销（活动、券）。因此一般来讲促销系统配置的活动不能仅仅是按照活动纬度存储，同时还需要生成一份商品纬度的促销信息。&lt;/p&gt;
&lt;p&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/55877d2ea573d7af61e977ca2191100f3130b608/68747470733a2f2f6461797574616c6b2e636e2f696d672f70726f647563742d61637469766974792e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/55877d2ea573d7af61e977ca2191100f3130b608/68747470733a2f2f6461797574616c6b2e636e2f696d672f70726f647563742d61637469766974792e706e67" alt="商品-活动" data-canonical-src="https://dayutalk.cn/img/product-activity.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-购物车数据分析" class="anchor" aria-hidden="true" href="#购物车数据分析"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;购物车数据分析&lt;/h4&gt;
&lt;p&gt;对于购物车数据来说，前端会通过埋点记录加入购物车数据的情况，但是前端埋点一般是记录触发了某个前端操作，但是并不知道该操作是否成功与否。以及无法及时了解当前整体购物车的数据情况。&lt;/p&gt;
&lt;p&gt;为了让运营团队更完整的了解购物车当前情况，我们通过后端打本地日志，然后通过日志收集的方式将日志同步给数据、监控等服务。&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-失效与排序" class="anchor" aria-hidden="true" href="#失效与排序"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;失效与排序&lt;/h4&gt;
&lt;p&gt;还有两个小部分没有讲到，一是商品该如何失效，比如：库存没有了、下架了；二是购物车中的商品是多个店铺的，排序的策略是什么？&lt;/p&gt;
&lt;p&gt;由于本文我们还只是讨论需求，不涉及具体的模型设计，因此只是介绍方案。首先是商品失效，这很像一个软删除操作，一旦设置，用户侧看到的商品将是无法进行结算的，只能进行删除操作。&lt;/p&gt;
&lt;p&gt;对于排序我们会采用的设计是：根据某个店铺在购物车中最后发生操作的时间，最新的操作肯定在最上面。&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-结尾" class="anchor" aria-hidden="true" href="#结尾"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;结尾&lt;/h3&gt;
&lt;p&gt;通过上面我们基本上搞清楚了购物车设计中我们要做什么，依赖的系统要提供什么能力。下篇开始进入数据模型的设计、前后端接口设计。&lt;/p&gt;
&lt;p&gt;如果你对购物车上面的需求还有哪些补充，欢迎留言。我们一起来完善。&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-商品系统temporal万物" class="anchor" aria-hidden="true" href="#商品系统temporal万物"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;商品系统(Temporal万物)&lt;/h2&gt;
&lt;p&gt;今天我们开始「商品系统」的篇章。本文分为如下五大模块：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;需求分析&lt;/li&gt;
&lt;li&gt;架构设计&lt;/li&gt;
&lt;li&gt;Spu和Sku的故事&lt;/li&gt;
&lt;li&gt;数据模型设计&lt;/li&gt;
&lt;li&gt;接口设计&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;第一篇我们主要看看一个入门的电商平台(&lt;strong&gt;B2C&lt;/strong&gt;)如何去构建自己的&lt;strong&gt;基础商品信息&lt;/strong&gt;，其实这个事情很简单，想想我们的现实生活，商家&lt;strong&gt;摆放&lt;/strong&gt;商品到货架，客户从货架&lt;strong&gt;挑选&lt;/strong&gt;商品，客户把挑选好的商品&lt;strong&gt;放入&lt;/strong&gt;购物车(篮)，最后客户去收银台&lt;strong&gt;结账&lt;/strong&gt;。&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-需求分析" class="anchor" aria-hidden="true" href="#需求分析"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;需求分析&lt;/h3&gt;
&lt;p&gt;对于一个电商平台来讲，我们怎么理解上面的简单示例呢？接着，我们来拆分上面这个简单的事情：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;商家&lt;strong&gt;摆放&lt;/strong&gt;商品到货架，客户从货架&lt;strong&gt;挑选&lt;/strong&gt;商品，客户把挑选好的商品&lt;strong&gt;放入&lt;/strong&gt;购物车(篮)，最后客户去收银台&lt;strong&gt;结账&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;商家是谁：电商平台&lt;/li&gt;
&lt;li&gt;摆放是什么意思：上架&lt;/li&gt;
&lt;li&gt;货架在哪：前台系统(web/app/...)&lt;/li&gt;
&lt;li&gt;挑选：浏览前台系统&lt;/li&gt;
&lt;li&gt;放入：点击前台系统「加入购物车按钮」&lt;/li&gt;
&lt;li&gt;...(暂不多说了)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;备注&lt;/strong&gt;：本篇文章主要来看看1、2、3、4步该如何去设计。&lt;/p&gt;
&lt;p&gt;通过上面的分析我们可以得出下面的信息：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;我们需要一个「电商平台」，电商平台里面需要有个&lt;strong&gt;商品后台系统&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;我们上架什么东西呢？商品！所以&lt;strong&gt;商品后台系统&lt;/strong&gt;需要具备&lt;strong&gt;创建&lt;/strong&gt;和&lt;strong&gt;发布&lt;/strong&gt;商品到&lt;strong&gt;前台系统&lt;/strong&gt;的功能。&lt;/li&gt;
&lt;li&gt;我们需要一个&lt;strong&gt;前台系统&lt;/strong&gt;(比如网页)，前台系统具备商品列表和商品详情的页面，可供用户&lt;strong&gt;浏览&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;前台系统的数据怎么来？所以我们需要一个&lt;strong&gt;接口网关&lt;/strong&gt;(对外统一提供服务能力，企业总线)和&lt;strong&gt;商品服务&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;整理之后得到如下的需求点：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;需求点&lt;/th&gt;
&lt;th&gt;功能点&lt;/th&gt;
&lt;th&gt;项目命名&lt;/th&gt;
&lt;th&gt;技术栈&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;商品后台系统&lt;/td&gt;
&lt;td&gt;1.创建商品 2.发布商品到前台系统&lt;/td&gt;
&lt;td&gt;Temporal Backend&lt;/td&gt;
&lt;td&gt;PHP&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;前台系统&lt;/td&gt;
&lt;td&gt;1.商品列表 2.商品详情&lt;/td&gt;
&lt;td&gt;Skr Frontend&lt;/td&gt;
&lt;td&gt;Vue&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;接口网关&lt;/td&gt;
&lt;td&gt;企业总线&lt;/td&gt;
&lt;td&gt;Skr Gateway&lt;/td&gt;
&lt;td&gt;kong&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;商品服务&lt;/td&gt;
&lt;td&gt;1.创建商品接口 2.商品状态变更接口 2.商品列表接口 3. 商品详情接口&lt;/td&gt;
&lt;td&gt;Temporal Service&lt;/td&gt;
&lt;td&gt;Golang&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3&gt;&lt;a id="user-content-架构设计-1" class="anchor" aria-hidden="true" href="#架构设计-1"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;架构设计&lt;/h3&gt;
&lt;p&gt;通过上面的需求分析，再加上之前的《电商设计手册之用户体系》中的用户体系和《支付开发，不得不了解的国内、国际第三方支付流程》中的支付服务，我们规划出以下的架构图。&lt;/p&gt;
&lt;p align="center"&gt;
    &lt;a href="http://cdn.tigerb.cn/skr-product-service.jpg" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/d774e7ef63344e739b4a1b646c6006b33399d42c/687474703a2f2f63646e2e7469676572622e636e2f736b722d70726f647563742d736572766963652e6a7067" data-canonical-src="http://cdn.tigerb.cn/skr-product-service.jpg" style="max-width:100%;"&gt;
    &lt;/a&gt;
&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-spu和sku的故事" class="anchor" aria-hidden="true" href="#spu和sku的故事"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Spu和Sku的故事&lt;/h3&gt;
&lt;p&gt;对我们程序猿来讲「商品系统」刚开始的样子就是如下三点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;创建商品功能：首先我们会有一张商品表，每创建一个商品我们会的到一个goods_id，如果商品存在父子的关系，加一个parent_id的字段就搞定了。&lt;/li&gt;
&lt;li&gt;商品列表接口：商品表分页查询商品。&lt;/li&gt;
&lt;li&gt;商品详情接口：商品表按goods_id索引查询商品信息。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;很简单是吧，基本一张表就搞定了，看起来也是没什么问题的。但是呢，程序设计的巧妙之处就在于&lt;strong&gt;抽象能力&lt;/strong&gt;，电商行业把&lt;code&gt;goods_id&lt;/code&gt;进行了进一步的抽象，产生了Spu和Sku概念，在了解Spu和Sku定义之前，我们还得了解下&lt;strong&gt;销售属性&lt;/strong&gt;的含义，举个例子便于理解：&lt;/p&gt;
&lt;p&gt;想想我们的现实生活，假如我们去批发市场上了一批AJ1球鞋，批发商会给我们不同&lt;strong&gt;配色&lt;/strong&gt;、&lt;strong&gt;大小&lt;/strong&gt;的AJ1球鞋。我们在店里销售这些商品时都会询问客户：“您是需要什么&lt;strong&gt;颜色&lt;/strong&gt;和&lt;strong&gt;大小&lt;/strong&gt;的AJ1球鞋呢？”。这里的&lt;strong&gt;颜色&lt;/strong&gt;和&lt;strong&gt;大小&lt;/strong&gt;就是所谓的&lt;strong&gt;销售属性&lt;/strong&gt;，因为不同&lt;strong&gt;颜色&lt;/strong&gt;和&lt;strong&gt;大小&lt;/strong&gt;的AJ1球鞋可能价格不同、库存数量不同，现实生活中是不是如此，不同颜色或大小的AJ1都有差别巨大的价格。&lt;/p&gt;
&lt;p&gt;接着，我们来看看Spu和Sku定义：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;名称&lt;/th&gt;
&lt;th&gt;概念&lt;/th&gt;
&lt;th&gt;解释&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Spu&lt;/td&gt;
&lt;td&gt;standard product unit 标准产品单位&lt;/td&gt;
&lt;td&gt;goods_id剥离销售属性的部分，例如：小米8。商品列表我们展示Spu列表。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Sku&lt;/td&gt;
&lt;td&gt;stock keeping unit 库存量单位&lt;/td&gt;
&lt;td&gt;就是你想买的那个商品真正的编号，这个编号对应的库存就是你想买的那个商品的库存量。Spu+一或多个销售属性对应一个Sku，例如：小米8黑128G，其中黑和128G就是销售属性，小米8就是一个Spu。&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;搞清楚了么？&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-数据模型设计-1" class="anchor" aria-hidden="true" href="#数据模型设计-1"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;数据模型设计&lt;/h3&gt;
&lt;p&gt;所以最后简单的&lt;strong&gt;商品表&lt;/strong&gt;就拆成了&lt;strong&gt;spu表&lt;/strong&gt;和&lt;strong&gt;sku表&lt;/strong&gt;，接着我们还抽象出来了可复用的&lt;strong&gt;销售属性表&lt;/strong&gt;和&lt;strong&gt;销售属性值表&lt;/strong&gt;。除此之外
我们应该还有&lt;strong&gt;品牌表&lt;/strong&gt;、&lt;strong&gt;类别表&lt;/strong&gt;、简单的&lt;strong&gt;sku库存表&lt;/strong&gt;(目前简单设计此表，后期具体业务重构此表)。接着我们列下这些表的明细：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;表名称&lt;/th&gt;
&lt;th&gt;表名&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;品牌表&lt;/td&gt;
&lt;td&gt;product_brands&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;类别表&lt;/td&gt;
&lt;td&gt;product_category&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;spu表&lt;/td&gt;
&lt;td&gt;product_spu&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;sku表&lt;/td&gt;
&lt;td&gt;product_sku&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;销售属性表&lt;/td&gt;
&lt;td&gt;product_attr&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;销售属性值&lt;/td&gt;
&lt;td&gt;product_attr_value&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;sku库存表&lt;/td&gt;
&lt;td&gt;product_sku_stock&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;除了上面的表之外，我又加了另一张表 &lt;code&gt;关联关系冗余表 product_spu_sku_attr_map&lt;/code&gt;，为什么呢？顾名思义，冗余用的，有了这张表，我们可以很高效的得到：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;spu下 有哪些sku&lt;/li&gt;
&lt;li&gt;spu下 有那些销售属性&lt;/li&gt;
&lt;li&gt;spu下 每个销售属性对应的销售属性值(一对多)&lt;/li&gt;
&lt;li&gt;spu下 每个销售属性值对应的sku(一对多)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;具体表结构如下所示：&lt;/p&gt;
&lt;div class="highlight highlight-source-sql"&gt;&lt;pre&gt;&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 品牌表 product_brands&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;product_brands&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;品牌ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;name&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;品牌名称&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;desc&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;品牌描述&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;logo_url&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;品牌logo图片&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;修改人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 1:enable, 0:disable, -1:deleted&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;品牌表&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 类别表 product_category&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;product_category&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;分类ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pid&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;父ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;name&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;分类名称&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;desc&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;分类描述&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pic_url&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;分类图片&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;path&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;分类地址{pid}-{child_id}-...&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;修改人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 1:enable, 0:disable, -1:deleted&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;类别表&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; spu表 product_spu&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; spu: standard product unit 标准产品单位&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;product_spu&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;SPU ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;brand_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;品牌ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;category_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;分类ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;name&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;spu名称&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;desc&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;spu描述&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;selling_point&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;卖点&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;unit&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;spu单位&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;banner_url&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;text&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;banner图片 多个图片逗号分隔&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;main_url&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;text&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;商品介绍主图 多个图片逗号分隔&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;price_fee&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt; unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;售价，整数方式保存&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;price_scale&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; tinyint unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;售价，金额对应的小数位数&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;market_price_fee&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt; unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;市场价，整数方式保存&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;market_price_scale&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; tinyint unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;市场价，金额对应的小数位数&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;修改人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 1:enable, 0:disable, -1:deleted&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT AUTO_INCREMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-c1"&gt;666666&lt;/span&gt; CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;spu表&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; sku表 product_sku&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; sku: stock keeping unit 库存量单位&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;product_sku&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;SKU ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;spu_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;SPU ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;attrs&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;text&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;销售属性值{attr_value_id}-{attr_value_id} 多个销售属性值逗号分隔&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;banner_url&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;text&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;banner图片 多个图片逗号分隔&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;main_url&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;text&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;商品介绍主图 多个图片逗号分隔&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;price_fee&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt; unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;售价，整数方式保存&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;price_scale&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; tinyint unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;售价，金额对应的小数位数&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;market_price_fee&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt; unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;市场价，整数方式保存&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;market_price_scale&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; tinyint unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;市场价，金额对应的小数位数&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;修改人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 1:enable, 0:disable, -1:deleted&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT AUTO_INCREMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-c1"&gt;666666&lt;/span&gt; CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;sku表&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 销售属性表 product_attr&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;product_attr&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;销售属性ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;name&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;销售属性名称&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;desc&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;销售属性描述&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;修改人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 1:enable, 0:disable, -1:deleted&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;销售属性表&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 销售属性值 product_attr_value&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;product_attr_value&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;销售属性值ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;attr_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;销售属性ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;value&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;销售属性值&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;desc&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;销售属性值描述&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;修改人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 1:enable, 0:disable, -1:deleted&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;销售属性值&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 关联关系冗余表 product_spu_sku_attr_map&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 1. spu下 有哪些sku&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 2. spu下 有那些销售属性&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 3. spu下 每个销售属性对应的销售属性值(一对多)&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 4. spu下 每个销售属性值对应的sku(一对多)&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;product_spu_sku_attr_map&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;自增ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;spu_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;SPU ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;sku_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;SKU ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;attr_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;销售属性ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;attr_name&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;销售属性名称&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;attr_value_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;销售属性值ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;attr_value_name&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;销售属性值&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 1:enable, 0:disable, -1:deleted&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;关联关系冗余表&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; sku库存表 product_sku_stock&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;product_sku_stock&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;自增ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;sku_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;SKU ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;quantity&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;库存&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;修改人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 1:enable, 0:disable, -1:deleted&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;sku库存表&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;&lt;a id="user-content-接口设计-1" class="anchor" aria-hidden="true" href="#接口设计-1"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;接口设计&lt;/h3&gt;
&lt;p&gt;关于接口设计目前很简单，无非列表和详情。但是这里我做了一个很好的设计&lt;strong&gt;动静分离&lt;/strong&gt;，例如库存的动态的数据，单独提供接口，其他列表和详情数据完全静态化，把流量打到CDN去，这里又会说到我们下步计划的基础服务体系里的「静态资源服务」，这个服务的主要功能就是把我们的接口数据静态化。具体的&lt;strong&gt;V1.0&lt;/strong&gt;版的接口设计如下：&lt;/p&gt;
&lt;p&gt;1、spu详情 GET {version}/product/spu/{spu_id}&lt;/p&gt;
&lt;p&gt;请求参数：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;是否必传&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;spu_id&lt;/td&gt;
&lt;td&gt;number&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;spu ID&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;msg&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;OK&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;brand_info&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, 品牌ID&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;name&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 品牌名称&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;desc&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 品牌描述&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;logo_url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 品牌logo图片&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        },
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;category_info&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, 分类ID&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;name&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 品牌名称&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;desc&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 品牌描述&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;pic_url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 分类图片&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;path&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 分类地址{pid}-{child_id}-...&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        },
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;spu_info&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, spu id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;name&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, spu名称&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;desc&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, spu描述&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;selling_point&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 卖点&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;unit&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, spu单位&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;banner_url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: [
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, banner 图片url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, banner 图片url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            ],
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;main_url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: [
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 商品介绍主图 图片url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 商品介绍主图 图片url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            ],
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;price&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 售价&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;market_price&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 市场价&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;attrs&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: [ &lt;span class="pl-ii"&gt;//&lt;/span&gt; &lt;span class="pl-ii"&gt;有那些销售属性&lt;/span&gt;
                {
                    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;销售属性ID&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;name&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 销售属性名称&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;desc&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 销售属性描述&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;values&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: [ &lt;span class="pl-ii"&gt;//&lt;/span&gt; &lt;span class="pl-ii"&gt;每个销售属性对应的销售属性值(一对多)&lt;/span&gt;
                        {
                            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;销售属性值ID&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;name&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 销售属性值&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;desc&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 销售属性值描述&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                            &lt;span class="pl-ii"&gt;//&lt;/span&gt; &lt;span class="pl-ii"&gt;每个销售属性值对应的sku(一对多)&lt;/span&gt;
                            &lt;span class="pl-ii"&gt;//&lt;/span&gt; &lt;span class="pl-ii"&gt;页面初始化时，按钮不可点击逻辑判断：&lt;/span&gt; &lt;span class="pl-ii"&gt;如果该销售属性值下所有sku没有库存，则该销售属性按钮不可点击&lt;/span&gt;
                            &lt;span class="pl-ii"&gt;//&lt;/span&gt; &lt;span class="pl-ii"&gt;选择销售属性值时，按钮不可点击逻辑判断：销售属性构成双向链表，每个销售属性又是一个单向链表存改销售属性对应的所有销售属性值。每当选择一个销售属性值时先前和后一个销售属性遍历，执销售属性值下所有sku售罄的按钮不可点击，且当前销售属性值map记录key为当前点击的销售属性值ID，值统一标示一下就行，目的记录是由于选择了哪个销售属性值使得当前的销售属性值为售罄状态&lt;/span&gt;
                            &lt;span class="pl-ii"&gt;//&lt;/span&gt; &lt;span class="pl-ii"&gt;取消选择销售属性值时，按钮不可点击逻辑恢复判断：数据结构同上，遍历，记录的map删除key为当前取消选中的销售属性值，并判断是否还有别的key使得该销售属性值为售罄状态，如果没有则恢复未售罄状态&lt;/span&gt;
                            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;skus&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: [
                                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, sku id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, sku id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                            ],
                        }
                    ],
                }
            ],
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;skus&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: [ &lt;span class="pl-ii"&gt;//&lt;/span&gt; &lt;span class="pl-ii"&gt;有哪些sku&lt;/span&gt;
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, sku id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, sku id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            ],
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;skus_map&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;{attr_value_id}-{attr_value_id}-...&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, sku id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;{attr_value_id}-{attr_value_id}-...&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, sku id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;{attr_value_id}-{attr_value_id}-...&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, sku id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;{attr_value_id}-{attr_value_id}-...&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, sku id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;{attr_value_id}-{attr_value_id}-...&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, sku id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;{attr_value_id}-{attr_value_id}-...&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, sku id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            }
        }
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;2、获取spu下所有skus库存 GET {version}/stock/spu/{spu_id}&lt;/p&gt;
&lt;p&gt;请求参数：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;是否必传&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;spu_id&lt;/td&gt;
&lt;td&gt;number&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;spu ID&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;msg&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;OK&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;skus_stock&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;int, sku id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
                    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;quantity&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;int, 剩余库存数量&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;
                }
            }
        }
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;3、sku详情 GET {version}/product/sku/{sku_id}&lt;/p&gt;
&lt;p&gt;请求参数：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;是否必传&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;sku&lt;/td&gt;
&lt;td&gt;number&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;sku ID&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;msg&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;OK&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, sku id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;name&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, sku名称&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;desc&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, sku描述&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;unit&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, sku单位&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;banner_url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: [
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, banner 图片url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, banner 图片url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        ],
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;main_url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: [
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 商品介绍主图 图片url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 商品介绍主图 图片url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        ],
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;price&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 售价&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;market_price&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 市场价&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;4、spu列表 GET {version}/product/spu/list&lt;/p&gt;
&lt;p&gt;请求参数：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;是否必传&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;msg&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;OK&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;list&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: [
            {
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, spu id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;name&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, spu名称&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;desc&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, spu描述&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;unit&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, spu单位&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;banner_url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: [
                    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, banner 图片url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, banner 图片url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                ],
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;price&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 售价&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;market_price&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 市场价&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            }
        ]
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;&lt;a id="user-content-营销体系" class="anchor" aria-hidden="true" href="#营销体系"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;营销体系&lt;/h1&gt;
&lt;p&gt;营销体系在一个电商系统中承担着尖刀般的作用，为电商团队拼下无数订单，就如同现实生活中的一线销售人员，引流、促销、提高成单率和客单价。&lt;/p&gt;
&lt;p&gt;一个营销体系拥有各种提升GMV的手段，并且仍然在不断的推陈出新，着实令人敬佩。&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-营销体系拆分" class="anchor" aria-hidden="true" href="#营销体系拆分"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;营销体系拆分&lt;/h2&gt;
&lt;p&gt;按照不同的维度，我们把营销体系划分为两大系统：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;系统&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;th&gt;维度&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;活动营销系统&lt;/td&gt;
&lt;td&gt;拥有各种手段&lt;strong&gt;提升PV\UV&lt;/strong&gt;，并引导消费&lt;/td&gt;
&lt;td&gt;PV、UV维度&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;销售营销系统&lt;/td&gt;
&lt;td&gt;拥有各种&lt;strong&gt;降低或变相降低价格&lt;/strong&gt;的手段，来促进消费&lt;/td&gt;
&lt;td&gt;价格维度&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;活动营销系统：
&lt;ul&gt;
&lt;li&gt;抽奖
&lt;ul&gt;
&lt;li&gt;按时间抽奖&lt;/li&gt;
&lt;li&gt;按当前活动参与次数抽奖&lt;/li&gt;
&lt;li&gt;按数额区间抽奖&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;活动模板&lt;/li&gt;
&lt;li&gt;抢购？？？&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;销售营销系统：
&lt;ul&gt;
&lt;li&gt;满减&lt;/li&gt;
&lt;li&gt;满赠&lt;/li&gt;
&lt;li&gt;买送&lt;/li&gt;
&lt;li&gt;限时购(限时降价或限时折扣)&lt;/li&gt;
&lt;li&gt;秒杀&lt;/li&gt;
&lt;li&gt;加价购&lt;/li&gt;
&lt;li&gt;多买&lt;/li&gt;
&lt;li&gt;预售
&lt;ul&gt;
&lt;li&gt;全款预售&lt;/li&gt;
&lt;li&gt;定金(订金)膨胀预售&lt;/li&gt;
&lt;li&gt;盲售&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;拼团&lt;/li&gt;
&lt;li&gt;砍价&lt;/li&gt;
&lt;li&gt;众筹&lt;/li&gt;
&lt;li&gt;组合套装&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;营销体系的基础服务支撑:
&lt;ul&gt;
&lt;li&gt;优惠券服务
&lt;ul&gt;
&lt;li&gt;满减券&lt;/li&gt;
&lt;li&gt;折扣券&lt;/li&gt;
&lt;li&gt;现金券&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;积分服务&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;&lt;a id="user-content-概念定义" class="anchor" aria-hidden="true" href="#概念定义"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;概念定义&lt;/h2&gt;
&lt;p&gt;营销体系中我们需要把以下概念定义清楚，要使用哪些名词，以及明确其定义，防止沟通过程中的效率低下或理解偏差：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;概念&lt;/th&gt;
&lt;th&gt;定义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;抢购&lt;/td&gt;
&lt;td&gt;爆品/新品发售场景&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;---&lt;/td&gt;
&lt;td&gt;---&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;满减&lt;/td&gt;
&lt;td&gt;单笔订单满多少减多少，例如，“满500减20”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;满赠&lt;/td&gt;
&lt;td&gt;单笔订单满多少增送其他商品，例如，“满999送秋裤”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;买送&lt;/td&gt;
&lt;td&gt;买就送，例如，“全场下单送秋裤”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;限时购&lt;/td&gt;
&lt;td&gt;限定时间区间，降价或折扣&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;秒杀&lt;/td&gt;
&lt;td&gt;白送价格，数量极少的销售场景，例如，“一元秒杀”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;加价购&lt;/td&gt;
&lt;td&gt;再加多少钱，可以低价购买其他推荐商品&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;多买&lt;/td&gt;
&lt;td&gt;单笔订单购买多个sku，享受折扣&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;全款预售&lt;/td&gt;
&lt;td&gt;预售库存一次付清&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;订金膨胀预售&lt;/td&gt;
&lt;td&gt;包含订金阶段、尾款阶段，订金翻倍抵现尾款，订金可退&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;定金膨胀预售&lt;/td&gt;
&lt;td&gt;包含定金阶段、尾款阶段，定金翻倍抵现尾款，定金不退&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;盲售&lt;/td&gt;
&lt;td&gt;包含订金(定金)阶段，尾款阶段；不知道尾款价格，不知道sku的具体信息，只知道spu的信息（可选）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;拼团&lt;/td&gt;
&lt;td&gt;限定时间凑够多人成功支付订单(享优惠价格)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;砍价(点赞降价)&lt;/td&gt;
&lt;td&gt;限定时间邀请好友砍价到指定金额&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;众筹&lt;/td&gt;
&lt;td&gt;限定时间购买人数达到指定人数及以上即可成功享受优惠价格&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;组合套装&lt;/td&gt;
&lt;td&gt;多个sku捆绑销售&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;---&lt;/td&gt;
&lt;td&gt;---&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;满减券&lt;/td&gt;
&lt;td&gt;单笔订单满多少才能使用的优惠券&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;折扣券&lt;/td&gt;
&lt;td&gt;单笔订单折扣&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;现金券&lt;/td&gt;
&lt;td&gt;单笔订单抵现金&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1&gt;&lt;a id="user-content-通用抽奖工具glue万能胶" class="anchor" aria-hidden="true" href="#通用抽奖工具glue万能胶"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;通用抽奖工具(Glue万能胶)&lt;/h1&gt;
&lt;h2&gt;&lt;a id="user-content-抽奖需求分析" class="anchor" aria-hidden="true" href="#抽奖需求分析"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;抽奖需求分析&lt;/h2&gt;
&lt;p&gt;首先我们先来回顾下&lt;strong&gt;营销体系&lt;/strong&gt;的组成：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;营销体系&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;活动营销系统&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;销售营销系统&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;今天带来的是&lt;strong&gt;活动营销系统&lt;/strong&gt;下的第一个独立子系统&lt;strong&gt;通用抽奖工具&lt;/strong&gt;的介绍，本篇文章主要分为如下4部分：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;常见抽奖场景与归类&lt;/li&gt;
&lt;li&gt;抽奖需求配置&lt;/li&gt;
&lt;li&gt;常见奖品类型&lt;/li&gt;
&lt;li&gt;抽奖五要素&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;&lt;a id="user-content-常见抽奖场景与归类" class="anchor" aria-hidden="true" href="#常见抽奖场景与归类"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;常见抽奖场景与归类&lt;/h2&gt;
&lt;p&gt;下面是我列出来的一些常见的抽奖场景，红包雨、糖果雨、打地鼠、大转盘(九宫格)、考眼力、答题闯关、游戏闯关、支付刮刮乐、积分刮刮乐等等活动营销场景。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;活动名称&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;红包雨&lt;/td&gt;
&lt;td&gt;每日整点抢红包🧧抽奖，每个整点一般可参与一次&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;糖果雨&lt;/td&gt;
&lt;td&gt;每日整点抢糖果&lt;g-emoji class="g-emoji" alias="candy" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f36c.png"&gt;🍬&lt;/g-emoji&gt;抽奖，每个整点一般可参与一次&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;打地鼠&lt;/td&gt;
&lt;td&gt;每日整点打地鼠抽奖，每个整点一般可参与一次&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;大转盘(九宫格)&lt;/td&gt;
&lt;td&gt;某个时间段，转盘抽奖，每个场一般可参N次&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;考眼力&lt;/td&gt;
&lt;td&gt;某个时间段，旋转杯子猜小球在哪个被子里，猜对可抽奖，一般每日可参与N次&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;答题闯关&lt;/td&gt;
&lt;td&gt;每过一关，可参与抽奖，越到后面奖品越贵重&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;游戏闯关&lt;/td&gt;
&lt;td&gt;每过一关，可参与抽奖，越到后面奖品越贵重&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;支付刮刮乐&lt;/td&gt;
&lt;td&gt;支付订单后可刮奖，支付金额越大奖品越贵重&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;积分刮刮乐&lt;/td&gt;
&lt;td&gt;积分刮奖，消费积分额度越大奖品越贵重&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;通过上面的活动描述，我们把整个抽奖场景归为以下三类：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;活动名称&lt;/th&gt;
&lt;th&gt;维度&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;按时间抽奖&lt;/td&gt;
&lt;td&gt;红包雨、糖果雨、打地鼠、幸运大转盘(九宫格)、考眼力&lt;/td&gt;
&lt;td&gt;时间维度&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;按抽奖次数抽奖&lt;/td&gt;
&lt;td&gt;答题闯关、游戏闯关&lt;/td&gt;
&lt;td&gt;参与该活动次数维度&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;按数额范围区间抽奖&lt;/td&gt;
&lt;td&gt;支付刮刮乐、积分刮刮乐&lt;/td&gt;
&lt;td&gt;数额区间维度&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;接着我们来看下每类抽奖活动具体的抽奖需求配置。&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-抽奖需求配置" class="anchor" aria-hidden="true" href="#抽奖需求配置"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;抽奖需求配置&lt;/h2&gt;
&lt;p&gt;本小节每类抽奖活动的需求配置，分为如下三个部分：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;活动配置&lt;/li&gt;
&lt;li&gt;场次配置&lt;/li&gt;
&lt;li&gt;奖品配置&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;&lt;a id="user-content-首先第一类-按时间抽奖的需求配置" class="anchor" aria-hidden="true" href="#首先第一类-按时间抽奖的需求配置"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;首先，第一类: &lt;code&gt;按时间抽奖&lt;/code&gt;的需求配置&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;活动名称&lt;/th&gt;
&lt;th&gt;特点&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;按时间抽奖&lt;/td&gt;
&lt;td&gt;红包雨、糖果雨、打地鼠、幸运大转盘(九宫格)、考眼力&lt;/td&gt;
&lt;td&gt;时间维度&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;按时间抽奖&lt;/th&gt;
&lt;th&gt;是否多场次&lt;/th&gt;
&lt;th&gt;单场次次数限制(次)&lt;/th&gt;
&lt;th&gt;总场次次数限制(次)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;红包雨&lt;/td&gt;
&lt;td&gt;是&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;糖果雨&lt;/td&gt;
&lt;td&gt;是&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;打地鼠&lt;/td&gt;
&lt;td&gt;是&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;幸运大转盘(九宫格)&lt;/td&gt;
&lt;td&gt;否&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;考眼力&lt;/td&gt;
&lt;td&gt;否&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;通过上面的分析我们得到了&lt;strong&gt;活动&lt;/strong&gt;和&lt;strong&gt;场次&lt;/strong&gt;的概念: 一个活动需要支持多场次的配置。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;活动activity:配置活动的日期范围&lt;/li&gt;
&lt;li&gt;场次session:配置每场的具体时间范围&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;红包雨的需求配置示例：&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;活动特征：红包雨需要支持多场次。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;比如双十二期间三天、每天三场整点红包雨配置如下：&lt;/p&gt;
&lt;p&gt;活动、场次配置：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;双十二红包雨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;活动配置：&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2019-12-10 至 2019-12-12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;场次配置：&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10:00:00 至 10:01:00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12:00:00 至 12:01:00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;18:00:00 至 18:01:00&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;奖品配置：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;场次&lt;/th&gt;
&lt;th&gt;奖品1&lt;/th&gt;
&lt;th&gt;奖品2&lt;/th&gt;
&lt;th&gt;---&lt;/th&gt;
&lt;th&gt;奖品N&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;场次10:00:00 至 10:01:00&lt;/td&gt;
&lt;td&gt;优惠券2元&lt;/td&gt;
&lt;td&gt;空奖&lt;/td&gt;
&lt;td&gt;---&lt;/td&gt;
&lt;td&gt;无&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;场次12:00:00 至 12:01:00&lt;/td&gt;
&lt;td&gt;优惠券5元&lt;/td&gt;
&lt;td&gt;空奖&lt;/td&gt;
&lt;td&gt;---&lt;/td&gt;
&lt;td&gt;无&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;场次18:00:00 至 18:01:00&lt;/td&gt;
&lt;td&gt;优惠券10元&lt;/td&gt;
&lt;td&gt;优惠券20元&lt;/td&gt;
&lt;td&gt;---&lt;/td&gt;
&lt;td&gt;空奖&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class="highlight highlight-source-lisp"&gt;&lt;pre&gt;上面配置的结果如下：

&lt;span class="pl-c1"&gt;2019&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt;-&lt;span class="pl-c1"&gt;10&lt;/span&gt;日三场整点红包雨：
&lt;span class="pl-c1"&gt;2019&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt;-&lt;span class="pl-c1"&gt;10&lt;/span&gt; &lt;span class="pl-c1"&gt;10&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt; ~ &lt;span class="pl-c1"&gt;10&lt;/span&gt;:&lt;span class="pl-c1"&gt;01&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;
&lt;span class="pl-c1"&gt;2019&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt;-&lt;span class="pl-c1"&gt;10&lt;/span&gt; &lt;span class="pl-c1"&gt;12&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt; ~ &lt;span class="pl-c1"&gt;12&lt;/span&gt;:&lt;span class="pl-c1"&gt;01&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;
&lt;span class="pl-c1"&gt;2019&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt;-&lt;span class="pl-c1"&gt;10&lt;/span&gt; &lt;span class="pl-c1"&gt;18&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt; ~ &lt;span class="pl-c1"&gt;18&lt;/span&gt;:&lt;span class="pl-c1"&gt;01&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;

&lt;span class="pl-c1"&gt;2019&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt;-&lt;span class="pl-c1"&gt;11&lt;/span&gt;日三场整点红包雨：
&lt;span class="pl-c1"&gt;2019&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt;-&lt;span class="pl-c1"&gt;11&lt;/span&gt; &lt;span class="pl-c1"&gt;10&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt; ~ &lt;span class="pl-c1"&gt;10&lt;/span&gt;:&lt;span class="pl-c1"&gt;01&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;
&lt;span class="pl-c1"&gt;2019&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt;-&lt;span class="pl-c1"&gt;11&lt;/span&gt; &lt;span class="pl-c1"&gt;12&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt; ~ &lt;span class="pl-c1"&gt;12&lt;/span&gt;:&lt;span class="pl-c1"&gt;01&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;
&lt;span class="pl-c1"&gt;2019&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt;-&lt;span class="pl-c1"&gt;11&lt;/span&gt; &lt;span class="pl-c1"&gt;18&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt; ~ &lt;span class="pl-c1"&gt;18&lt;/span&gt;:&lt;span class="pl-c1"&gt;01&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;

&lt;span class="pl-c1"&gt;2019&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt;日三场整点红包雨：
&lt;span class="pl-c1"&gt;2019&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt; &lt;span class="pl-c1"&gt;10&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt; ~ &lt;span class="pl-c1"&gt;10&lt;/span&gt;:&lt;span class="pl-c1"&gt;01&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;
&lt;span class="pl-c1"&gt;2019&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt; &lt;span class="pl-c1"&gt;12&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt; ~ &lt;span class="pl-c1"&gt;12&lt;/span&gt;:&lt;span class="pl-c1"&gt;01&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;
&lt;span class="pl-c1"&gt;2019&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt; &lt;span class="pl-c1"&gt;18&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt; ~ &lt;span class="pl-c1"&gt;18&lt;/span&gt;:&lt;span class="pl-c1"&gt;01&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;幸运大转盘的需求配置示例：&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;活动特征：幸运大转盘不需要多场次。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;比如年货节2020-01-20 至 2020-02-10期间幸运大转盘配置如下：&lt;/p&gt;
&lt;p&gt;活动、场次配置：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;双十二幸运大转盘&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;活动配置：&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2019-12-10 至 2019-12-12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;场次配置：&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;00:00:00 至 23:59:59&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;奖品配置：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;场次&lt;/th&gt;
&lt;th&gt;奖品1&lt;/th&gt;
&lt;th&gt;奖品2&lt;/th&gt;
&lt;th&gt;---&lt;/th&gt;
&lt;th&gt;奖品N&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;场次00:00:00 至 23:59:59&lt;/td&gt;
&lt;td&gt;优惠券2元&lt;/td&gt;
&lt;td&gt;空奖&lt;/td&gt;
&lt;td&gt;---&lt;/td&gt;
&lt;td&gt;无&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class="highlight highlight-source-lisp"&gt;&lt;pre&gt;上面配置的结果如下：

幸运大转盘抽奖活动将于 &lt;span class="pl-c1"&gt;2019&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt;-&lt;span class="pl-c1"&gt;10&lt;/span&gt; &lt;span class="pl-c1"&gt;00&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt;:&lt;span class="pl-c1"&gt;00&lt;/span&gt; ~ &lt;span class="pl-c1"&gt;2019&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt;-&lt;span class="pl-c1"&gt;12&lt;/span&gt; &lt;span class="pl-c1"&gt;23&lt;/span&gt;:&lt;span class="pl-c1"&gt;59&lt;/span&gt;:&lt;span class="pl-c1"&gt;59&lt;/span&gt; 进行&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;注意与思考：双十二幸运大转盘不需要多个场次，只配置一个场次即可，完全复用活动场次模型。&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-接着第二类-按抽奖次数抽奖的需求配置" class="anchor" aria-hidden="true" href="#接着第二类-按抽奖次数抽奖的需求配置"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;接着，第二类: &lt;code&gt;按抽奖次数抽奖&lt;/code&gt;的需求配置&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;活动名称&lt;/th&gt;
&lt;th&gt;特点&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;按抽奖次数抽奖&lt;/td&gt;
&lt;td&gt;答题闯关、游戏闯关&lt;/td&gt;
&lt;td&gt;(成功参与)当前活动次数维度&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;答题闯关的需求配置示例：&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;活动特征：每一关的奖品不同，一般越到后面中大奖的几率越大。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;活动、场次配置：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;双十二答题闯关&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;活动配置：&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2019-12-10 至 2019-12-12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;场次配置：&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;00:00:00 至 23:59:59&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;奖品配置：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;双十二答题闯关&lt;/th&gt;
&lt;th&gt;奖品&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;第一关&lt;/td&gt;
&lt;td&gt;优惠券2元&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;第二关&lt;/td&gt;
&lt;td&gt;优惠券5元&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;第三关&lt;/td&gt;
&lt;td&gt;优惠券10元&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;第四关&lt;/td&gt;
&lt;td&gt;优惠券20元&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;第五关&lt;/td&gt;
&lt;td&gt;优惠券50元&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;第六关&lt;/td&gt;
&lt;td&gt;优惠券100元&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;注意与思考：同理活动&amp;amp;场次配置完全复用，同幸运大转盘配置(不需要支持多场次)。&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-最后第三类-按数额范围区间抽奖的需求配置" class="anchor" aria-hidden="true" href="#最后第三类-按数额范围区间抽奖的需求配置"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;最后，第三类: &lt;code&gt;按数额范围区间抽奖&lt;/code&gt;的需求配置：&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;活动名称&lt;/th&gt;
&lt;th&gt;特点&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;按数额范围区间抽奖&lt;/td&gt;
&lt;td&gt;支付刮刮乐、积分刮刮乐&lt;/td&gt;
&lt;td&gt;数额区间维度&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;支付刮刮乐的需求配置示例：&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;活动特征：不同的订单金额，一般金额越大中大奖的几率越大。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;活动、场次配置:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;双十二答题闯关&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;活动配置：&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2019-12-10 至 2019-12-12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;场次配置：&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;00:00:00 至 23:59:59&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;奖品配置：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;订单金额&lt;/th&gt;
&lt;th&gt;奖品1&lt;/th&gt;
&lt;th&gt;奖品2&lt;/th&gt;
&lt;th&gt;---&lt;/th&gt;
&lt;th&gt;奖品N&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;0~100&lt;/td&gt;
&lt;td&gt;优惠券2元&lt;/td&gt;
&lt;td&gt;空奖&lt;/td&gt;
&lt;td&gt;---&lt;/td&gt;
&lt;td&gt;无&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;100~200&lt;/td&gt;
&lt;td&gt;优惠券5元&lt;/td&gt;
&lt;td&gt;空奖&lt;/td&gt;
&lt;td&gt;---&lt;/td&gt;
&lt;td&gt;无&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;200~1000&lt;/td&gt;
&lt;td&gt;优惠券10元&lt;/td&gt;
&lt;td&gt;优惠券20元&lt;/td&gt;
&lt;td&gt;---&lt;/td&gt;
&lt;td&gt;空奖&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1000以上&lt;/td&gt;
&lt;td&gt;优惠券50元&lt;/td&gt;
&lt;td&gt;笔记本电脑&lt;/td&gt;
&lt;td&gt;---&lt;/td&gt;
&lt;td&gt;空奖&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;注意与思考：同理活动&amp;amp;场次配置完全复用，同幸运大转盘配置(不需要支持多场次)。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;总结: 通过上面的分析我们得到了抽奖工具的两个要素&lt;strong&gt;活动&lt;/strong&gt;和&lt;strong&gt;场次&lt;/strong&gt;。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;&lt;a id="user-content-常见奖品类型" class="anchor" aria-hidden="true" href="#常见奖品类型"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;常见奖品类型&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;抽奖抽什么？&lt;/p&gt;
&lt;/blockquote&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;常见奖品类型&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;优惠券&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;积分&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;实物&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;空奖&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;总结: 我们得到了抽奖工具的另一个要素&lt;strong&gt;奖品&lt;/strong&gt;。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;&lt;a id="user-content-抽奖五要素" class="anchor" aria-hidden="true" href="#抽奖五要素"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;抽奖五要素&lt;/h2&gt;
&lt;p&gt;通过上面的分析我们已经得到了抽奖的&lt;strong&gt;三要素&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;活动&lt;/li&gt;
&lt;li&gt;场次&lt;/li&gt;
&lt;li&gt;奖品&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;那还有什么要素我们还没聊到呢？接下来来看。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4&gt;&lt;a id="user-content-第四要素中奖概率" class="anchor" aria-hidden="true" href="#第四要素中奖概率"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;第四要素：中奖概率&lt;/h4&gt;
&lt;p&gt;抽奖自然离不开奖品的中奖概率的设置。关于中奖概率我们支持如下灵活的配置：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;手动设置奖品中奖概率&lt;/li&gt;
&lt;li&gt;自动概率，根据当前奖品的数量、奖品的权重得到中奖概率&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;比如我们某次大促活动红包雨的配置如下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;活动配置&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;活动时间&lt;/td&gt;
&lt;td&gt;2019-12-10至2019-12-12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;活动名称&lt;/td&gt;
&lt;td&gt;2019双十二大促整点红包雨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;活动描述&lt;/td&gt;
&lt;td&gt;2019双十二大促全端整点红包雨活动&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;手动设置奖品概率&lt;/td&gt;
&lt;td&gt;是&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;场次&lt;/th&gt;
&lt;th&gt;奖品类型&lt;/th&gt;
&lt;th&gt;具体奖品&lt;/th&gt;
&lt;th&gt;奖品数量&lt;/th&gt;
&lt;th&gt;中奖概率&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;10:00:00 ~ 10:01:00&lt;/td&gt;
&lt;td&gt;优惠券&lt;/td&gt;
&lt;td&gt;2元优惠券&lt;/td&gt;
&lt;td&gt;2000&lt;/td&gt;
&lt;td&gt;50%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;优惠券&lt;/td&gt;
&lt;td&gt;5元优惠券&lt;/td&gt;
&lt;td&gt;1000&lt;/td&gt;
&lt;td&gt;20%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;空奖&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;5000&lt;/td&gt;
&lt;td&gt;30%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12:00:00 ~ 12:01:00&lt;/td&gt;
&lt;td&gt;优惠券&lt;/td&gt;
&lt;td&gt;2元优惠券&lt;/td&gt;
&lt;td&gt;2000&lt;/td&gt;
&lt;td&gt;50%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;优惠券&lt;/td&gt;
&lt;td&gt;5元优惠券&lt;/td&gt;
&lt;td&gt;1000&lt;/td&gt;
&lt;td&gt;20%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;空奖&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;5000&lt;/td&gt;
&lt;td&gt;30%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;18:00:00 ~ 18:01:00&lt;/td&gt;
&lt;td&gt;优惠券&lt;/td&gt;
&lt;td&gt;2元优惠券&lt;/td&gt;
&lt;td&gt;2000&lt;/td&gt;
&lt;td&gt;50%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;优惠券&lt;/td&gt;
&lt;td&gt;5元优惠券&lt;/td&gt;
&lt;td&gt;1000&lt;/td&gt;
&lt;td&gt;20%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;空奖&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;5000&lt;/td&gt;
&lt;td&gt;30%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;备注：每轮场次中奖概率之和必须为100%，否则剩余部分默认添加为空奖的中奖概率。&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-第五要素均匀投奖" class="anchor" aria-hidden="true" href="#第五要素均匀投奖"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;第五要素：均匀投奖&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;如何均匀的抽走奖品?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;答案: 均匀投奖。&lt;/p&gt;
&lt;p&gt;具体方式为拆分总奖品数量，到各个细致具体的时间段。以双十二幸运大转盘为例：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;场次&lt;/th&gt;
&lt;th&gt;奖品类型&lt;/th&gt;
&lt;th&gt;具体奖品&lt;/th&gt;
&lt;th&gt;奖品数量&lt;/th&gt;
&lt;th&gt;中奖概率&lt;/th&gt;
&lt;th&gt;投奖时间(默认提前5分钟投奖)&lt;/th&gt;
&lt;th&gt;投奖数量&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;00:00:00 至 23:59:59&lt;/td&gt;
&lt;td&gt;优惠券&lt;/td&gt;
&lt;td&gt;2元优惠券&lt;/td&gt;
&lt;td&gt;2000&lt;/td&gt;
&lt;td&gt;50%&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;00:00:00&lt;/td&gt;
&lt;td&gt;2000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;06:00:00&lt;/td&gt;
&lt;td&gt;2000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;12:00:00&lt;/td&gt;
&lt;td&gt;2000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;td&gt;18:00:00&lt;/td&gt;
&lt;td&gt;2000&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;这里我们就得到了抽奖的&lt;strong&gt;第五个要素：均匀投奖&lt;/strong&gt;。&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-需求总结" class="anchor" aria-hidden="true" href="#需求总结"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;需求总结&lt;/h2&gt;
&lt;p&gt;通过上面的分析，我们得到抽奖五要素如下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;抽奖五要素&lt;/th&gt;
&lt;th&gt;要素名称&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;第一要素&lt;/td&gt;
&lt;td&gt;活动&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;第二要素&lt;/td&gt;
&lt;td&gt;场次&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;第三要素&lt;/td&gt;
&lt;td&gt;奖品&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;第四要素&lt;/td&gt;
&lt;td&gt;中奖概率&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;第五要素&lt;/td&gt;
&lt;td&gt;均匀投奖&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;同时我们通过&lt;strong&gt;抽奖五要素&lt;/strong&gt;也得到了&lt;strong&gt;通用抽奖工具&lt;/strong&gt;配置一场抽奖活动的5个基本步骤：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;活动配置&lt;/li&gt;
&lt;li&gt;场次配置&lt;/li&gt;
&lt;li&gt;奖品配置&lt;/li&gt;
&lt;li&gt;奖品中奖概率配置&lt;/li&gt;
&lt;li&gt;奖品投奖配置&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;&lt;a id="user-content-通用抽奖工具系统设计" class="anchor" aria-hidden="true" href="#通用抽奖工具系统设计"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;通用抽奖工具系统设计&lt;/h2&gt;
&lt;p&gt;需求已经分析完了，今天我们就来看看这通用抽奖工具具体的设计，分为如下三个部分：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;DB设计&lt;/li&gt;
&lt;li&gt;配置后台设计&lt;/li&gt;
&lt;li&gt;接口设计&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;&lt;a id="user-content-db设计" class="anchor" aria-hidden="true" href="#db设计"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;DB设计&lt;/h2&gt;
&lt;p&gt;第一要素&lt;code&gt;活动配置&lt;/code&gt;的&lt;code&gt;抽奖活动表&lt;/code&gt;：&lt;/p&gt;
&lt;div class="highlight highlight-source-sql"&gt;&lt;pre&gt;&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 通用抽奖工具(万能胶Glue) glue_activity 抽奖活动表&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;glue_activity&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;活动ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;serial_no&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;char&lt;/span&gt;(&lt;span class="pl-c1"&gt;16&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;活动编号(md5值中间16位)&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;name&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;活动名称&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;description&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;活动描述&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;activity_type&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;1&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;活动抽奖类型1: 按时间抽奖 2: 按抽奖次数抽奖 3:按数额范围区间抽奖&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;probability_type&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;1&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;中奖概率类型1: static 2: dynamic&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;times_limit&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;3&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;抽奖次数限制，0默认不限制&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;start_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;活动开始时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;end_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;活动结束时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;修改人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;)  &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 -1:deleted, 0:disable, 1:enable&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;抽奖活动表&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;第二要素&lt;code&gt;场次配置&lt;/code&gt;的&lt;code&gt;抽奖场次表&lt;/code&gt;：&lt;/p&gt;
&lt;div class="highlight highlight-source-sql"&gt;&lt;pre&gt;&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 通用抽奖工具(万能胶Glue) glue_session 抽奖场次表&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;glue_session&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;场次ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;activity_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;活动ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;times_limit&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;3&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;抽奖次数限制，0默认不限制&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;start_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;场次开始时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;end_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;场次结束时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;修改人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;)  &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 -1:deleted, 0:disable, 1:enable&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;抽奖场次表&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;第三、四要素&lt;code&gt;奖品配置&lt;/code&gt;的&lt;code&gt;抽奖场次奖品表&lt;/code&gt;：&lt;/p&gt;
&lt;div class="highlight highlight-source-sql"&gt;&lt;pre&gt;&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 通用抽奖工具(万能胶Glue) glue_session_prizes 抽奖场次奖品表&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;glue_session_prizes&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;自增ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;session_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;场次ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;node&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;节点标识 按时间抽奖: 空值, 按抽奖次数抽奖: 第几次参与值, 按数额范围区间抽奖: 数额区间上限值&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;prize_type&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;奖品类型 1:优惠券, 2:积分, 3:实物, 4:空奖 ...&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;name&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;奖品名称&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pic_url&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;奖品图片&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;value&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;varchar&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;奖品抽象值 优惠券:优惠券ID, 积分:积分值, 实物: sku ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;probability&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;3&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;中奖概率1~100&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;修改人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;)  &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 -1:deleted, 0:disable, 1:enable&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;抽奖场次奖品表&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;第五要素&lt;code&gt;均匀投奖&lt;/code&gt;的&lt;code&gt;抽奖场次奖品定时投放器表&lt;/code&gt;：&lt;/p&gt;
&lt;div class="highlight highlight-source-sql"&gt;&lt;pre&gt;&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 通用抽奖工具(万能胶Glue) glue_session_prizes_timer 抽奖场次奖品定时投放器表&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;glue_session_prizes_timer&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;自增ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;session_prizes_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;抽奖场次奖品ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;delivery_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;定时投放奖品数量的时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;prize_quantity&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;3&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;奖品数量&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_by&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;修改人staff_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;)  &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 -1:deleted, 0:wait, 1:success&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;抽奖场次奖品定时投放器表&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;其他表，抽奖记录&amp;amp;奖品发放记录表：&lt;/p&gt;
&lt;div class="highlight highlight-source-sql"&gt;&lt;pre&gt;&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; 通用抽奖工具(万能胶Glue) glue_user_draw_record 用户抽奖记录表&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; `&lt;span class="pl-en"&gt;glue_user_draw_record&lt;/span&gt;` (
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;自增ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;activity_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;活动ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;session_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;场次ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;prize_type_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;奖品类型ID&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;user_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建人user_id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;int&lt;/span&gt;(&lt;span class="pl-c1"&gt;11&lt;/span&gt;) unsigned &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;tinyint&lt;/span&gt;(&lt;span class="pl-c1"&gt;1&lt;/span&gt;)  &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;状态 -1:未中奖, 1:已中奖 , 2: 发奖失败 , 3: 已发奖&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;log&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;text&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;操作信息等记录&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
) ENGINE&lt;span class="pl-k"&gt;=&lt;/span&gt;InnoDB DEFAULT CHARSET&lt;span class="pl-k"&gt;=&lt;/span&gt;utf8mb4 COMMENT&lt;span class="pl-k"&gt;=&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;用户抽奖记录表&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;&lt;a id="user-content-配置后台设计" class="anchor" aria-hidden="true" href="#配置后台设计"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;配置后台设计&lt;/h2&gt;
&lt;h4&gt;&lt;a id="user-content-创建活动" class="anchor" aria-hidden="true" href="#创建活动"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;创建活动&lt;/h4&gt;
&lt;p align="center"&gt;
    &lt;a href="http://cdn.tigerb.cn/20191229224816.png?imageMogr2/thumbnail/1934x1567!/format/webp/blur/1x0/quality/75|imageslim" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/68079669a29209a1d368a586b2ebb190da5d2624/687474703a2f2f63646e2e7469676572622e636e2f32303139313232393232343831362e706e673f696d6167654d6f6772322f7468756d626e61696c2f313933347831353637212f666f726d61742f776562702f626c75722f3178302f7175616c6974792f37357c696d616765736c696d" width="66%" data-canonical-src="http://cdn.tigerb.cn/20191229224816.png?imageMogr2/thumbnail/1934x1567!/format/webp/blur/1x0/quality/75|imageslim" style="max-width:100%;"&gt;
    &lt;/a&gt;
&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-创建活动场次" class="anchor" aria-hidden="true" href="#创建活动场次"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;创建活动场次&lt;/h4&gt;
&lt;p align="center"&gt;
    &lt;a href="http://cdn.tigerb.cn/20191230081157.png?imageMogr2/thumbnail/971x2069!/format/webp/blur/1x0/quality/75%7Cimageslim" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/b9584e5685d47fc9cbb81714a037d1e94b37bc0c/687474703a2f2f63646e2e7469676572622e636e2f32303139313233303038313135372e706e673f696d6167654d6f6772322f7468756d626e61696c2f3937317832303639212f666f726d61742f776562702f626c75722f3178302f7175616c6974792f3735253743696d616765736c696d" width="66%" data-canonical-src="http://cdn.tigerb.cn/20191230081157.png?imageMogr2/thumbnail/971x2069!/format/webp/blur/1x0/quality/75%7Cimageslim" style="max-width:100%;"&gt;
    &lt;/a&gt;
&lt;/p&gt;
&lt;p align="center"&gt;
    &lt;a href="http://cdn.tigerb.cn/20191229224543.png?imageMogr2/thumbnail/971x2214!/format/webp/blur/1x0/quality/75%7Cimageslim" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/23487e05311cd2657678085f6376691e0a8ab512/687474703a2f2f63646e2e7469676572622e636e2f32303139313232393232343534332e706e673f696d6167654d6f6772322f7468756d626e61696c2f3937317832323134212f666f726d61742f776562702f626c75722f3178302f7175616c6974792f3735253743696d616765736c696d" width="66%" data-canonical-src="http://cdn.tigerb.cn/20191229224543.png?imageMogr2/thumbnail/971x2214!/format/webp/blur/1x0/quality/75%7Cimageslim" style="max-width:100%;"&gt;
    &lt;/a&gt;
&lt;/p&gt;
&lt;p align="center"&gt;
    &lt;a href="http://cdn.tigerb.cn/20191229224834.png?imageMogr2/thumbnail/971x1693!/format/webp/blur/1x0/quality/75%7Cimageslim" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/af719c49d0f7cecc9dd82964e0955a5393ef4ad6/687474703a2f2f63646e2e7469676572622e636e2f32303139313232393232343833342e706e673f696d6167654d6f6772322f7468756d626e61696c2f3937317831363933212f666f726d61742f776562702f626c75722f3178302f7175616c6974792f3735253743696d616765736c696d" width="66%" data-canonical-src="http://cdn.tigerb.cn/20191229224834.png?imageMogr2/thumbnail/971x1693!/format/webp/blur/1x0/quality/75%7Cimageslim" style="max-width:100%;"&gt;
    &lt;/a&gt;
&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-活动列表" class="anchor" aria-hidden="true" href="#活动列表"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;活动列表&lt;/h4&gt;
&lt;p align="center"&gt;
    &lt;a href="http://cdn.tigerb.cn/20191229223706.png?imageMogr2/thumbnail/1338x761!/format/webp/blur/1x0/quality/75%7Cimageslim" rel="nofollow"&gt;
        &lt;img src="https://camo.githubusercontent.com/f32144fd1bfd2142f91210ea0631912ab22cd196/687474703a2f2f63646e2e7469676572622e636e2f32303139313232393232333730362e706e673f696d6167654d6f6772322f7468756d626e61696c2f3133333878373631212f666f726d61742f776562702f626c75722f3178302f7175616c6974792f3735253743696d616765736c696d" width="66%" data-canonical-src="http://cdn.tigerb.cn/20191229223706.png?imageMogr2/thumbnail/1338x761!/format/webp/blur/1x0/quality/75%7Cimageslim" style="max-width:100%;"&gt;
    &lt;/a&gt;
&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-接口设计-2" class="anchor" aria-hidden="true" href="#接口设计-2"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;接口设计&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;获取活动信息 GET {version}/glue/activity&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;请求参数：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;是否必传&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;serial_no&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;Y&lt;/td&gt;
&lt;td&gt;活动编号&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;msg&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;OK&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;serial_no&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 活动编号&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;type&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, 活动抽奖类型1: 按时间抽奖 2: 按抽奖次数抽奖 3:按数额范围区间抽奖&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;name&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 活动名称&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;description&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 活动描述&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;start_time&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, 活动开始时间&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;end_time&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, 活动开始时间&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;remaining_times&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, 活动抽奖次数限制，0不限制&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;sessions_list&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;:[
            {
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;start_time&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, 场次开始时间&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;end_time&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, 场次开始时间&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;remaining_times&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, 场次抽奖次数限制，0不限制&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;prizes_list&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: [
                    {
                        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;name&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 奖品名称&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
                        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;pic_url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 奖品图片&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;
                    }
                ]
            }
        ]
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;ol start="2"&gt;
&lt;li&gt;抽奖 POST {version}/glue/activity/draw&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;请求参数：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;是否必传&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;serial_no&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;Y&lt;/td&gt;
&lt;td&gt;活动编号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;uid&lt;/td&gt;
&lt;td&gt;number&lt;/td&gt;
&lt;td&gt;Y&lt;/td&gt;
&lt;td&gt;用户ID&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;响应内容：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;// 中奖
{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;200&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;msg&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;OK&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;serial_no&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, spu id&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;act_remaining_times&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, 本活动抽奖剩余次数，0不限制&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;session_remaining_times&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;number, 本场次抽奖剩余次数，0不限制&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;prizes_info&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: 
        {
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;name&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 奖品名称&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
            &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;pic_url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;string, 奖品图片&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;
        }
    }
}

// 未中奖
{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;code&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;401&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;msg&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;result&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;: {
        
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;&lt;a id="user-content-结语" class="anchor" aria-hidden="true" href="#结语"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;结语&lt;/h2&gt;
&lt;p&gt;活动营销系统中的第一个字系统&lt;strong&gt;通用抽奖工具&lt;/strong&gt;今天讲完了，希望对大家有一定的帮助或启示。&lt;/p&gt;
&lt;h1&gt;&lt;a id="user-content-交易中心" class="anchor" aria-hidden="true" href="#交易中心"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;交易中心&lt;/h1&gt;
&lt;h2&gt;&lt;a id="user-content-常见第三方支付流程" class="anchor" aria-hidden="true" href="#常见第三方支付流程"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;常见第三方支付流程&lt;/h2&gt;
&lt;p&gt;这几年的工作中一直与支付打交到，借着 &lt;a href="https://github.com/skr-shop/manuals"&gt;skr-shop&lt;/a&gt; 这个项目来与大家一起分享探索一下支付系统该怎么设计、怎么做。我们先从支付的一些常见流程出发分析，找出这些支付的共性，抽象后再去探讨具体的数据库设计、代码结构设计。&lt;/p&gt;
&lt;p&gt;相关项目：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/helei112g/payment"&gt;PHP 版本的支付SDK&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/skr-shop/fool-pay"&gt;Go 版本的支付SDK-开发中&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;支付整体而言的一个流程是：给第三方发起了一笔交易，用户通过第三方完成支付，第三方告诉我支付成功，我把用户购买的产品给用户。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/265ae8d79e5a45aab0dc5ae5d6d171f19163315e/68747470733a2f2f6461797574616c6b2e636e2f696d672f7061792d312e6a7067"&gt;&lt;img src="https://camo.githubusercontent.com/265ae8d79e5a45aab0dc5ae5d6d171f19163315e/68747470733a2f2f6461797574616c6b2e636e2f696d672f7061792d312e6a7067" alt="pay-1" data-canonical-src="https://dayutalk.cn/img/pay-1.jpg" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;看似简单的流程，这里边不同的支付机构却有不同的处理。下面以我接触过的一些支付来总结一下&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-国内支付" class="anchor" aria-hidden="true" href="#国内支付"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;国内支付&lt;/h3&gt;
&lt;p&gt;国内的典型支付代表是：&lt;strong&gt;支付宝&lt;/strong&gt;、&lt;strong&gt;微信&lt;/strong&gt;、&lt;strong&gt;银行&lt;/strong&gt;(以招商银行为例)，由于国内的支付都支持多种渠道的支付方式，为了描述简单，我们均以pc上的支付为例进行讲解。&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-支付宝" class="anchor" aria-hidden="true" href="#支付宝"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;支付宝&lt;/h4&gt;
&lt;p&gt;支付宝的接入是我觉得最简单的一种支付。对于在PC上的支付能力，支付宝提供了【电脑支付】。当用户下单后，商户系统根据支付宝的规则构建好一个url，用户跳转到这个url后进入到支付宝的支付页面，然后完成支付流程。&lt;/p&gt;
&lt;p&gt;在支付成功后，支付宝会通过 &lt;strong&gt;同步通知&lt;/strong&gt;、&lt;strong&gt;异步通知&lt;/strong&gt; 两种方式告诉商户系统支付成功，并且两种通知方式的结果都是可信的，而且异步通知的消息延迟也非常短暂。&lt;/p&gt;
&lt;p&gt;对于退款流程，支付宝支持全额、部分退款。并且能够根据商户的退款单号区分是否是同一笔退款进而避免了重复退款的可能。支付的退款是调用后同步返回结果，不会异步通知。&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-微信支付" class="anchor" aria-hidden="true" href="#微信支付"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;微信支付&lt;/h4&gt;
&lt;p&gt;微信并没有提供真的PC支付能力，但是我们可以利用【扫码支付】来达成电脑支付的目的。扫码支付有两种模式，这里以模式二为例。&lt;/p&gt;
&lt;p&gt;微信调用下单接口获取到这个二维码链接，然后用户扫码后，进入支付流程。完成支付后微信会 &lt;strong&gt;异步通知&lt;/strong&gt;，但是这里并没有 &lt;strong&gt;同步通知&lt;/strong&gt;，因此前端页面只能通过定时轮训的方式检查这笔交易是否支付，直到查询到成功、或者用户主动关闭页面。&lt;/p&gt;
&lt;p&gt;退款流程与支付宝最大的不同是，有一个 &lt;strong&gt;异步通知&lt;/strong&gt; 需要商户系统进行处理。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;第一个不同点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;异步通知的接口需要处理多种不同类型的异步消息&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h4&gt;&lt;a id="user-content-招商银行" class="anchor" aria-hidden="true" href="#招商银行"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;招商银行&lt;/h4&gt;
&lt;p&gt;随着在线支付在国内的蓬勃发展，各家银行也是不断推出自己的在线支付能力。其中的佼佼者当属 &lt;strong&gt;招商银行&lt;/strong&gt;。大家经常用的滴滴上面就有该支付方式，可以体验一下。&lt;/p&gt;
&lt;p&gt;招商支付使用的是银行卡，因此首次用户必须进行绑卡。因此这里可能就多了一个流程，首先得记录用户是否绑过卡，然后用于签名的公钥会发生变化，需要定期更新。&lt;/p&gt;
&lt;p&gt;招商所有平台的支付体验都是一致的，会跳转到招行的H5页面完成逻辑，支付成功后并不会自动跳回商户，也就是没有 &lt;strong&gt;同步通知&lt;/strong&gt;，它的支付结果只会走异步通知流程，延迟非常短暂。&lt;/p&gt;
&lt;p&gt;退款流程与支付宝一样，也是同步返回退款结果，没有异步通知。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;第二个不同点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;支付前需要检查用户是否签约过，有签约流程&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h4&gt;&lt;a id="user-content-小结" class="anchor" aria-hidden="true" href="#小结"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;小结&lt;/h4&gt;
&lt;p&gt;国内在线支付流程相对都比较完善，接入起来也非常容易。需要注意的一点是：退款后之前支付的单子依然是支付成功状态，并不会变成退款状态。因为退款与支付属于不同的交易。&lt;/p&gt;
&lt;p&gt;这一点基本上是国内在线支付的通用做法。&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-国际支付" class="anchor" aria-hidden="true" href="#国际支付"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;国际支付&lt;/h3&gt;
&lt;p&gt;国际支付的平台非常多，包括像支付宝、微信也在扩展这一块市场。我以我接触的几家支付做一个简单的总结。&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-worldpay" class="anchor" aria-hidden="true" href="#worldpay"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;WorldPay&lt;/h4&gt;
&lt;p&gt;这是比较出名的一家国际支付公司，它主要做的是银行卡支付，公司在英国&lt;/p&gt;
&lt;p&gt;支付流程上，也是根据规则构建好请求的url后，直接跳转到 &lt;strong&gt;WorldPay&lt;/strong&gt; 的页面，通过信用卡完成支付。这里比较麻烦的处理机制是：支付成功后，他首次给你的异步/同步消息通知并不能作为支付成功的依据。真的从银行确认划款成功后，才会给出真的支付成功通知。这中间还可能会异步通知告诉你支付请求被拒绝。最头痛的是不同状态的异步消息时间间隔都是按照分钟以上级别的延迟来计算&lt;/p&gt;
&lt;p&gt;退款流程上，状态跟微信一样，需要通过异步消息来确认退款状态。其次它的不同点在于无法根据商户退款单号来确认是否已经发起过退款，因此对于它来说只要请求一次退款接口，那它就默认发起了一次退款。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;第三、四不同点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;支付成功后的通知状态有多种，涉及到商户系统业务流程的特殊处理&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;退款不支持商户退款单号，无法支持防重复退款需要商户自己处理&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h4&gt;&lt;a id="user-content-assist" class="anchor" aria-hidden="true" href="#assist"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Assist&lt;/h4&gt;
&lt;p&gt;这是俄罗斯的一家支付公司，这也是一家搞死人不偿命的公司，看下面介绍&lt;/p&gt;
&lt;p&gt;它的支付发起是需要构建一个form表单，向它post支付相关的数据。成功后会跳转到它的支付页，用户完成支付即可。对于 &lt;strong&gt;同步通知&lt;/strong&gt;，它需要用户手动触发跳回商户，与招商的逻辑很像，同步也仅仅是做返回并不会真的告知支付结果。&lt;strong&gt;异步通知&lt;/strong&gt; 才是真的告知支付状态。比较恶心的是，支付时必须传入指定格式的商品信息，这会在部分退款时用到。&lt;/p&gt;
&lt;p&gt;现在来说退款，退款也是与 &lt;strong&gt;WorldPay&lt;/strong&gt; 一样，不支持商户的退款单号，因此防重方面也许自己的系统进行设计。并且如果是部分退款，需要传入指定的退款商品，这就会出现一个非常尴尬的局面：部分退款的金额与任何一个商品金额都对应不上，退款则会失败。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;第五个不同点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;部分退款时需要传入部分退款的商品信息，并且金额要一致&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h4&gt;&lt;a id="user-content-doku" class="anchor" aria-hidden="true" href="#doku"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Doku&lt;/h4&gt;
&lt;p&gt;接下来再来聊聊印尼的这家支付机构 &lt;strong&gt;doku&lt;/strong&gt;。由于印尼这个国家信用卡的普及程度并不高，它的在线支付提供一种超商支付方式。&lt;/p&gt;
&lt;p&gt;什么是超商支付呢？也就是用户在网络上完成下单后，会获取到一个二维码或者条形码。用户拿着这个条形码到超商（711、全家这种）通过收银员扫码，付现金给超商，完成支付流程。&lt;/p&gt;
&lt;p&gt;这种方式带来的问题是，用户长时间不去支付，导致订单超时关单后才去付款。对整个业务流程以及用户体验带来很多伤害。&lt;/p&gt;
&lt;p&gt;再来说退款，由于存在超商这种支付方式，导致这种支付无法支持在线自动退款，需要人工收集用户银行卡信息，然后完成转账操作。非常痛苦不堪。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;第六个不同点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;线上没有付款，只有获取付款码，退款需要通过人工操作&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h4&gt;&lt;a id="user-content-amazonpay" class="anchor" aria-hidden="true" href="#amazonpay"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;AmazonPay&lt;/h4&gt;
&lt;p&gt;亚马逊出品，与支付宝非常类似。提供的是集成式的钱包流程。&lt;/p&gt;
&lt;p&gt;支付时直接构建一个url，然后跳转到亚马逊即可完成支付。它还提供一种授权模式，能够不用跳转amazon，再商户端即完成支付。&lt;/p&gt;
&lt;p&gt;支付成功后也会同步跳转，&lt;strong&gt;同步通知&lt;/strong&gt; 的内容可以作为支付是否成功的判断依据。经过实际检查 &lt;strong&gt;异步通知&lt;/strong&gt; 的到达会稍有延迟，大概10s以内。&lt;/p&gt;
&lt;p&gt;退款方面也支持商户退款单号可以依赖此进行防重。但是退款的状态也是基于异步来的。&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-总结" class="anchor" aria-hidden="true" href="#总结"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;总结&lt;/h3&gt;
&lt;p&gt;这其中还有一些国际支付，如：&lt;strong&gt;PayPal&lt;/strong&gt;、&lt;strong&gt;GooglePay&lt;/strong&gt;、&lt;strong&gt;PayTM&lt;/strong&gt; 等知名支付机构没有进行介绍，是因为基本它们的流程也都在上面的模式之中。我们后续的代码结构设计、数据库设计都基于满足上面的各种支付模型来完成设计。&lt;/p&gt;
&lt;p&gt;最后，赠送大家一副脑图，这是接入一家支付时必须弄清楚的问题清单&lt;/p&gt;
&lt;p&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/b26475c7734603c00371bf05f53310d63f90b6f5/68747470733a2f2f6461797574616c6b2e636e2f696d672f7061792d322e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/b26475c7734603c00371bf05f53310d63f90b6f5/68747470733a2f2f6461797574616c6b2e636e2f696d672f7061792d322e706e67" alt="pay-2" data-canonical-src="https://dayutalk.cn/img/pay-2.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-支付系统设计" class="anchor" aria-hidden="true" href="#支付系统设计"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;支付系统设计&lt;/h2&gt;
&lt;p&gt;文中我们从严谨的角度一步步聊到支付如何演变成独立的系统。内容包括：系统演进过程、接口设计、数据库设计以及代码如何组织的示例。若有不足之处，欢迎讨论共同学习。&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-从模块到服务" class="anchor" aria-hidden="true" href="#从模块到服务"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;从模块到服务&lt;/h3&gt;
&lt;p&gt;我记得最开始工作的时候，所有的功能：加购物车/下单/支付 等逻辑都是放在一个项目里。如果一个新的项目需要某个功能，就把这个部分的功能包拷贝到新的项目。数据库也原封不动的拷贝过来，稍微根据需求改改。&lt;/p&gt;
&lt;p&gt;这就是所谓的 &lt;strong&gt;单体应用&lt;/strong&gt; 时代，随着公司产品线开始多元，每条产品线都需要用到支付服务。如果支付模块调整了代码，那么就会处处改动、处处测试。另一方面公司的交易数据割裂在不同的系统中，无法有效汇总统一分析、管理。&lt;/p&gt;
&lt;p&gt;这时就到了系统演进的时候，我们把每个产品线的支付模块抽离成统一的服务。对自己公司内部提供统一的API使用，可以对这些API进一步包装成对应的SDK，供内部业务线快速接入。这里服务使用HTTP或者是RPC协议都可以根据公司实际情况决定。不过如果考虑到未来给第三方使用，建议使用HTTP协议，&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;系统的演变过程：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/0a8d83190456d1aafa4117326d6180a8ad280875/68747470733a2f2f6461797574616c6b2e636e2f696d672f696d6167652d32303139303330393130343534313734392e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/0a8d83190456d1aafa4117326d6180a8ad280875/68747470733a2f2f6461797574616c6b2e636e2f696d672f696d6167652d32303139303330393130343534313734392e706e67" alt="image-20190309104541749" data-canonical-src="https://dayutalk.cn/img/image-20190309104541749.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;总结下，将支付单独抽离成服务后，带来好处如下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;避免重复开发，数据隔离的现象出现；&lt;/li&gt;
&lt;li&gt;支付系统周边功能演进更容易，整个系统更完善丰满。如：对账系统、实时交易数据展示；&lt;/li&gt;
&lt;li&gt;随时可对外开发，对外输出Paas能力，成为有收入的项目；&lt;/li&gt;
&lt;li&gt;专门的团队进行维护，系统更有机会演进成顶级系统；&lt;/li&gt;
&lt;li&gt;公司重要账号信息保存一处，风险更小。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;&lt;a id="user-content-系统能力" class="anchor" aria-hidden="true" href="#系统能力"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;系统能力&lt;/h3&gt;
&lt;p&gt;如果我们接手该需求，需要为公司从零搭建支付系统。我们该从哪些方面入手？这样的系统到底需要具备什么样的能力呢？&lt;/p&gt;
&lt;p&gt;首先支付系统我们可以理解成是一个适配器。他需要把很多第三方的接口进行统一的整合封装后，对内部提供统一的接口，减少内部接入的成本。做为一个最基本的支付系统。需要对内提供如下接口出来：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;发起支付，我们取名：&lt;code&gt;/gopay&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;发起退款，我们取名：&lt;code&gt;/refund&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;接口异步通知，我们取名：&lt;code&gt;/notify/支付渠道/商户交易号&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;接口同步通知，我们取名：&lt;code&gt;/return/支付渠道/商户交易号&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;交易查询，我们取名：&lt;code&gt;/query/trade&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;退款查询，我们取名：&lt;code&gt;/query/refund&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;账单获取，我们取名：&lt;code&gt;/query/bill&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;结算明细，我们取名：&lt;code&gt;/query/settle&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;一个基础的支付系统，上面8个接口是肯定需要提供的（这里忽略某些支付中的转账、绑卡等接口）。现在我们来基于这些接口看看都有哪些系统会用到。&lt;/p&gt;
&lt;p&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/07a04f24171c2f669ba0cd0b2f20814ad3dd6fc4/68747470733a2f2f6461797574616c6b2e636e2f696d672f696d6167652d32303139303330393131313030313838302e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/07a04f24171c2f669ba0cd0b2f20814ad3dd6fc4/68747470733a2f2f6461797574616c6b2e636e2f696d672f696d6167652d32303139303330393131313030313838302e706e67" alt="image-20190309111001880" data-canonical-src="https://dayutalk.cn/img/image-20190309111001880.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;下面按照系统维度，介绍下这些接口如何使用，以及内部的一些逻辑。&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-应用系统" class="anchor" aria-hidden="true" href="#应用系统"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;应用系统&lt;/h4&gt;
&lt;p&gt;一般支付网关会提供两种方式让应用系统接入：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;网关模式，也就是应用系统自己需要开发一个收银台；（适合提供给第三方）&lt;/li&gt;
&lt;li&gt;收银台模式，应用系统直接打开支付网关的统一收银台。（内部业务）&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;下面为了讲清楚设计思路，我们按照 &lt;strong&gt;网关模式&lt;/strong&gt; 进行讲解。&lt;/p&gt;
&lt;p&gt;对于应用系统它需要能够请求支付，也就是调用 &lt;code&gt;gopay&lt;/code&gt; 接口。这个接口会处理商户的数据，完成后会调用第三方网关接口，并将返回结果统一处理后返回给应用方。&lt;/p&gt;
&lt;p&gt;这里需要注意，第三方针对支付接口根据我的经验大致有以下情况：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;支付时，不需要调用第三方，按照规则生成数据即可；&lt;/li&gt;
&lt;li&gt;支付时，需要调用第三方多个接口完成逻辑（这可能比较慢，大型活动时需要考虑限流/降配）；&lt;/li&gt;
&lt;li&gt;返回的数据是一个url，可直接跳转到第三方完成支付（wap/pc站）；&lt;/li&gt;
&lt;li&gt;返回的数据是xml/json结构，需要拼装或作为参数传给她的sdk（app）。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这里由于第三方返回结构的不统一，我们需要统一处理成统一格式，返回给商户端。我推荐使用json格式。&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;errno&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;:&lt;span class="pl-c1"&gt;0&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;msg&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;:&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;ok&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;data&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;:{

    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;我们把所有的变化封装在 &lt;strong&gt;data&lt;/strong&gt; 结构中。举个例子，如果返回的一个url。只需要应用程序发起 &lt;strong&gt;GET&lt;/strong&gt; 请求。我们可以这样返回：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;errno&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;:&lt;span class="pl-c1"&gt;0&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;msg&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;:&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;ok&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;data&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;:{
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;url&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;:&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;xxxxx&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;method&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;:&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;GET&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;如果是返回的结构，需要应用程序直接发起 &lt;strong&gt;POST&lt;/strong&gt; 请求。我们可以这样返回：&lt;/p&gt;
&lt;div class="highlight highlight-source-json"&gt;&lt;pre&gt;{
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;errno&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;:&lt;span class="pl-c1"&gt;1&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;msg&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;:&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;ok&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
    &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;data&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;:{
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;from&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;:&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&amp;lt;form action=&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;&lt;span class="pl-ii"&gt;xxx&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt; method=&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;&lt;span class="pl-ii"&gt;POST&lt;/span&gt;&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&amp;gt;xxxxx&amp;lt;/form&amp;gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;,
        &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;method&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;:&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;POST&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;
    }
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这里的 &lt;strong&gt;form&lt;/strong&gt; 字段，生成了一个form表单，应用程序拿到后可直接显示然后自动提交。当然封装成 from表单这一步也可以放在商户端进行。&lt;/p&gt;
&lt;p&gt;上面的数据格式仅仅是一个参考。大家可根据自己的需求进行调整。&lt;/p&gt;
&lt;p&gt;一般应用系统除了会调用发起支付的接口外，可能还需要调用 &lt;strong&gt;支付结果查询接口&lt;/strong&gt;。当然大多数情况下不需要调用，应用系统对交易的状态只应该依赖自己的系统状态。&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-对账系统" class="anchor" aria-hidden="true" href="#对账系统"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;对账系统&lt;/h4&gt;
&lt;p&gt;对于对账，一般分为两个类型：&lt;strong&gt;交易对账&lt;/strong&gt; 与 &lt;strong&gt;结算对账&lt;/strong&gt;&lt;/p&gt;
&lt;h5&gt;&lt;a id="user-content-交易对账" class="anchor" aria-hidden="true" href="#交易对账"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;交易对账&lt;/h5&gt;
&lt;p&gt;交易对账的核心点是：&lt;strong&gt;检查每一笔交易是否正确&lt;/strong&gt;。它主要目的是看我们系统中的每一笔交易与第三方的每一笔交易是否一致。&lt;/p&gt;
&lt;p&gt;这个检查逻辑很简单，对两份账单数据进行比较。它主要是使用 &lt;code&gt;/query/bill&lt;/code&gt; 接口，拿到在第三方那边完成的交易数据。然后跟我方的交易成功数据进行比较。检查是否存在误差。&lt;/p&gt;
&lt;p&gt;这个逻辑非常简单，但是有几点需要大家注意：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;我方的数据需要正常支付数据+重复支付数据的总和；&lt;/li&gt;
&lt;li&gt;对账检查不成功主要包括：&lt;strong&gt;金额不对&lt;/strong&gt;、&lt;strong&gt;第三方没有找到对应的交易数据&lt;/strong&gt;、&lt;strong&gt;我方不存在对应的交易数据&lt;/strong&gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;针对这些情况都需要有对应的处理手段进行处理。在我的经验中上面的情况都有过遇到。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;金额不对&lt;/strong&gt;：主要是由于第三方的问题，可能是系统升级故障、可能是账单接口金额错误；&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;第三方无交易数据：&lt;/strong&gt; 可能是拉去的账单时间维度问题（比如存在时差），这种时区问题需要自己跟第三方确认找到对应的时间差。也可能是被攻击，有人冒充第三方异步通知（说明系统校验机制又问题或者密钥泄漏了）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;自己系统无交易数据：&lt;/strong&gt; 这种原因可能是第三方通知未发出或者未正确处理导致的。&lt;/p&gt;
&lt;p&gt;上面这些问题的处理绝大部份都可以依赖 &lt;code&gt;query/trade&lt;/code&gt;  &lt;code&gt;query/refund&lt;/code&gt; 来完成自动化处理。&lt;/p&gt;
&lt;h5&gt;&lt;a id="user-content-结算对账" class="anchor" aria-hidden="true" href="#结算对账"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;结算对账&lt;/h5&gt;
&lt;p&gt;那么有了上面的 &lt;strong&gt;交易对账&lt;/strong&gt; 为什么还需要 &lt;strong&gt;结算对账&lt;/strong&gt; 呢？这个系统又是干嘛的？先来看下结算的含义。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;结算，就是第三方网关在固定时间点，将T+x或其它约定时间的金额，汇款到公司账号。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;下面我们假设结算周期是： &lt;strong&gt;T+1&lt;/strong&gt;。结算对账主要使用到的接口是 &lt;code&gt;/query/settle&lt;/code&gt;，这个接口获取的主要内容是：每一笔结算的款项都是由哪些笔交易组成（交易成功与退款数据）。以及本次结算扣除多少手续费用。&lt;/p&gt;
&lt;p&gt;它的逻辑其实也很简单。我们先从自己的系统按照 &lt;strong&gt;T+1&lt;/strong&gt; 的结算周期，计算出对方应该汇款给我们多少金额。然后与刚刚接口获取到的数据金额比较：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;银行收款金额 + 手续费 = 我方系统计算的金额&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这一步检查通过后，说明金额没有问题。接下来需要检查本次结算下的每一笔订单是否一致。&lt;/p&gt;
&lt;p&gt;结算系统是 &lt;strong&gt;强依赖&lt;/strong&gt; 对账系统的。如果对账发现异常，那么结算金额肯定会出现异常。另外结算需要注意的一些问题是：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;银行可能会自行退款给用户，因为用户可直接向自己发卡行申请退款；&lt;/li&gt;
&lt;li&gt;结算也存在时区差问题；&lt;/li&gt;
&lt;li&gt;结算接口中的明细交易状态与我方并不完全一致。比如：银行结算时发现某笔退款完成，但我方系统在进行比较时按照未退款完成的逻辑在处理。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;针对上面的问题，大家根据自己的业务需求需要做一些方案来进行自动化处理。&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-财务系统" class="anchor" aria-hidden="true" href="#财务系统"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;财务系统&lt;/h4&gt;
&lt;p&gt;财务系统有很多内部业务，我这里只聊与支付系统相关的。（当然上面的对账系统也可以算是财务范畴）。&lt;/p&gt;
&lt;p&gt;财务系统与支付主要的一个关系点在于校验交易、以及退款。这里校验交易可以使用 &lt;code&gt;query/trade&lt;/code&gt;  &lt;code&gt;query/refund&lt;/code&gt;这两个接口来完成。这个逻辑过程就不需要说了。下面重点说下退款。&lt;/p&gt;
&lt;p&gt;我看到很多的系统退款是直接放在了应用里边，用户申请退款直接就调用退款接口进行退款。这样的风险非常高。支付系统的关于资金流向的接口一定要慎重，不能过多的直接暴露给外部，带来风险。&lt;/p&gt;
&lt;p&gt;退款的功能应该是放到财务系统来做。这样可以走内部的审批流程（是否需要根据业务来），并且在财务系统中可以进行更多检查来觉得是否立即进行退款，或者进入等待、拒绝等流程。&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-第三方网关" class="anchor" aria-hidden="true" href="#第三方网关"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;第三方网关&lt;/h4&gt;
&lt;p&gt;针对第三方主要使用到的其实就是异步通知与同步通知两个接口。这一部分的逻辑其实非常简单。就是根据第三方的通知完成交易状态的变更。以及通知到自己对应的应用系统。&lt;/p&gt;
&lt;p&gt;这部分比较复杂的是，第三方的通知数据结构不统一、通知的类型不统一。比如：有的退款是同步返回结果、有的是异步返回结果。这里如何设计会在后面的 &lt;strong&gt;系统设计&lt;/strong&gt; 中给出答案。&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-数据库设计" class="anchor" aria-hidden="true" href="#数据库设计"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;数据库设计&lt;/h3&gt;
&lt;p&gt;数据的设计是按照：交易、退款、日志 来设计的。对于上面说到的对账等功能并没有。这部分不难大家可以自行设计，按照上面讲到的思路。主要的表介绍如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;pay_transaction&lt;/code&gt; 记录所有的交易数据。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pay_transaction_extension&lt;/code&gt; 记录每次向第三方发起交易时，生成的交易号&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pay_log_data&lt;/code&gt; 所有的日志数据，如：支付请求、退款请求、异步通知等&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pay_repeat_transaction&lt;/code&gt; 重复支付的数据&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pay_notify_app_log&lt;/code&gt; 通知应用程序的日志&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pay_refund&lt;/code&gt; 记录所有的退款数据&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;具体的表结构：&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight highlight-source-sql"&gt;&lt;pre&gt;&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; -----------------------------------------------------&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; Table 创建支付流水表&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; -----------------------------------------------------&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; &lt;span class="pl-en"&gt;IF&lt;/span&gt; NOT EXISTS &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pay_transaction&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;BIGINT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;app_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;32&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;应用id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pay_method_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;支付方式id，可以用来识别支付，如：支付宝、微信、Paypal等&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;app_order_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;应用方订单号&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;transaction_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;本次交易唯一id，整个支付系统唯一，生成他的原因主要是 order_id对于其它应用来说可能重复&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;total_fee&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;支付金额，整数方式保存&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;scale&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; TINYINT UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;金额对应的小数位数&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;currency_code&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;CHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;3&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;CNY&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;交易的币种&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pay_channel&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;选择的支付渠道，比如：支付宝中的花呗、信用卡等&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;expire_time&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;订单过期时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;return_url&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;支付后跳转url&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;notify_url&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;255&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;支付后，异步通知url&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;email&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;用户的邮箱&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;sing_type&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;10&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;RSA&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;采用的签方式：MD5 RSA RSA2 HASH-MAC等&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;intput_charset&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;CHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;5&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;UTF-8&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;字符集编码方式&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;payment_time&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;第三方支付成功的时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;notify_time&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;收到异步通知的时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;finish_time&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;通知上游系统的时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;trade_no&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;第三方的流水号&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;transaction_code&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;真实给第三方的交易code，异步通知的时候更新&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;order_status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; TINYINT &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0:等待支付，1:待付款完成， 2:完成支付，3:该笔交易已关闭，-1:支付失败&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_ip&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建的ip，这可能是自己服务的ip&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_ip&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新的ip&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  UNIQUE INDEX &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;uniq_tradid&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;transaction_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  INDEX &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_trade_no&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;trade_no&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  INDEX &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_ctime&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)),
ENGINE &lt;span class="pl-k"&gt;=&lt;/span&gt; InnoDB
DEFAULT CHARACTER &lt;span class="pl-k"&gt;SET&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; utf8mb4
COMMENT &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;发起支付的数据&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; -----------------------------------------------------&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; Table 交易扩展表&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; -----------------------------------------------------&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; &lt;span class="pl-en"&gt;IF&lt;/span&gt; NOT EXISTS &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pay_transaction_extension&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;BIGINT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;transaction_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;系统唯一交易id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pay_method_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;transaction_code&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;生成传输给第三方的订单号&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;call_num&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; TINYINT UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;发起调用的次数&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;extension_data&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;TEXT&lt;/span&gt; &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;扩展内容，需要保存：transaction_code 与 trade no 的映射关系，异步通知的时候填充&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_ip&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建ip&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  INDEX &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_trads&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;transaction_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pay_status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  UNIQUE INDEX &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;uniq_code&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;transaction_code&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)),
ENGINE &lt;span class="pl-k"&gt;=&lt;/span&gt; InnoDB
DEFAULT CHARACTER &lt;span class="pl-k"&gt;SET&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; utf8mb4
COMMENT &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;交易扩展表&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;

&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; -----------------------------------------------------&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; Table 交易系统全部日志&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; -----------------------------------------------------&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; &lt;span class="pl-en"&gt;IF&lt;/span&gt; NOT EXISTS &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pay_log_data&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;BIGINT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;app_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;32&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;应用id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;app_order_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;应用方订单号&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;transaction_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;本次交易唯一id，整个支付系统唯一，生成他的原因主要是 order_id对于其它应用来说可能重复&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;request_header&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;TEXT&lt;/span&gt; &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;请求的header 头&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;request_params&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;TEXT&lt;/span&gt; &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;支付的请求参数&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;log_type&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;10&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;日志类型，payment:支付; refund:退款; notify:异步通知; return:同步通知; query:查询&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_ip&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建ip&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  INDEX &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_tradt&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;transaction_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;log_type&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)),
ENGINE &lt;span class="pl-k"&gt;=&lt;/span&gt; InnoDB
DEFAULT CHARACTER &lt;span class="pl-k"&gt;SET&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; utf8mb4
COMMENT &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;交易日志表&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;


&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; -----------------------------------------------------&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; Table 重复支付的交易&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; -----------------------------------------------------&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; &lt;span class="pl-en"&gt;IF&lt;/span&gt; NOT EXISTS &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pay_repeat_transaction&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;BIGINT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;app_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;32&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;应用的id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;transaction_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;系统唯一识别交易号&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;transaction_code&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;支付成功时，该笔交易的 code&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;trade_no&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;第三方对应的交易号&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pay_method_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;支付方式&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;total_fee&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;交易金额&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;scale&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; TINYINT UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;小数位数&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;currency_code&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;CHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;3&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;CNY&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;支付选择的币种，CNY、HKD、USD等&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;payment_time&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;第三方交易时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;repeat_type&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; TINYINT UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;1&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;重复类型：1同渠道支付、2不同渠道支付&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;repeat_status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; TINYINT UNSIGNED DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;处理状态,0:未处理；1:已处理&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  INDEX &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_trad&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; ( &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;transaction_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  INDEX &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_method&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pay_method_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  INDEX &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_time&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)),
ENGINE &lt;span class="pl-k"&gt;=&lt;/span&gt; InnoDB
DEFAULT CHARACTER &lt;span class="pl-k"&gt;SET&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; utf8mb4
COMMENT &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;记录重复支付&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;


&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; -----------------------------------------------------&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; Table 通知上游应用日志&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; -----------------------------------------------------&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; &lt;span class="pl-en"&gt;IF&lt;/span&gt; NOT EXISTS &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pay_notify_app_log&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;BIGINT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;app_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;32&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;应用id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pay_method_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;支付方式&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;transaction_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;交易号&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;transaction_code&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;支付成功时，该笔交易的 code&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;sign_type&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;10&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;RSA&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;采用的签名方式：MD5 RSA RSA2 HASH-MAC等&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;input_charset&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;CHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;5&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;UTF-8&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;total_fee&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;涉及的金额，无小数&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;scale&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; TINYINT UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;小数位数&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pay_channel&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;支付渠道&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;trade_no&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;第三方交易号&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;payment_time&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;支付时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;notify_type&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;10&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;paid&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;通知类型，paid/refund/canceled&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;notify_status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;7&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;INIT&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;通知支付调用方结果；INIT:初始化，PENDING: 进行中；  SUCCESS：成功；  FAILED：失败&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt;,
  &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  INDEX &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_trad&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;transaction_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  INDEX &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_app&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;app_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;notify_status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)
  INDEX &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_time&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)),
ENGINE &lt;span class="pl-k"&gt;=&lt;/span&gt; InnoDB
DEFAULT CHARACTER &lt;span class="pl-k"&gt;SET&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; utf8mb4
COMMENT &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;支付调用方记录&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;


&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; -----------------------------------------------------&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; Table 退款&lt;/span&gt;
&lt;span class="pl-c"&gt;&lt;span class="pl-c"&gt;--&lt;/span&gt; -----------------------------------------------------&lt;/span&gt;
&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; &lt;span class="pl-en"&gt;IF&lt;/span&gt; NOT EXISTS &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pay_refund&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;BIGINT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; AUTO_INCREMENT,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;app_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;应用id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;app_refund_no&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;上游的退款id&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;transaction_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;交易号&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;trade_no&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;第三方交易号&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;refund_no&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;支付平台生成的唯一退款单号&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pay_method_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;支付方式&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;pay_channel&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;64&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;选择的支付渠道，比如：支付宝中的花呗、信用卡等&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;refund_fee&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;退款金额&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;scale&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; TINYINT UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;小数位数&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;refund_reason&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;VARCHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;128&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;退款理由&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;currency_code&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;CHAR&lt;/span&gt;(&lt;span class="pl-c1"&gt;3&lt;/span&gt;) &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;CNY&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;币种，CNY  USD HKD&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;refund_type&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; TINYINT UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;退款类型；0:业务退款; 1:重复退款&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;refund_method&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; TINYINT UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;1&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;退款方式：1自动原路返回; 2人工打款&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;refund_status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; TINYINT UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;0未退款; 1退款处理中; 2退款成功; 3退款不成功&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;创建时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;更新时间&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_ip&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;请求源ip&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;update_ip&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class="pl-k"&gt;INT&lt;/span&gt; UNSIGNED &lt;span class="pl-k"&gt;NOT NULL&lt;/span&gt; DEFAULT &lt;span class="pl-c1"&gt;0&lt;/span&gt; COMMENT &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;请求源ip&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;,
  &lt;span class="pl-k"&gt;PRIMARY KEY&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  UNIQUE INDEX &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;uniq_refno&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;refund_no&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  INDEX &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_trad&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;transaction_id&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  INDEX &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;refund_status&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;),
  INDEX &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;idx_ctime&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt; (&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;`&lt;/span&gt;create_at&lt;span class="pl-pds"&gt;`&lt;/span&gt;&lt;/span&gt;)),
ENGINE &lt;span class="pl-k"&gt;=&lt;/span&gt; InnoDB
DEFAULT CHARACTER &lt;span class="pl-k"&gt;SET&lt;/span&gt; &lt;span class="pl-k"&gt;=&lt;/span&gt; utf8mb4
COMMENT &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;退款记录&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;表的使用逻辑进行下方简单描述：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;支付&lt;/strong&gt;，首先需要记录请求日志到 &lt;code&gt;pay_log_data&lt;/code&gt;中，然后生成交易数据记录到 &lt;code&gt;pay_transaction&lt;/code&gt;与&lt;code&gt;pay_transaction_extension&lt;/code&gt; 中。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;收到通知&lt;/strong&gt;，记录数据到 &lt;code&gt;pay_log_data&lt;/code&gt; 中，然后根据时支付的通知还是退款的通知，更新 &lt;code&gt;pay_transaction&lt;/code&gt; 与 &lt;code&gt;pay_refund&lt;/code&gt; 的状态。如果是重复支付需要记录数据到 &lt;code&gt;pay_repeat_transaction&lt;/code&gt; 中。并且将需要通知应用的数据记录到 &lt;code&gt;pay_notify_app_log&lt;/code&gt;，这张表相当于一个消息表，会有消费者会去消费其中的内容。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;退款&lt;/strong&gt; 记录日志日志到 &lt;code&gt;pay_log_data&lt;/code&gt; 中，然后记录数据到退款表中 &lt;code&gt;pay_refund&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;当然这其中还有些细节，需要大家自己看了表结构，实际去思考一下该如何使用。如果有任何疑问欢迎到我们GitHub的项目（点击阅读原文）中留言，我们都会一一解答。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;这些表能够满足最基本的需求，其它内容可根据自己的需求进行扩张，比如：支持用户卡列表、退款走银行卡等。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;&lt;a id="user-content-系统设计" class="anchor" aria-hidden="true" href="#系统设计"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;系统设计&lt;/h3&gt;
&lt;p&gt;这部分主要说下系统该如何搭建，以及代码组织方式的建议。&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-系统架构" class="anchor" aria-hidden="true" href="#系统架构"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;系统架构&lt;/h4&gt;
&lt;p&gt;由于支付系统的安全性非常高，因此不建议将对应的入口直接暴露给用户可见。应该是在自己的应用系统中调用支付系统的接口来完成业务。另外系统对数据要求是：强一致性的。因此也没有缓存介入（当如缓存可以用来做报警，这不在本文范畴）。&lt;/p&gt;
&lt;p&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/5a466c0998f954603bca19e5c41c71340850dd00/68747470733a2f2f6461797574616c6b2e636e2f696d672f696d6167652d32303139303330393133353830303634332e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/5a466c0998f954603bca19e5c41c71340850dd00/68747470733a2f2f6461797574616c6b2e636e2f696d672f696d6167652d32303139303330393133353830303634332e706e67" alt="image-20190309135800643" data-canonical-src="https://dayutalk.cn/img/image-20190309135800643.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;具体的实现，系统会使用两个域名，一个为内部使用，只有指定来源的ip能够访问固定功能（访问除通知外的其它功能）。另一个域名只能访问 &lt;code&gt;notify&lt;/code&gt; &lt;code&gt;return&lt;/code&gt; 两个路由。通过这种方式可以保证系统的安全。&lt;/p&gt;
&lt;p&gt;在数据库的使用上无论什么请求直接走 &lt;strong&gt;Master&lt;/strong&gt; 库。这样保证数据的强一致。当然从库也是需要的。比如：账单、对账相关逻辑我们可以利用从库完成。&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-代码设计" class="anchor" aria-hidden="true" href="#代码设计"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;代码设计&lt;/h4&gt;
&lt;p&gt;不管想做什么最终都要用代码来实现。我们都知道需要可维护、可扩展的代码。那么具体到支付系统你会怎么做呢？我已支付为例说下我的代码结构设计思路。仅供参考。比如我要介入：微信、支付宝、招行 三家支付。我的代码结构图如下：&lt;/p&gt;
&lt;p&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/b438f5dcf0f3e4730e8a67c7aa06996b13c940e6/68747470733a2f2f6461797574616c6b2e636e2f696d672f696d6167652d32303139303330393134323932353439392e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/b438f5dcf0f3e4730e8a67c7aa06996b13c940e6/68747470733a2f2f6461797574616c6b2e636e2f696d672f696d6167652d32303139303330393134323932353439392e706e67" alt="image-20190309142925499" data-canonical-src="https://dayutalk.cn/img/image-20190309142925499.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;用文字简单介绍下。我会将每一个第三方封装成： &lt;code&gt;XXXGateway&lt;/code&gt; 类，内部是单纯的封装第三方接口，不管对方是 HTTP 请求还是 SOAP 请求，都在内部进行统一处理。&lt;/p&gt;
&lt;p&gt;另外有一层&lt;code&gt;XXXProxy&lt;/code&gt; 来封装这些第三方提供的能力。这一层主要干两件事情：对传过来请求支付的数据进行个性化处理。对返回的结构进行统一处理返回上层统一的结构。当然根据特殊情况这里可以进行一切业务处理；&lt;/p&gt;
&lt;p&gt;通过上面的操作变化已经基本上被完全封装了。如果新增一个支付渠道。只需要增加：&lt;code&gt;XXXGateway &lt;/code&gt; 与 &lt;code&gt;XXXProxy&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;那么 &lt;code&gt;Context&lt;/code&gt; 与 &lt;code&gt;Server&lt;/code&gt; 有什么用呢？&lt;code&gt;Server&lt;/code&gt; 内部封装了所有的业务逻辑，它提供接口给 action 或者其它 server 进行调用。而 &lt;code&gt;Context&lt;/code&gt; 这一层存在的价值是处理 &lt;code&gt;Proxy&lt;/code&gt; 层返回的错误。以及在这里进行报警相关的处理。&lt;/p&gt;
&lt;p&gt;上面的结构只是我的一个实践，欢迎大家讨论。&lt;/p&gt;
&lt;p&gt;本文描述的系统只是满足了最基本的支付需求。缺少相关的监控、报警。如果你按照上文设计自己的系统，风险自担与我无关。&lt;/p&gt;
&lt;h1&gt;&lt;a id="user-content-订单中心" class="anchor" aria-hidden="true" href="#订单中心"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;订单中心&lt;/h1&gt;
&lt;p&gt;请您耐心等待...&lt;/p&gt;
&lt;h1&gt;&lt;a id="user-content-仓储系统" class="anchor" aria-hidden="true" href="#仓储系统"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;仓储系统&lt;/h1&gt;
&lt;p&gt;请您耐心等待...&lt;/p&gt;
&lt;h1&gt;&lt;a id="user-content-物流系统" class="anchor" aria-hidden="true" href="#物流系统"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;物流系统&lt;/h1&gt;
&lt;p&gt;请您耐心等待...&lt;/p&gt;
&lt;h1&gt;&lt;a id="user-content-售后服务" class="anchor" aria-hidden="true" href="#售后服务"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;售后服务&lt;/h1&gt;
&lt;p&gt;请您耐心等待...&lt;/p&gt;
&lt;h1&gt;&lt;a id="user-content-基础服务" class="anchor" aria-hidden="true" href="#基础服务"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;基础服务&lt;/h1&gt;
&lt;p&gt;请您耐心等待...&lt;/p&gt;
&lt;h5&gt;&lt;a id="user-content-skrshop项目成员简介" class="anchor" aria-hidden="true" href="#skrshop项目成员简介"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;SkrShop项目成员简介&lt;/h5&gt;
&lt;p&gt;排名不分先后，字典序&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;昵称&lt;/th&gt;
&lt;th&gt;简介&lt;/th&gt;
&lt;th&gt;个人博客&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;AStraw&lt;/td&gt;
&lt;td&gt;研究生创业者&lt;/td&gt;
&lt;td&gt;--------&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;大愚Dayu&lt;/td&gt;
&lt;td&gt;国内大多人使用的PHP第三方支付聚合项目&lt;a href="https://github.com/helei112g/payment"&gt;Payment&lt;/a&gt;作者，创过业&lt;/td&gt;
&lt;td&gt;&lt;a href="http://dayutalk.cn/" rel="nofollow"&gt;大愚Talk&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;lwhcv&lt;/td&gt;
&lt;td&gt;曾就职于百度/融360&lt;/td&gt;
&lt;td&gt;--------&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;TIGERB&lt;/td&gt;
&lt;td&gt;PHP框架&lt;a href="http://easy-php.tigerb.cn/#/" rel="nofollow"&gt;EasyPHP&lt;/a&gt;作者&lt;/td&gt;
&lt;td&gt;&lt;a href="http://tigerb.cn" rel="nofollow"&gt;TIGERB的技术博客&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Veaer&lt;/td&gt;
&lt;td&gt;宇宙无敌风火轮全干工程师&lt;/td&gt;
&lt;td&gt;&lt;a href="https://github.com/Veaer"&gt;Veaer&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/article&gt;&lt;/div&gt;</description><author>skr-shop</author><guid isPermaLink="false">https://github.com/skr-shop/manuals</guid><pubDate>Sat, 04 Jan 2020 00:01:00 GMT</pubDate></item><item><title>BrentOzarULTD/SQL-Server-First-Responder-Kit #2 in TSQL, This week</title><link>https://github.com/BrentOzarULTD/SQL-Server-First-Responder-Kit</link><description>&lt;p&gt;&lt;i&gt;sp_Blitz, sp_BlitzCache, sp_BlitzFirst, sp_BlitzIndex, and other SQL Server scripts for health checks and performance tuning.&lt;/i&gt;&lt;/p&gt;&lt;div id="readme" class="md" data-path="README.md"&gt;&lt;article class="markdown-body entry-content p-5" itemprop="text"&gt;&lt;h1&gt;&lt;a id="user-content-sql-server-first-responder-kit" class="anchor" aria-hidden="true" href="#sql-server-first-responder-kit"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;SQL Server First Responder Kit&lt;/h1&gt;
&lt;p&gt;&lt;a name="user-content-header1"&gt;&lt;/a&gt;
&lt;a href="https://github.com/BrentOzarULTD/SQL-Server-First-Responder-Kit/blob/master/LICENSE.md"&gt;&lt;img src="https://camo.githubusercontent.com/890acbdcb87868b382af9a4b1fac507b9659d9bf/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d626c75652e737667" alt="licence badge" data-canonical-src="https://img.shields.io/badge/license-MIT-blue.svg" style="max-width:100%;"&gt;&lt;/a&gt;
&lt;a href="https://github.com/BrentOzarULTD/SQL-Server-First-Responder-Kit/stargazers"&gt;&lt;img src="https://camo.githubusercontent.com/48e714d6a304efa786cf7baba39dfd1a6f48d8b0/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f73746172732f4272656e744f7a6172554c54442f53514c2d5365727665722d46697273742d526573706f6e6465722d4b69742e737667" alt="stars badge" data-canonical-src="https://img.shields.io/github/stars/BrentOzarULTD/SQL-Server-First-Responder-Kit.svg" style="max-width:100%;"&gt;&lt;/a&gt;
&lt;a href="https://github.com/BrentOzarULTD/SQL-Server-First-Responder-Kit/network"&gt;&lt;img src="https://camo.githubusercontent.com/0f6baf2b4e78d3b941025d29e8280c7e07090aaa/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f666f726b732f4272656e744f7a6172554c54442f53514c2d5365727665722d46697273742d526573706f6e6465722d4b69742e737667" alt="forks badge" data-canonical-src="https://img.shields.io/github/forks/BrentOzarULTD/SQL-Server-First-Responder-Kit.svg" style="max-width:100%;"&gt;&lt;/a&gt;
&lt;a href="https://github.com/BrentOzarULTD/SQL-Server-First-Responder-Kit/issues"&gt;&lt;img src="https://camo.githubusercontent.com/421930857408b0140d5439cdbc023ecfa444f834/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6973737565732f4272656e744f7a6172554c54442f53514c2d5365727665722d46697273742d526573706f6e6465722d4b69742e737667" alt="issues badge" data-canonical-src="https://img.shields.io/github/issues/BrentOzarULTD/SQL-Server-First-Responder-Kit.svg" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Navigation&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#how-to-get-support"&gt;How to Get Support&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Common Scripts:
&lt;ul&gt;
&lt;li&gt;&lt;a href="#sp_blitz-overall-health-check"&gt;sp_Blitz: Overall Health Check&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#advanced-sp_blitz-parameters"&gt;Advanced sp_Blitz Parameters&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#writing-sp_blitz-output-to-a-table"&gt;Writing sp_Blitz Output to a Table&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#skipping-checks-or-databases"&gt;Skipping Checks or Databases&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#sp_blitzcache-find-the-most-resource-intensive-queries"&gt;sp_BlitzCache: Find the Most Resource-Intensive Queries&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#advanced-sp_blitzcache-parameters"&gt;Advanced sp_BlitzCache Parameters&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#sp_blitzfirst-real-time-performance-advice"&gt;sp_BlitzFirst: Real-Time Performance Advice&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#sp_blitzindex-tune-your-indexes"&gt;sp_BlitzIndex: Tune Your Indexes&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#advanced-sp_blitzindex-parameters"&gt;Advanced sp_BlitzIndex Parameters&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Performance Tuning:
&lt;ul&gt;
&lt;li&gt;&lt;a href="#sp_blitzinmemoryoltp-hekaton-analysis"&gt;sp_BlitzInMemoryOLTP: Hekaton Analysis&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#sp_blitzlock-deadlock-analysis"&gt;sp_BlitzLock: Deadlock Analysis&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#sp_blitzquerystore-query-store-sale"&gt;sp_BlitzQueryStore: Like BlitzCache, for Query Store&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#sp_blitzwho-what-queries-are-running-now"&gt;sp_BlitzWho: What Queries are Running Now&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Backups and Restores:
&lt;ul&gt;
&lt;li&gt;&lt;a href="#sp_blitzbackups-how-much-data-could-you-lose"&gt;sp_BlitzBackups: How Much Data Could You Lose&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#sp_allnightlog-back-up-faster-to-lose-less-data"&gt;sp_AllNightLog: Back Up Faster to Lose Less Data&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#sp_databaserestore-easier-multi-file-restores"&gt;sp_DatabaseRestore: Easier Multi-File Restores&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#parameters-common-to-many-of-the-stored-procedures"&gt;Parameters Common to Many of the Stored Procedures&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#license"&gt;License MIT&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You're a DBA, sysadmin, or developer who manages Microsoft SQL Servers. It's your fault if they're down or slow. These tools help you understand what's going on in your server.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;When you want an overall health check, run &lt;a href="#sp_blitz-overall-health-check"&gt;sp_Blitz&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;To learn which queries have been using the most resources, run &lt;a href="#sp_blitzcache-find-the-most-resource-intensive-queries"&gt;sp_BlitzCache&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;To analyze which indexes are missing or slowing you down, run &lt;a href="#sp_blitzindex-tune-your-indexes"&gt;sp_BlitzIndex&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;To find out why the server is slow right now, run &lt;a href="#sp_blitzfirst-real-time-performance-advice"&gt;sp_BlitzFirst&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To install, &lt;a href="https://github.com/BrentOzarULTD/SQL-Server-First-Responder-Kit/releases"&gt;download the latest release ZIP&lt;/a&gt;, then run the SQL files in the master database. (You can use other databases if you prefer.)&lt;/p&gt;
&lt;p&gt;The First Responder Kit runs on:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SQL Server 2008, 2008R2, 2012, 2014, 2016, 2017 on Windows - yes, fully supported&lt;/li&gt;
&lt;li&gt;SQL Server 2017 on Linux - yes, fully supported except sp_AllNightLog and sp_DatabaseRestore, which require xp_cmdshell, which Microsoft doesn't provide on Linux&lt;/li&gt;
&lt;li&gt;SQL Server 2000, 2005 - not supported by Microsoft anymore, so we don't either&lt;/li&gt;
&lt;li&gt;Amazon RDS SQL Server - fully supported&lt;/li&gt;
&lt;li&gt;Azure SQL DB - It's a dice roll. Microsoft changes DMV contents in here without warning, so no guarantees.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;&lt;a id="user-content-how-to-get-support" class="anchor" aria-hidden="true" href="#how-to-get-support"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;How to Get Support&lt;/h2&gt;
&lt;p&gt;Everyone here is expected to abide by the &lt;a href="CONTRIBUTING.md#the-contributor-covenant-code-of-conduct"&gt;Contributor Covenant Code of Conduct&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;When you have questions about how the tools work, talk with the community in the &lt;a href="https://sqlcommunity.slack.com/messages/firstresponderkit/" rel="nofollow"&gt;#FirstResponderKit Slack channel&lt;/a&gt;. If you need a free invite, hit &lt;a href="http://SQLslack.com/" rel="nofollow"&gt;SQLslack.com&lt;/a&gt;. Be patient - it's staffed with volunteers who have day jobs, heh.&lt;/p&gt;
&lt;p&gt;When you find a bug or want something changed, &lt;a href="CONTRIBUTING.md"&gt;read the contributing.md file&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;When you have a question about what the scripts found, first make sure you read the "More Details" URL for any warning you find. We put a lot of work into documentation, and we wouldn't want someone to yell at you to go read the fine manual. After that, when you've still got questions about how something works in SQL Server, post a question at &lt;a href="http://dba.stackexchange.com" rel="nofollow"&gt;DBA.StackExchange.com&lt;/a&gt; and the community (that includes us!) will help. Include exact errors and any applicable screenshots, your SQL Server version number (including the build #), and the version of the tool you're working with.&lt;/p&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-sp_blitz-overall-health-check" class="anchor" aria-hidden="true" href="#sp_blitz-overall-health-check"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;sp_Blitz: Overall Health Check&lt;/h2&gt;
&lt;p&gt;Run sp_Blitz daily or weekly for an overall health check. Just run it from SQL Server Management Studio, and you'll get a prioritized list of issues on your server right now:&lt;/p&gt;
&lt;p&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/d7617f402a424f7f3a0997662263db708c2e7830/687474703a2f2f752e6272656e746f7a61722e636f6d2f6769746875622d696d616765732f73705f426c69747a2e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/d7617f402a424f7f3a0997662263db708c2e7830/687474703a2f2f752e6272656e746f7a61722e636f6d2f6769746875622d696d616765732f73705f426c69747a2e706e67" alt="sp_Blitz" data-canonical-src="http://u.brentozar.com/github-images/sp_Blitz.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Output columns include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Priority - 1 is the most urgent, stuff that could get you fired. The warnings get progressively less urgent.&lt;/li&gt;
&lt;li&gt;FindingsGroup, Findings - describe the problem sp_Blitz found on the server.&lt;/li&gt;
&lt;li&gt;DatabaseName - the database having the problem. If it's null, it's a server-wide problem.&lt;/li&gt;
&lt;li&gt;URL - copy/paste this into a browser for more information.&lt;/li&gt;
&lt;li&gt;Details - not just bland text, but dynamically generated stuff with more info.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Commonly used parameters:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@CheckUserDatabaseObjects = 0 - by default, we check inside user databases for things like triggers or heaps. Turn this off (0) to make checks go faster, or ignore stuff you can't fix if you're managing third party databases. If a server has 50+ databases, @CheckUserDatabaseObjects is automatically turned off unless...&lt;/li&gt;
&lt;li&gt;@BringThePain = 1 - required if you want to run @CheckUserDatabaseObjects = 1 with over 50 databases. It's gonna be slow.&lt;/li&gt;
&lt;li&gt;@CheckServerInfo = 1 - includes additional rows at priority 250 with server configuration details like service accounts.&lt;/li&gt;
&lt;li&gt;@IgnorePrioritiesAbove = 50 - if you want a daily bulletin of the most important warnings, set @IgnorePrioritiesAbove = 50 to only get the urgent stuff.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-advanced-sp_blitz-parameters" class="anchor" aria-hidden="true" href="#advanced-sp_blitz-parameters"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Advanced sp_Blitz Parameters&lt;/h3&gt;
&lt;p&gt;In addition to the &lt;a href="#parameters-common-to-many-of-the-stored-procedures"&gt;parameters common to many of the stored procedures&lt;/a&gt;, here are the ones specific to sp_Blitz:&lt;/p&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-writing-sp_blitz-output-to-a-table" class="anchor" aria-hidden="true" href="#writing-sp_blitz-output-to-a-table"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Writing sp_Blitz Output to a Table&lt;/h4&gt;
&lt;div class="highlight highlight-source-sql"&gt;&lt;pre&gt;sp_Blitz @OutputDatabaseName &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;DBAtools&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;, @OutputSchemaName &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;dbo&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;, @OutputTableName &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;BlitzResults&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Checks for the existence of a table DBAtools.dbo.BlitzResults, creates it if necessary, then adds the output of sp_Blitz into this table. This table is designed to support multiple outputs from multiple servers, so you can track your server's configuration history over time.&lt;/p&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-skipping-checks-or-databases" class="anchor" aria-hidden="true" href="#skipping-checks-or-databases"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Skipping Checks or Databases&lt;/h4&gt;
&lt;div class="highlight highlight-source-sql"&gt;&lt;pre&gt;&lt;span class="pl-k"&gt;CREATE&lt;/span&gt; &lt;span class="pl-k"&gt;TABLE&lt;/span&gt; &lt;span class="pl-en"&gt;dbo&lt;/span&gt;.BlitzChecksToSkip (
ServerName NVARCHAR(&lt;span class="pl-c1"&gt;128&lt;/span&gt;),
DatabaseName NVARCHAR(&lt;span class="pl-c1"&gt;128&lt;/span&gt;),
CheckID &lt;span class="pl-k"&gt;INT&lt;/span&gt;
);
GO
&lt;span class="pl-k"&gt;INSERT INTO&lt;/span&gt; &lt;span class="pl-c1"&gt;dbo&lt;/span&gt;.&lt;span class="pl-c1"&gt;BlitzChecksToSkip&lt;/span&gt; (ServerName, DatabaseName, CheckID)
&lt;span class="pl-k"&gt;VALUES&lt;/span&gt; (&lt;span class="pl-k"&gt;NULL&lt;/span&gt;, &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;SalesDB&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;, &lt;span class="pl-c1"&gt;50&lt;/span&gt;)
sp_Blitz @SkipChecksDatabase &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;DBAtools&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;, @SkipChecksSchema &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;dbo&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;, @SkipChecksTable &lt;span class="pl-k"&gt;=&lt;/span&gt; &lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;'&lt;/span&gt;BlitzChecksToSkip&lt;span class="pl-pds"&gt;'&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Checks for the existence of a table named Fred - just kidding, named DBAtools.dbo.BlitzChecksToSkip. The table needs at least the columns shown above (ServerName, DatabaseName, and CheckID). For each row:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;If the DatabaseName is populated but CheckID is null, then all checks will be skipped for that database&lt;/li&gt;
&lt;li&gt;If both DatabaseName and CheckID are populated, then that check will be skipped for that database&lt;/li&gt;
&lt;li&gt;If CheckID is populated but DatabaseName is null, then that check will be skipped for all databases&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-sp_blitzcache-find-the-most-resource-intensive-queries" class="anchor" aria-hidden="true" href="#sp_blitzcache-find-the-most-resource-intensive-queries"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;sp_BlitzCache: Find the Most Resource-Intensive Queries&lt;/h2&gt;
&lt;p&gt;sp_BlitzCache looks at your plan cache where SQL Server keeps track of which queries have run recently, and how much impact they've had on the server.&lt;/p&gt;
&lt;p&gt;By default, it includes two result sets:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The first result set shows your 10 most resource-intensive queries.&lt;/li&gt;
&lt;li&gt;The second result set explains the contents of the Warnings column - but it only shows the warnings that were produced in the first result set. (It's kinda like the most relevant glossary of execution plan terms.)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Output columns include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Database - the database context where the query ran. Keep in mind that if you fully qualify your object names, the same query might be run from multiple databases.&lt;/li&gt;
&lt;li&gt;Cost - the Estimated Subtree Cost of the query, what Kendra Little calls "Query Bucks."&lt;/li&gt;
&lt;li&gt;Query Text - don't copy/paste from here - it's only a quick reference. A better source for the query will show up later on.&lt;/li&gt;
&lt;li&gt;Warnings - problems we found.&lt;/li&gt;
&lt;li&gt;Created At - when the plan showed up in the cache.&lt;/li&gt;
&lt;li&gt;Last Execution - maybe the query only runs at night.&lt;/li&gt;
&lt;li&gt;Query Plan - click on this, and the graphical plan pops up.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;&lt;a id="user-content-common-sp_blitzcache-parameters" class="anchor" aria-hidden="true" href="#common-sp_blitzcache-parameters"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Common sp_BlitzCache Parameters&lt;/h3&gt;
&lt;p&gt;The @SortOrder parameter lets you pick which top 10 queries you want to examine:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;reads - logical reads&lt;/li&gt;
&lt;li&gt;CPU - from total_worker_time in sys.dm_exec_query_stats&lt;/li&gt;
&lt;li&gt;executions - how many times the query ran since the CreationDate&lt;/li&gt;
&lt;li&gt;xpm - executions per minute, derived from the CreationDate and LastExecution&lt;/li&gt;
&lt;li&gt;recent compilations - if you're looking for things that are recompiling a lot&lt;/li&gt;
&lt;li&gt;memory grant - if you're troubleshooting a RESOURCE_SEMAPHORE issue and want to find queries getting a lot of memory&lt;/li&gt;
&lt;li&gt;writes - if you wanna find those pesky ETL processes&lt;/li&gt;
&lt;li&gt;You can also use average or avg for a lot of the sorts, like @SortOrder = 'avg reads'&lt;/li&gt;
&lt;li&gt;all - sorts by all the different sort order options, and returns a single result set of hot messes. This is a little tricky because:&lt;/li&gt;
&lt;li&gt;We find the @Top N queries by CPU, then by reads, then writes, duration, executions, memory grant, spills, etc. If you want to set @Top &amp;gt; 10, you also have to set @BringThePain = 1 to make sure you understand that it can be pretty slow.&lt;/li&gt;
&lt;li&gt;As we work through each pattern, we exclude the results from the prior patterns. So for example, we get the top 10 by CPU, and then when we go to get the top 10 by reads, we exclude queries that were already found in the top 10 by CPU. As a result, the top 10 by reads may not really be the top 10 by reads - because some of those might have been in the top 10 by CPU.&lt;/li&gt;
&lt;li&gt;To make things even a little more confusing, in the Pattern column of the output, we only specify the first pattern that matched, not all of the patterns that matched. It would be cool if at some point in the future, we turned this into a comma-delimited list of patterns that a query matched, and then we'd be able to get down to a tighter list of top queries. For now, though, this is kinda unscientific.&lt;/li&gt;
&lt;li&gt;query hash - filters for only queries that have multiple cached plans (even though they may all still be the same plan, just different copies stored.) If you use @SortOrder = 'query hash', you can specify a second sort order with a comma, like 'query hash, reads' in order to find only queries with multiple plans, sorted by the ones doing the most reads. The default second sort is CPU.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Other common parameters include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@Top = 10 - by default, you get 10 plans, but you can ask for more. Just know that the more you get, the slower it goes.&lt;/li&gt;
&lt;li&gt;@ExportToExcel = 1 - turn this on, and it doesn't return XML fields that would hinder you from copy/pasting the data into Excel.&lt;/li&gt;
&lt;li&gt;@ExpertMode = 1 - turn this on, and you get more columns with more data. Doesn't take longer to run though.&lt;/li&gt;
&lt;li&gt;@IgnoreSystemDBs = 0 - if you want to show queries in master/model/msdb. By default we hide these.&lt;/li&gt;
&lt;li&gt;@MinimumExecutionCount = 0 - in servers like data warehouses where lots of queries only run a few times, you can set a floor number for examination.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-advanced-sp_blitzcache-parameters" class="anchor" aria-hidden="true" href="#advanced-sp_blitzcache-parameters"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Advanced sp_BlitzCache Parameters&lt;/h3&gt;
&lt;p&gt;In addition to the &lt;a href="#parameters-common-to-many-of-the-stored-procedures"&gt;parameters common to many of the stored procedures&lt;/a&gt;, here are the ones specific to sp_BlitzCache:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;OnlyQueryHashes - if you want to examine specific query plans, you can pass in a comma-separated list of them in a string.&lt;/li&gt;
&lt;li&gt;IgnoreQueryHashes - if you know some queries suck and you don't want to see them, you can pass in a comma-separated list of them.&lt;/li&gt;
&lt;li&gt;OnlySqlHandles, @IgnoreSqlHandles - just like the above two params&lt;/li&gt;
&lt;li&gt;@DatabaseName - if you only want to analyze plans in a single database. However, keep in mind that this is only the database context. A single query that runs in Database1 can join across objects in Database2 and Database3, but we can only know that it ran in Database1.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-sp_blitzfirst-real-time-performance-advice" class="anchor" aria-hidden="true" href="#sp_blitzfirst-real-time-performance-advice"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;sp_BlitzFirst: Real-Time Performance Advice&lt;/h2&gt;
&lt;p&gt;When performance emergencies strike, this should be the first stored proc in the kit you run.&lt;/p&gt;
&lt;p&gt;It takes a sample from a bunch of DMVs (wait stats, Perfmon counters, plan cache), waits 5 seconds, and then takes another sample. It examines the differences between the samples, and then gives you a prioritized list of things that might be causing performance issues right now. Examples include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Data or log file growing (or heaven forbid, shrinking)&lt;/li&gt;
&lt;li&gt;Backup or restore running&lt;/li&gt;
&lt;li&gt;DBCC operation happening&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If no problems are found, it'll tell you that too. That's one of our favorite features because you can have your help desk team run sp_BlitzFirst and read the output to you over the phone. If no problems are found, you can keep right on drinking at the bar. (Ha! Just kidding, you'll still have to close out your tab, but at least you'll feel better about finishing that drink rather than trying to sober up.)&lt;/p&gt;
&lt;p&gt;Common sp_BlitzFirst parameters include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@Seconds = 5 by default. You can specify longer samples if you want to track stats during a load test or demo, for example.&lt;/li&gt;
&lt;li&gt;@ShowSleepingSPIDs = 0 by default. When set to 1, shows long-running sleeping queries that might be blocking others.&lt;/li&gt;
&lt;li&gt;@ExpertMode = 0 by default. When set to 1, it calls sp_BlitzWho when it starts (to show you what queries are running right now), plus outputs additional result sets for wait stats, Perfmon counters, and file stats during the sample, then finishes with one final execution of sp_BlitzWho to show you what was running at the end of the sample.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;&lt;a id="user-content-logging-sp_blitzfirst-to-tables" class="anchor" aria-hidden="true" href="#logging-sp_blitzfirst-to-tables"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Logging sp_BlitzFirst to Tables&lt;/h3&gt;
&lt;p&gt;You can log sp_BlitzFirst performance data to tables and then analyze the results with the Power BI dashboard. To do it, schedule an Agent job to run sp_BlitzFirst every 15 minutes with these parameters populated:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@OutputDatabaseName = typically 'DBAtools'&lt;/li&gt;
&lt;li&gt;@OutputSchemaName = 'dbo'&lt;/li&gt;
&lt;li&gt;@OutputTableName = 'BlitzFirst' - the quick diagnosis result set goes here&lt;/li&gt;
&lt;li&gt;@OutputTableNameFileStats = 'BlitzFirst_FileStats'&lt;/li&gt;
&lt;li&gt;@OutputTableNamePerfmonStats = 'BlitzFirst_PerfmonStats'&lt;/li&gt;
&lt;li&gt;@OutputTableNameWaitStats = 'BlitzFirst_WaitStats'&lt;/li&gt;
&lt;li&gt;@OutputTableNameBlitzCache = 'BlitzCache'&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;All of the above OutputTableName parameters are optional: if you don't want to collect all of the stats, you don't have to. Keep in mind that the sp_BlitzCache results will get large, fast, because each execution plan is megabytes in size.&lt;/p&gt;
&lt;p&gt;Then fire up the &lt;a href="https://www.brentozar.com/first-aid/first-responder-kit-power-bi-dashboard/" rel="nofollow"&gt;First Responder Kit Power BI dashboard.&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-logging-performance-tuning-activities" class="anchor" aria-hidden="true" href="#logging-performance-tuning-activities"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Logging Performance Tuning Activities&lt;/h3&gt;
&lt;p&gt;On the Power BI Dashboard, you can show lines for your own activities like tuning queries, adding indexes, or changing configuration settings. To do it, run sp_BlitzFirst with these parameters:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@OutputDatabaseName = typically 'DBAtools'&lt;/li&gt;
&lt;li&gt;@OutputSchemaName = 'dbo'&lt;/li&gt;
&lt;li&gt;@OutputTableName = 'BlitzFirst' - the quick diagnosis result set goes here&lt;/li&gt;
&lt;li&gt;@LogMessage = 'Whatever you wanna show in the Power BI dashboard'&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Optionally, you can also pass in:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@LogMessagePriority = 1&lt;/li&gt;
&lt;li&gt;@LogMessageFindingsGroup = 'Logged Message'&lt;/li&gt;
&lt;li&gt;@LogMessageFinding = 'Logged from sp_BlitzFirst' - you could use other values here to track other data sources like DDL triggers, Agent jobs, ETL jobs&lt;/li&gt;
&lt;li&gt;@LogMessageURL = '&lt;a href="https://OurHelpDeskSystem/ticket/?12345" rel="nofollow"&gt;https://OurHelpDeskSystem/ticket/?12345&lt;/a&gt;' - or maybe a Github issue, or Pagerduty alert&lt;/li&gt;
&lt;li&gt;@LogMessageCheckDate = '2017/10/31 11:00' - in case you need to log a message for a prior date/time, like if you forgot to log the message earlier&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-sp_blitzindex-tune-your-indexes" class="anchor" aria-hidden="true" href="#sp_blitzindex-tune-your-indexes"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;sp_BlitzIndex: Tune Your Indexes&lt;/h2&gt;
&lt;p&gt;SQL Server tracks your indexes: how big they are, how often they change, whether they're used to make queries go faster, and which indexes you should consider adding. The results columns are fairly self-explanatory.&lt;/p&gt;
&lt;p&gt;By default, sp_BlitzIndex analyzes the indexes of the database you're in (your current context.)&lt;/p&gt;
&lt;p&gt;Common parameters include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@DatabaseName - if you want to analyze a specific database&lt;/li&gt;
&lt;li&gt;@SchemaName, @TableName - if you pass in these, sp_BlitzIndex does a deeper-dive analysis of just one table. You get several result sets back describing more information about the table's current indexes, foreign key relationships, missing indexes, and fields in the table.&lt;/li&gt;
&lt;li&gt;@GetAllDatabases = 1 - slower, but lets you analyze all the databases at once, up to 50. If you want more than 50 databases, you also have to pass in @BringThePain = 1.&lt;/li&gt;
&lt;li&gt;@ThresholdMB = 250 - by default, we only analyze objects over 250MB because you're busy.&lt;/li&gt;
&lt;li&gt;@Mode = 0 (default) - get different data with 0=Diagnose, 1=Summarize, 2=Index Usage Detail, 3=Missing Index Detail, 4=Diagnose Details.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-advanced-sp_blitzindex-parameters" class="anchor" aria-hidden="true" href="#advanced-sp_blitzindex-parameters"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Advanced sp_BlitzIndex Parameters&lt;/h3&gt;
&lt;p&gt;In addition to the &lt;a href="#parameters-common-to-many-of-the-stored-procedures"&gt;parameters common to many of the stored procedures&lt;/a&gt;, here are the ones specific to sp_BlitzIndex:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@SkipPartitions = 1 - add this if you want to analyze large partitioned tables. We skip these by default for performance reasons.&lt;/li&gt;
&lt;li&gt;@SkipStatistics = 0 - right now, by default, we skip statistics analysis because we've had some performance issues on this.&lt;/li&gt;
&lt;li&gt;@Filter = 0 (default) - 1=No low-usage warnings for objects with 0 reads. 2=Only warn for objects &amp;gt;= 500MB&lt;/li&gt;
&lt;li&gt;@OutputDatabaseName, @OutputSchemaName, @OutputTableName - these only work for @Mode = 2, index usage detail.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-sp_blitzinmemoryoltp-hekaton-analysis" class="anchor" aria-hidden="true" href="#sp_blitzinmemoryoltp-hekaton-analysis"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;sp_BlitzInMemoryOLTP: Hekaton Analysis&lt;/h2&gt;
&lt;p&gt;Examines your usage of In-Memory OLTP tables. Parameters you can use:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@instanceLevelOnly BIT: This flag determines whether or not to simply report on the server-level environment (if applicable, i.e. there is no server-level environment for Azure SQL Database). With this parameter, memory-optimized databases are ignored. If you specify @instanceLevelOnly and a database name, the database name is ignored.&lt;/li&gt;
&lt;li&gt;@dbName NVARCHAR(4000) = N'ALL' - If you don't specify a database name, then sp_BlitzInMemoryOLTP reports on all memory-optimized databases within the instance that it executes in, or in the case of Azure SQL Database, the database that you provisioned. This is because the default for the @dbName parameter is N'ALL'.&lt;/li&gt;
&lt;li&gt;@tableName NVARCHAR(4000) = NULL&lt;/li&gt;
&lt;li&gt;@debug BIT&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To interpret the output of this stored procedure, read &lt;a href="http://nedotter.com/archive/2018/06/new-kid-on-the-block-sp_blitzinmemoryoltp/" rel="nofollow"&gt;Ned Otter's sp_BlitzInMemoryOLTP documentation&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-sp_blitzlock-deadlock-analysis" class="anchor" aria-hidden="true" href="#sp_blitzlock-deadlock-analysis"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;sp_BlitzLock: Deadlock Analysis&lt;/h2&gt;
&lt;p&gt;Checks either the System Health session or a specific Extended Event session that captures deadlocks and parses out all the XML for you.&lt;/p&gt;
&lt;p&gt;Parameters you can use:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@Top: Use if you want to limit the number of deadlocks to return. This is ordered by event date ascending.&lt;/li&gt;
&lt;li&gt;@DatabaseName: If you want to filter to a specific database&lt;/li&gt;
&lt;li&gt;@StartDate: The date you want to start searching on.&lt;/li&gt;
&lt;li&gt;@EndDate: The date you want to stop searching on.&lt;/li&gt;
&lt;li&gt;@ObjectName: If you want to filter to a specific table. The object name has to be fully qualified 'Database.Schema.Table'&lt;/li&gt;
&lt;li&gt;@StoredProcName: If you want to search for a single stored proc.&lt;/li&gt;
&lt;li&gt;@AppName: If you want to filter to a specific application.&lt;/li&gt;
&lt;li&gt;@HostName: If you want to filter to a specific host.&lt;/li&gt;
&lt;li&gt;@LoginName: If you want to filter to a specific login.&lt;/li&gt;
&lt;li&gt;@EventSessionPath: If you want to point this at an XE session rather than the system health session.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-sp_blitzquerystore-query-store-sale" class="anchor" aria-hidden="true" href="#sp_blitzquerystore-query-store-sale"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;sp_BlitzQueryStore: Query Store Sale&lt;/h2&gt;
&lt;p&gt;Analyzes data in Query Store schema (2016+ only) in many similar ways to what sp_BlitzCache does for the plan cache.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@Help: Right now this just prints the license if set to 1. I'm going to add better documentation here as the script matures.&lt;/li&gt;
&lt;li&gt;@DatabaseName: This one is required. Query Store is per database, so you have to point it at one to examine.&lt;/li&gt;
&lt;li&gt;@Top: How many plans from each "worst" you want to get. We look at your maxes for CPU, reads, duration, writes, memory, rows, executions, and additionally tempdb and log bytes for 2017. So it's the number of plans from each of those to gather.&lt;/li&gt;
&lt;li&gt;@StartDate: Fairly obvious, when you want to start looking at queries from. If NULL, we'll only go back seven days.&lt;/li&gt;
&lt;li&gt;@EndDate: When you want to stop looking at queries from. If you leave it NULL, we'll look ahead seven days.&lt;/li&gt;
&lt;li&gt;@MinimumExecutionCount: The minimum number of times a query has to have been executed (not just compiled) to be analyzed.&lt;/li&gt;
&lt;li&gt;@DurationFilter: The minimum number of seconds a query has to have been executed for to be analyzed.&lt;/li&gt;
&lt;li&gt;@StoredProcName: If you want to look at a single stored procedure.&lt;/li&gt;
&lt;li&gt;@Failed: If you want to look at failed queries, for some reason. I dunno, MS made such a big deal out of being able to look at these, I figured I'd add it.&lt;/li&gt;
&lt;li&gt;@PlanIdFilter: If you want to filter by a particular plan id. Remember that a query may have many different plans.&lt;/li&gt;
&lt;li&gt;@QueryIdFilter: If you want to filter by a particular query id. If you want to look at one specific plan for a query.&lt;/li&gt;
&lt;li&gt;@ExportToExcel: Leaves XML out of the input and tidies up query text so you can easily paste it into Excel.&lt;/li&gt;
&lt;li&gt;@HideSummary: Pulls the rolled up warnings and information out of the results.&lt;/li&gt;
&lt;li&gt;@SkipXML: Skips XML analysis.&lt;/li&gt;
&lt;li&gt;@Debug: Prints dynamic SQL and selects data from all temp tables if set to 1.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-sp_blitzwho-what-queries-are-running-now" class="anchor" aria-hidden="true" href="#sp_blitzwho-what-queries-are-running-now"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;sp_BlitzWho: What Queries are Running Now&lt;/h2&gt;
&lt;p&gt;This is like sp_who, except it goes into way, way, way more details.&lt;/p&gt;
&lt;p&gt;It's designed for query tuners, so it includes things like memory grants, degrees of parallelism, and execution plans.&lt;/p&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-sp_blitzbackups-how-much-data-could-you-lose" class="anchor" aria-hidden="true" href="#sp_blitzbackups-how-much-data-could-you-lose"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;sp_BlitzBackups: How Much Data Could You Lose&lt;/h2&gt;
&lt;p&gt;Checks your backups and reports estimated RPO and RTO based on historical data in msdb, or a centralized location for [msdb].dbo.backupset.&lt;/p&gt;
&lt;p&gt;Parameters include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;@HoursBack -- How many hours into backup history you want to go. Should be a negative number (we're going back in time, after all). But if you enter a positive number, we'll make it negative for you. You're welcome.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;@MSDBName -- if you need to prefix dbo.backupset with an alternate database name.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;@AGName -- If you have more than 1 AG on the server, and you don't know the listener name, specify the name of the AG you want to use the listener for, to push backup data. This may get used during analysis in a future release for filtering.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;@RestoreSpeedFullMBps --[FIXFIX] Brent can word this better than I can&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;@RestoreSpeedDiffMBps -- Nothing yet&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;@RestoreSpeedLogMBps -- Nothing yet&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;@PushBackupHistoryToListener -- Turn this to 1 to skip analysis and use sp_BlitzBackups to push backup data from msdb to a centralized location (more the mechanics of this to follow)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;@WriteBackupsToListenerName -- This is the name of the AG listener, and &lt;strong&gt;MUST&lt;/strong&gt; have a linked server configured pointing to it. Yes, that means you need to create a linked server that points to the AG Listener, with the appropriate permissions to write data.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;@WriteBackupsToDatabaseName -- This can't be 'msdb' if you're going to use the backup data pushing mechanism. We can't write to your actual msdb tables.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;@WriteBackupsLastHours -- How many hours in the past you want to move data for. Should be a negative number (we're going back in time, after all). But if you enter a positive number, we'll make it negative for you. You're welcome.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;An example run of sp_BlitzBackups to push data looks like this:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;EXEC sp_BlitzBackups    @PushBackupHistoryToListener = 1, -- Turn it on!
                        @WriteBackupsToListenerName = 'AG_LISTENER_NAME', -- Name of AG Listener and Linked Server 
                        @WriteBackupsToDatabaseName = 'FAKE_MSDB_NAME',  -- Fake MSDB name you want to push to. Remember, can't be real MSDB.
                        @WriteBackupsLastHours = -24 -- Hours back in time you want to go
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In an effort to not clog your servers up, we've taken some care in batching things as we move data. Inspired by &lt;a href="http://michaeljswart.com/2014/09/take-care-when-scripting-batches/" rel="nofollow"&gt;Michael J. Swart's Take Care When Scripting Batches&lt;/a&gt;, we only move data in 10 minute intervals.&lt;/p&gt;
&lt;p&gt;The reason behind that is, if you have 500 databases, and you're taking log backups every minute, you can have a lot of data to move. A 5000 row batch should move pretty quickly.&lt;/p&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-sp_allnightlog-back-up-faster-to-lose-less-data" class="anchor" aria-hidden="true" href="#sp_allnightlog-back-up-faster-to-lose-less-data"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;sp_AllNightLog: Back Up Faster to Lose Less Data&lt;/h2&gt;
&lt;p&gt;You manage a SQL Server instance with hundreds or thousands of mission-critical databases. You want to back them all up as quickly as possible, and one maintenance plan job isn't going to cut it.&lt;/p&gt;
&lt;p&gt;Let's scale out our backup jobs by:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Creating a table with a list of databases and their desired Recovery Point Objective (RPO, aka data loss) - done with sp_AllNightLog_Setup&lt;/li&gt;
&lt;li&gt;Set up several Agent jobs to back up databases as necessary - also done with sp_AllNightLog_Setup&lt;/li&gt;
&lt;li&gt;Inside each of those Agent jobs, they call sp_AllNightLog @Backup = 1, which loops through the table to find databases that need to be backed up, then call &lt;a href="https://ola.hallengren.com/" rel="nofollow"&gt;Ola Hallengren's DatabaseBackup stored procedure&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Keeping that database list up to date as new databases are added - done by a job calling sp_AllNightLog @PollForNewDatabases = 1&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For more information about how this works, see &lt;a href="https://www.BrentOzar.com/sp_AllNightLog" rel="nofollow"&gt;sp_AllNightLog documentation.&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Known issues:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The msdbCentral database name is hard-coded.&lt;/li&gt;
&lt;li&gt;sp_AllNightLog depends on Ola Hallengren's DatabaseBackup, which must be installed separately. (We're not checking for it right now.)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-sp_databaserestore-easier-multi-file-restores" class="anchor" aria-hidden="true" href="#sp_databaserestore-easier-multi-file-restores"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;sp_DatabaseRestore: Easier Multi-File Restores&lt;/h2&gt;
&lt;p&gt;If you use &lt;a href="http://ola.hallengren.com" rel="nofollow"&gt;Ola Hallengren's backup scripts&lt;/a&gt;, DatabaseRestore.sql helps you rapidly restore a database to the most recent point in time.&lt;/p&gt;
&lt;p&gt;Parameters include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@Database - the database's name, like LogShipMe&lt;/li&gt;
&lt;li&gt;@RestoreDatabaseName&lt;/li&gt;
&lt;li&gt;@BackupPathFull - typically a UNC path like '\FILESERVER\BACKUPS\SQL2016PROD1A\LogShipMe\FULL' that points to where the full backups are stored. Note that if the path doesn't exist, we don't create it, and the query might take 30+ seconds if you specify an invalid server name.&lt;/li&gt;
&lt;li&gt;@BackupPathDiff, @BackupPathLog - as with the Full, this should be set to the exact path where the differentials and logs are stored. We don't append anything to these parameters.&lt;/li&gt;
&lt;li&gt;@MoveFiles, @MoveDataDrive, @MoveLogDrive - if you want to restore to somewhere other than your default database locations.&lt;/li&gt;
&lt;li&gt;@RunCheckDB - default 0. When set to 1, we run Ola Hallengren's DatabaseIntegrityCheck stored procedure on this database, and log the results to table. We use that stored proc's default parameters, nothing fancy.&lt;/li&gt;
&lt;li&gt;@TestRestore - default 0. When set to 1, we delete the database after the restore completes. Used for just testing your restores. Especially useful in combination with @RunCheckDB = 1 because we'll delete the database after running checkdb, but know that we delete the database even if it fails checkdb tests.&lt;/li&gt;
&lt;li&gt;@RestoreDiff - default 0. When set to 1, we restore the ncessary full, differential, and log backups (instead of just full and log) to get to the most recent point in time.&lt;/li&gt;
&lt;li&gt;@ContinueLogs - default 0. When set to 1, we don't restore a full or differential backup - we only restore the transaction log backups. Good for continuous log restores with tools like sp_AllNightLog.&lt;/li&gt;
&lt;li&gt;@RunRecovery - default 0. When set to 1, we run RESTORE WITH RECOVERY, putting the database into writable mode, and no additional log backups can be restored.&lt;/li&gt;
&lt;li&gt;@ExistingDBAction - if the database already exists when we try to restore it, 1 sets the database to single user mode, 2 kills the connections, and 3 kills the connections and then drops the database.&lt;/li&gt;
&lt;li&gt;@Debug - default 0. When 1, we print out messages of what we're doing in the messages tab of SSMS.&lt;/li&gt;
&lt;li&gt;@StopAt NVARCHAR(14) - pass in a date time to stop your restores at a time like '20170508201501'. This doesn't use the StopAt parameter for the restore command - it simply stops restoring logs that would have this date/time's contents in it. (For example, if you're taking backups every 15 minutes on the hour, and you pass in 9:05 AM as part of the restore time, the restores would stop at your last log backup that doesn't include 9:05AM's data - but it won't restore right up to 9:05 AM.)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For information about how this works, see &lt;a href="https://BrentOzar.com/go/gce" rel="nofollow"&gt;Tara Kizer's white paper on Log Shipping 2.0 with Google Compute Engine.&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-parameters-common-to-many-of-the-stored-procedures" class="anchor" aria-hidden="true" href="#parameters-common-to-many-of-the-stored-procedures"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Parameters Common to Many of the Stored Procedures&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;@Help = 1 - returns a result set or prints messages explaining the stored procedure's input and output. Make sure to check the Messages tab in SSMS to read it.&lt;/li&gt;
&lt;li&gt;@ExpertMode = 1 - turns on more details useful for digging deeper into results.&lt;/li&gt;
&lt;li&gt;@OutputDatabaseName, @OutputSchemaName, @OutputTableName - pass all three of these in, and the stored proc's output will be written to a table. We'll create the table if it doesn't already exist.&lt;/li&gt;
&lt;li&gt;@OutputServerName - not functional yet. To track (or help!) implementation status: &lt;a href="https://github.com/BrentOzarULTD/SQL-Server-First-Responder-Kit/issues/293"&gt;https://github.com/BrentOzarULTD/SQL-Server-First-Responder-Kit/issues/293&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-license" class="anchor" aria-hidden="true" href="#license"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;License&lt;/h2&gt;
&lt;p&gt;&lt;a href="LICENSE.md"&gt;The SQL Server First Responder Kit uses the MIT License.&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="#header1"&gt;&lt;em&gt;Back to top&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/article&gt;&lt;/div&gt;</description><author>BrentOzarULTD</author><guid isPermaLink="false">https://github.com/BrentOzarULTD/SQL-Server-First-Responder-Kit</guid><pubDate>Sat, 04 Jan 2020 00:02:00 GMT</pubDate></item><item><title>raramuridesign/mysql-country-list #3 in TSQL, This week</title><link>https://github.com/raramuridesign/mysql-country-list</link><description>&lt;p&gt;&lt;i&gt;mysql insert country list into database&lt;/i&gt;&lt;/p&gt;&lt;div id="readme" class="md" data-path="README.md"&gt;&lt;article class="markdown-body entry-content p-5" itemprop="text"&gt;&lt;h1&gt;&lt;a id="user-content-mysql-country-list-import" class="anchor" aria-hidden="true" href="#mysql-country-list-import"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;MYSQL Country List Import&lt;/h1&gt;
&lt;p&gt;Use this mysql to import a list of countries into your database.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-types-of-lists" class="anchor" aria-hidden="true" href="#types-of-lists"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Types of Lists&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Simple country code and name&lt;/li&gt;
&lt;li&gt;Simple country code and name with InnoDB&lt;/li&gt;
&lt;li&gt;Detailed country info&lt;/li&gt;
&lt;li&gt;JSON Array&lt;/li&gt;
&lt;li&gt;PHP Array&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;&lt;a id="user-content-the-sql-imports-contains-the-following-info" class="anchor" aria-hidden="true" href="#the-sql-imports-contains-the-following-info"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;The SQL imports contains the following info&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Table name: apps_countries&lt;/li&gt;
&lt;li&gt;no ID's used on first import&lt;/li&gt;
&lt;li&gt;Country Name, Country Short code&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;&lt;a id="user-content-usage" class="anchor" aria-hidden="true" href="#usage"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Usage&lt;/h3&gt;
&lt;p&gt;Use PHPmyAdmin to import the SQL file into your database.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-improvements" class="anchor" aria-hidden="true" href="#improvements"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Improvements&lt;/h3&gt;
&lt;p&gt;If there are any amendments, please open an issue.
Thank you.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Maintained by:
&lt;a href="http://www.raramuridesign.com" rel="nofollow"&gt;www.raramuridesign.com&lt;/a&gt;&lt;/p&gt;
&lt;/article&gt;&lt;/div&gt;</description><author>raramuridesign</author><guid isPermaLink="false">https://github.com/raramuridesign/mysql-country-list</guid><pubDate>Sat, 04 Jan 2020 00:03:00 GMT</pubDate></item><item><title>confluentinc/examples #4 in TSQL, This week</title><link>https://github.com/confluentinc/examples</link><description>&lt;p&gt;&lt;i&gt;Apache Kafka and Confluent Platform examples and demos&lt;/i&gt;&lt;/p&gt;&lt;div id="readme" class="md" data-path="README.md"&gt;&lt;article class="markdown-body entry-content p-5" itemprop="text"&gt;&lt;p&gt;&lt;a target="_blank" rel="noopener noreferrer" href="images/confluent-logo-300-2.png"&gt;&lt;img src="images/confluent-logo-300-2.png" alt="image" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#demos"&gt;Demos&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#build-your-own"&gt;Build Your Own&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#prerequisites"&gt;Prerequisities&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;&lt;a id="user-content-demos" class="anchor" aria-hidden="true" href="#demos"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Demos&lt;/h1&gt;
&lt;p&gt;This is a curated list of demos that showcase Apache Kafka® event stream processing on the Confluent Platform, an event stream processing platform that enables you to process, organize, and manage massive amounts of streaming data across cloud, on-prem, and serverless deployments.&lt;/p&gt;
&lt;p align="center"&gt;
&lt;a href="http://www.youtube.com/watch?v=muQBd6gry0U" rel="nofollow"&gt;&lt;img src="images/examples-video-thumbnail.jpg" width="360" height="270" border="10" style="max-width:100%;"&gt;&lt;/a&gt;
&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-where-to-start" class="anchor" aria-hidden="true" href="#where-to-start"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Where to start&lt;/h2&gt;
&lt;p&gt;The best demo to start with is &lt;a href="https://github.com/confluentinc/cp-demo"&gt;cp-demo&lt;/a&gt; which spins up a Kafka event streaming application using KSQL for stream processing, with many security features enabled, in an end-to-end streaming ETL pipeline with a source connector pulling from live IRC channels and a sink connector connecting to Elasticsearch and Kibana for visualizations.
&lt;code&gt;cp-demo&lt;/code&gt; also comes with a playbook and is a great configuration reference for Confluent Platform.&lt;/p&gt;
&lt;h2&gt;&lt;a id="user-content-full-demo-list" class="anchor" aria-hidden="true" href="#full-demo-list"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Full demo list&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#confluent-cloud"&gt;Confluent Cloud&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#stream-processing"&gt;Stream Processing&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#data-pipelines"&gt;Data Pipelines&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#confluent-platform"&gt;Confluent Platform&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;&lt;a id="user-content-confluent-cloud" class="anchor" aria-hidden="true" href="#confluent-cloud"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Confluent Cloud&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Demo&lt;/th&gt;
&lt;th&gt;Local&lt;/th&gt;
&lt;th&gt;Docker&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="ccloud/beginner-cloud/README.md"&gt;Beginner Cloud&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Y&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;Fully scripted demo that shows how to interact with your Confluent Cloud cluster and set ACLs using the CLI &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="clients/cloud/images/confluent-cloud.jpeg"&gt;&lt;img src="clients/cloud/images/confluent-cloud.jpeg" width="400" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="clients/cloud/README.md"&gt;Clients to Cloud&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="clients/cloud/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;Client applications in different programming languages connecting to &lt;a href="https://www.confluent.io/confluent-cloud/?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Confluent Cloud&lt;/a&gt; &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="clients/cloud/images/clients-all.png"&gt;&lt;img src="clients/cloud/images/clients-all.png" width="450" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="https://github.com/confluentinc/demo-scene/blob/master/gcp-pipeline/README.adoc"&gt;GCP pipeline&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;&lt;a href="https://github.com/confluentinc/demo-scene/blob/master/gcp-pipeline/README.adoc"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Work with &lt;a href="https://www.confluent.io/confluent-cloud/?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Confluent Cloud&lt;/a&gt; to build cool pipelines into Google Cloud Platform (GCP) &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://github.com/confluentinc/demo-scene/blob/master/gcp-pipeline/images/env-data-arch-01.png"&gt;&lt;img src="https://github.com/confluentinc/demo-scene/raw/master/gcp-pipeline/images/env-data-arch-01.png" width="450" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="kinesis-cloud/README.md"&gt;Kinesis to Cloud&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="kinesis-cloud/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;AWS Kinesis -&amp;gt; Confluent Cloud -&amp;gt; Google Cloud Storage pipeline &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="kinesis-cloud/images/topology.jpg"&gt;&lt;img src="kinesis-cloud/images/topology.jpg" width="450" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="ccloud/README.md"&gt;On-Prem Kafka to Cloud&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="ccloud/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="ccloud/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;This more advanced demo showcases an on-prem Kafka cluster and &lt;a href="https://www.confluent.io/confluent-cloud/?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Confluent Cloud&lt;/a&gt; cluster, and data copied between them with Confluent Replicator &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="ccloud/docs/images/schema-registry-local.jpg"&gt;&lt;img src="ccloud/docs/images/schema-registry-local.jpg" width="450" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="kubernetes/replicator-gke-cc/README.md"&gt;GKE to Cloud&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;&lt;a href="kubernetes/replicator-gke-cc/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Uses Google Kubernetes Engine, &lt;a href="https://www.confluent.io/confluent-cloud/?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Confluent Cloud&lt;/a&gt;, and &lt;a href="https://www.confluent.io/confluent-replicator/?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Confluent Replicator&lt;/a&gt; to explore a multicloud deployment &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="kubernetes/replicator-gke-cc/docs/images/operator-demo-phase-2.png"&gt;&lt;img src="kubernetes/replicator-gke-cc/docs/images/operator-demo-phase-2.png" width="450" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3&gt;&lt;a id="user-content-stream-processing" class="anchor" aria-hidden="true" href="#stream-processing"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Stream Processing&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Demo&lt;/th&gt;
&lt;th&gt;Local&lt;/th&gt;
&lt;th&gt;Docker&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="clickstream/README.md"&gt;Clickstream&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="clickstream/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://docs.confluent.io/current/ksql/docs/tutorials/clickstream-docker.html#ksql-clickstream-docker?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Automated version of the &lt;a href="https://docs.confluent.io/current/ksql/docs/tutorials/clickstream-docker.html#ksql-clickstream-docker?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;KSQL clickstream demo&lt;/a&gt; &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/28e9212ca11ed82e4015367f81b89bec3e61f107/68747470733a2f2f646f63732e636f6e666c75656e742e696f2f63757272656e742f5f696d616765732f67726166616e612d737563636573732e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/28e9212ca11ed82e4015367f81b89bec3e61f107/68747470733a2f2f646f63732e636f6e666c75656e742e696f2f63757272656e742f5f696d616765732f67726166616e612d737563636573732e706e67" width="450" data-canonical-src="https://docs.confluent.io/current/_images/grafana-success.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="https://kafka-tutorials.confluent.io?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Kafka Tutorials&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://kafka-tutorials.confluent.io?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://kafka-tutorials.confluent.io?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Collection of common event streaming use cases, with each tutorial featuring an example scenario and several complete code solutions &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/a8588b0e07ad402e01e0e1f355a840c3717fb7cd/68747470733a2f2f63646e2e636f6e666c75656e742e696f2f77702d636f6e74656e742f75706c6f6164732f4b61666b612d5475746f7269616c732d333530783139352e6a7067"&gt;&lt;img src="https://camo.githubusercontent.com/a8588b0e07ad402e01e0e1f355a840c3717fb7cd/68747470733a2f2f63646e2e636f6e666c75656e742e696f2f77702d636f6e74656e742f75706c6f6164732f4b61666b612d5475746f7269616c732d333530783139352e6a7067" width="350" data-canonical-src="https://cdn.confluent.io/wp-content/uploads/Kafka-Tutorials-350x195.jpg" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="https://github.com/confluentinc/demo-scene/blob/master/ksql-udf-advanced-example/README.md?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top"&gt;KSQL UDF&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://github.com/confluentinc/demo-scene/blob/master/ksql-udf-advanced-example/README.md?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;Advanced &lt;a href="https://www.confluent.io/blog/build-udf-udaf-ksql-5-0?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;KSQL User-Defined Function (UDF)&lt;/a&gt; use case for connected cars &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/fcb649b2d1a60911f393cc63738cdcb5c0710d73/68747470733a2f2f7777772e636f6e666c75656e742e696f2f77702d636f6e74656e742f75706c6f6164732f4b53514c2d312d333530783139352e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/fcb649b2d1a60911f393cc63738cdcb5c0710d73/68747470733a2f2f7777772e636f6e666c75656e742e696f2f77702d636f6e74656e742f75706c6f6164732f4b53514c2d312d333530783139352e706e67" width="350" data-canonical-src="https://www.confluent.io/wp-content/uploads/KSQL-1-350x195.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="https://github.com/confluentinc/demo-scene/blob/master/ksql-workshop/"&gt;KSQL workshop&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;&lt;a href="https://github.com/confluentinc/demo-scene/blob/master/ksql-workshop/"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;showcases Kafka event stream processing using KSQL and can run self-guided as a KSQL workshop &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://github.com/confluentinc/demo-scene/blob/master/ksql-workshop/images/ksql_workshop_01.png"&gt;&lt;img src="https://github.com/confluentinc/demo-scene/raw/master/ksql-workshop/images/ksql_workshop_01.png" width="450" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="microservices-orders/README.md"&gt;Microservices ecosystem&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="microservices-orders/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;&lt;a href="https://github.com/confluentinc/kafka-streams-examples/tree/5.2.2-post/src/main/java/io/confluent/examples/streams/microservices"&gt;Microservices orders Demo Application&lt;/a&gt; integrated into the Confluent Platform &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="microservices-orders/docs/images/microservices-demo.jpg"&gt;&lt;img src="microservices-orders/docs/images/microservices-demo.jpg" width="450" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="music/README.md"&gt;Music demo&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="music/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="music/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;KSQL version of the &lt;a href="https://docs.confluent.io/current/streams/kafka-streams-examples/docs/index.html?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Kafka Streams Demo Application&lt;/a&gt; &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="music/images/ksql-music-demo-overview.jpg"&gt;&lt;img src="music/images/ksql-music-demo-overview.jpg" width="450" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3&gt;&lt;a id="user-content-data-pipelines" class="anchor" aria-hidden="true" href="#data-pipelines"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Data Pipelines&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Demo&lt;/th&gt;
&lt;th&gt;Local&lt;/th&gt;
&lt;th&gt;Docker&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="https://github.com/confluentinc/demo-scene/blob/master/no-more-silos/demo_no-more-silos.adoc"&gt;CDC with MySQL&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;&lt;a href="https://github.com/confluentinc/demo-scene/blob/master/no-more-silos/demo_no-more-silos.adoc"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Self-paced steps to set up a change data capture (CDC) pipeline &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/b9dbae7351f1813eb87dac08d7726b9554b891a2/68747470733a2f2f7777772e636f6e666c75656e742e696f2f77702d636f6e74656e742f75706c6f6164732f6b61666b615f636f6e6e6563742d312e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/b9dbae7351f1813eb87dac08d7726b9554b891a2/68747470733a2f2f7777772e636f6e666c75656e742e696f2f77702d636f6e74656e742f75706c6f6164732f6b61666b615f636f6e6e6563742d312e706e67" width="450" data-canonical-src="https://www.confluent.io/wp-content/uploads/kafka_connect-1.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="postgres-debezium-ksql-elasticsearch/README.md"&gt;CDC with Postgres&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;&lt;a href="postgres-debezium-ksql-elasticsearch/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Enrich event stream data with CDC data from Postgres and then stream into Elasticsearch &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="postgres-debezium-ksql-elasticsearch/images/ksql-debezium-es.png"&gt;&lt;img src="postgres-debezium-ksql-elasticsearch/images/ksql-debezium-es.png" width="450" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="connect-streams-pipeline/README.md"&gt;Connect and Kafka Streams&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="connect-streams-pipeline/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;Demonstrate various ways, with and without Kafka Connect, to get data into Kafka topics and then loaded for use by the Kafka Streams API &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="connect-streams-pipeline/images/blog_connect_streams_diag.jpg"&gt;&lt;img src="connect-streams-pipeline/images/blog_connect_streams_diag.jpg" width="450" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="https://github.com/confluentinc/demo-scene/blob/master/mqtt-connect-connector-demo/README.md"&gt;MQTT&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://github.com/confluentinc/demo-scene/blob/master/mqtt-connect-connector-demo/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;Internet of Things (IoT) integration example using Apache Kafka + Kafka Connect + MQTT Connector + Sensor Data &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/80c360e482a98ae2311869d0cedc5ef984821eee/68747470733a2f2f7777772e636f6e666c75656e742e696f2f77702d636f6e74656e742f75706c6f6164732f6477675f4d5154542e737667"&gt;&lt;img src="https://camo.githubusercontent.com/80c360e482a98ae2311869d0cedc5ef984821eee/68747470733a2f2f7777772e636f6e666c75656e742e696f2f77702d636f6e74656e742f75706c6f6164732f6477675f4d5154542e737667" width="450" data-canonical-src="https://www.confluent.io/wp-content/uploads/dwg_MQTT.svg" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="mysql-debezium/README.md"&gt;MySQL and Debezium&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="mysql-debezium/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://github.com/confluentinc/demo-scene/tree/master/build-a-streaming-pipeline"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;End-to-end streaming ETL with KSQL for stream processing using the &lt;a href="http://debezium.io/docs/connectors/mysql/" rel="nofollow"&gt;Debezium Connector for MySQL&lt;/a&gt; &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="mysql-debezium/images/ksql-debezium-es.png"&gt;&lt;img src="mysql-debezium/images/ksql-debezium-es.png" width="450" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="https://github.com/confluentinc/demo-scene/tree/master/syslog"&gt;Syslog&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;Y&lt;/td&gt;
&lt;td&gt;Real-time syslog processing with Apache Kafka and KSQL: filtering logs, event-driven alerting, and enriching events &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/6436ef9d9bca4eaa9d300c713fee0e4be6db8ee6/68747470733a2f2f7777772e636f6e666c75656e742e696f2f77702d636f6e74656e742f75706c6f6164732f6b73716c5f7379736c6f6730312d31303234783235382e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/6436ef9d9bca4eaa9d300c713fee0e4be6db8ee6/68747470733a2f2f7777772e636f6e666c75656e742e696f2f77702d636f6e74656e742f75706c6f6164732f6b73716c5f7379736c6f6730312d31303234783235382e706e67" width="450" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3&gt;&lt;a id="user-content-confluent-platform" class="anchor" aria-hidden="true" href="#confluent-platform"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Confluent Platform&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Demo&lt;/th&gt;
&lt;th&gt;Local&lt;/th&gt;
&lt;th&gt;Docker&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="clients/README.md"&gt;Avro&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="clients/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;Client applications using Avro and Confluent Schema Registry &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/92ad363b0e5811b5935c9dc81c37845d9273a0b7/68747470733a2f2f7777772e636f6e666c75656e742e696f2f77702d636f6e74656e742f75706c6f6164732f6477675f536368656d615265675f686f776974776f726b732e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/92ad363b0e5811b5935c9dc81c37845d9273a0b7/68747470733a2f2f7777772e636f6e666c75656e742e696f2f77702d636f6e74656e742f75706c6f6164732f6477675f536368656d615265675f686f776974776f726b732e706e67" width="420" data-canonical-src="https://www.confluent.io/wp-content/uploads/dwg_SchemaReg_howitworks.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="wikipedia/README.md"&gt;CP Demo&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="wikipedia/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://github.com/confluentinc/cp-demo"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://docs.confluent.io/current/tutorials/cp-demo/docs/index.html?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Confluent Platform demo&lt;/a&gt; with a playbook for Kafka event streaming ETL deployments &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://github.com/confluentinc/cp-demo/blob/5.3.0-post/docs/images/drawing.png"&gt;&lt;img src="https://github.com/confluentinc/cp-demo/raw/5.3.0-post/docs/images/drawing.png" width="420" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="kubernetes/README.md"&gt;Kubernetes&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;&lt;a href="kubernetes/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Demonstrations of Confluent Platform deployments using the  &lt;a href="https://docs.confluent.io/current/installation/operator/index.html?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Confluent Operator&lt;/a&gt; &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="kubernetes/gke-base/docs/images/operator.png"&gt;&lt;img src="kubernetes/gke-base/docs/images/operator.png" width="420" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="multi-datacenter/README.md"&gt;Multi Datacenter&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;&lt;a href="multi-datacenter/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Active-active multi-datacenter design with two instances of Confluent Replicator copying data bidirectionally between the datacenters &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/c0090d428178db34693591175b730b27450002ad/68747470733a2f2f646f63732e636f6e666c75656e742e696f2f63757272656e742f5f696d616765732f6d64632d6c6576656c2d312e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/c0090d428178db34693591175b730b27450002ad/68747470733a2f2f646f63732e636f6e666c75656e742e696f2f63757272656e742f5f696d616765732f6d64632d6c6576656c2d312e706e67" width="420" data-canonical-src="https://docs.confluent.io/current/_images/mdc-level-1.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="cp-quickstart/README.md"&gt;Quickstart&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="cp-quickstart/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://docs.confluent.io/current/quickstart/ce-docker-quickstart.html#ce-docker-quickstart?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Automated version of the &lt;a href="https://docs.confluent.io/current/quickstart.html?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Confluent Platform Quickstart&lt;/a&gt; &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/494b6bf1a80993311d29232f17064ab180ebe677/68747470733a2f2f646f63732e636f6e666c75656e742e696f2f63757272656e742f5f696d616765732f636f6e666c75656e74506c6174666f726d2e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/494b6bf1a80993311d29232f17064ab180ebe677/68747470733a2f2f646f63732e636f6e666c75656e742e696f2f63757272656e742f5f696d616765732f636f6e666c75656e74506c6174666f726d2e706e67" width="420" data-canonical-src="https://docs.confluent.io/current/_images/confluentPlatform.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="security/rbac/README.md"&gt;Role-Based Access Control&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Y&lt;/td&gt;
&lt;td&gt;Y&lt;/td&gt;
&lt;td&gt;Role-based Access Control (RBAC) provides granular privileges for users and service accounts &lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/33dd1276d7e43660810d10a9d0997502fe22a623/68747470733a2f2f646f63732e636f6e666c75656e742e696f2f63757272656e742f5f696d616765732f726261632d6f766572766965772e706e67"&gt;&lt;img src="https://camo.githubusercontent.com/33dd1276d7e43660810d10a9d0997502fe22a623/68747470733a2f2f646f63732e636f6e666c75656e742e696f2f63757272656e742f5f696d616765732f726261632d6f766572766965772e706e67" width="450" data-canonical-src="https://docs.confluent.io/current/_images/rbac-overview.png" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="security/secret-protection/README.adoc"&gt;Secret Protection&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Y&lt;/td&gt;
&lt;td&gt;Y&lt;/td&gt;
&lt;td&gt;Secret Protection feature encrypts secrets in configuration files &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/90888c033d0e611f7b73c5df261a109ead6858a1/68747470733a2f2f63646e2e636f6e666c75656e742e696f2f77702d636f6e74656e742f75706c6f6164732f5365637265745f50726f74656374696f6e5f466561747572652e6a7067"&gt;&lt;img src="https://camo.githubusercontent.com/90888c033d0e611f7b73c5df261a109ead6858a1/68747470733a2f2f63646e2e636f6e666c75656e742e696f2f77702d636f6e74656e742f75706c6f6164732f5365637265745f50726f74656374696f6e5f466561747572652e6a7067" width="400" data-canonical-src="https://cdn.confluent.io/wp-content/uploads/Secret_Protection_Feature.jpg" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="replicator-security/README.md"&gt;Replicator Security&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;&lt;a href="replicator-security/README.md"&gt;Y&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Demos of various security configurations supported by Confluent Replicator and examples of how to implement them &lt;br&gt;&lt;a target="_blank" rel="noopener noreferrer" href="images/replicator-security.png"&gt;&lt;img src="images/replicator-security.png" width="300" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1&gt;&lt;a id="user-content-build-your-own" class="anchor" aria-hidden="true" href="#build-your-own"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Build Your Own&lt;/h1&gt;
&lt;p&gt;As a next step, you may want to build your own custom demo or test environment.
We have several resources that launch just the services in Confluent Platform with no pre-configured connectors, data sources, topics, schemas, etc.
Using these as a foundation, you can then add any connectors or applications.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="cp-all-in-one/README.md"&gt;cp-all-in-one&lt;/a&gt;: This Docker Compose file launches all services in Confluent Platform, and runs them in containers in your local host.&lt;/li&gt;
&lt;li&gt;&lt;a href="cp-all-in-one-cloud/README.md"&gt;cp-all-in-one-cloud&lt;/a&gt;: Use this with your pre-configured Confluent Cloud instance. This Docker Compose file launches all services in Confluent Platform (except for the Kafka brokers), runs them in containers in your local host, and automatically configures them to connect to Confluent Cloud.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://docs.confluent.io/current/cli/index.html?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Confluent CLI&lt;/a&gt;: For local, non-Docker installs of Confluent Platform. Using this CLI, you can launch all services in Confluent Platform with just one command &lt;code&gt;confluent local start&lt;/code&gt;, and they will all run on your local host.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.confluent.io/blog/easy-ways-generate-test-data-kafka?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Generate test data&lt;/a&gt;: "Hello, World!" for launching Confluent Platform, plus different ways to generate more interesting test data for your topics&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Additional documentation: &lt;a href="https://docs.confluent.io/current/getting-started.html?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Getting Started&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;&lt;a id="user-content-prerequisites" class="anchor" aria-hidden="true" href="#prerequisites"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prerequisites&lt;/h1&gt;
&lt;p&gt;For local installs:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Download &lt;a href="https://www.confluent.io/download/?utm_source=github&amp;amp;utm_medium=demo&amp;amp;utm_campaign=ch.examples_type.community_content.top" rel="nofollow"&gt;Confluent Platform 5.3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Env var &lt;code&gt;CONFLUENT_HOME=/path/to/confluentplatform&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Env var &lt;code&gt;PATH&lt;/code&gt; includes &lt;code&gt;$CONFLUENT_HOME/bin&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Each demo has its own set of prerequisites as well, documented individually in each demo&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For Docker: demos have been validated with&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://docs.docker.com/install/" rel="nofollow"&gt;Docker&lt;/a&gt; version 17.06.1-ce&lt;/li&gt;
&lt;li&gt;&lt;a href="https://docs.docker.com/compose/install/" rel="nofollow"&gt;Docker Compose&lt;/a&gt; version 1.14.0 with Docker Compose file format 2.1&lt;/li&gt;
&lt;/ul&gt;
&lt;/article&gt;&lt;/div&gt;</description><author>confluentinc</author><guid isPermaLink="false">https://github.com/confluentinc/examples</guid><pubDate>Sat, 04 Jan 2020 00:04:00 GMT</pubDate></item><item><title>OSGeo/PROJ #5 in TSQL, This week</title><link>https://github.com/OSGeo/PROJ</link><description>&lt;p&gt;&lt;i&gt;PROJ - Cartographic Projections and Coordinate Transformations Library&lt;/i&gt;&lt;/p&gt;&lt;div id="readme" class="md" data-path="README.md"&gt;&lt;article class="markdown-body entry-content p-5" itemprop="text"&gt;&lt;h1&gt;&lt;a id="user-content-proj" class="anchor" aria-hidden="true" href="#proj"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;PROJ&lt;/h1&gt;
&lt;p&gt;&lt;a href="https://travis-ci.com/OSGeo/PROJ" rel="nofollow"&gt;&lt;img src="https://camo.githubusercontent.com/c8a2b453f23427e38bd909855f8c9a1c92ed9713/68747470733a2f2f7472617669732d63692e636f6d2f4f5347656f2f50524f4a2e7376673f6272616e63683d6d6173746572" alt="Travis Status" data-canonical-src="https://travis-ci.com/OSGeo/PROJ.svg?branch=master" style="max-width:100%;"&gt;&lt;/a&gt;
&lt;a href="https://ci.appveyor.com/project/OSGeo/PROJ?branch=master" rel="nofollow"&gt;&lt;img src="https://camo.githubusercontent.com/aa631aa8bab384760949f03e42edafba0ce8bfea/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f6769746875622f4f5347656f2f50524f4a3f6272616e63683d6d6173746572267376673d74727565" alt="AppVeyor Status" data-canonical-src="https://ci.appveyor.com/api/projects/status/github/OSGeo/PROJ?branch=master&amp;amp;svg=true" style="max-width:100%;"&gt;&lt;/a&gt;
&lt;a href="https://coveralls.io/github/OSGeo/PROJ?branch=master" rel="nofollow"&gt;&lt;img src="https://camo.githubusercontent.com/8b94ea6e1cc76a3aa89c412b516dae40db484f2a/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6769746875622f4f5347656f2f50524f4a2f62616467652e7376673f6272616e63683d6d6173746572" alt="Coveralls Status" data-canonical-src="https://coveralls.io/repos/github/OSGeo/PROJ/badge.svg?branch=master" style="max-width:100%;"&gt;&lt;/a&gt;
&lt;a href="https://gitter.im/OSGeo/proj.4" rel="nofollow"&gt;&lt;img src="https://camo.githubusercontent.com/51e081f735b459a1d12c3eaf3a0f0c0ae7003d62/68747470733a2f2f6261646765732e6769747465722e696d2f4f5347656f2f70726f6a2e342e737667" alt="Gitter" data-canonical-src="https://badges.gitter.im/OSGeo/proj.4.svg" style="max-width:100%;"&gt;&lt;/a&gt;
&lt;a href="http://lists.osgeo.org/mailman/listinfo/proj" rel="nofollow"&gt;&lt;img src="https://camo.githubusercontent.com/7ee52d9ae4c6581edc0936c4f733cc0b836dd56e/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f50524f4a2d6d61696c696e672532306c6973742d3465623839392e737667" alt="Mailing List" data-canonical-src="https://img.shields.io/badge/PROJ-mailing%20list-4eb899.svg" style="max-width:100%;"&gt;&lt;/a&gt;
&lt;a href="code-of-conduct.md"&gt;&lt;img src="https://camo.githubusercontent.com/8315e511f8eb4651470540d6951fd05099251fc5/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f436f6e7472696275746f72253230436f76656e616e742d76312e3425323061646f707465642d6666363962342e737667" alt="Contributor Covenant" data-canonical-src="https://img.shields.io/badge/Contributor%20Covenant-v1.4%20adopted-ff69b4.svg" style="max-width:100%;"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;PROJ is a generic coordinate transformation software, that transforms
coordinates from one coordinate reference system (CRS) to another.
This includes cartographic projections as well as geodetic transformations.&lt;/p&gt;
&lt;p&gt;For more information on the PROJ project please see the web page at:&lt;/p&gt;
&lt;p&gt;&lt;a href="https://proj.org/" rel="nofollow"&gt;https://proj.org/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The PROJ mailing list can be found at:&lt;/p&gt;
&lt;p&gt;&lt;a href="https://lists.osgeo.org/mailman/listinfo/proj/" rel="nofollow"&gt;https://lists.osgeo.org/mailman/listinfo/proj/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;See the NEWS file for changes between versions.&lt;/p&gt;
&lt;p&gt;The following command line utilities are included in the PROJ package:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;proj&lt;/code&gt;: for cartographic projection of geodetic coordinates&lt;/li&gt;
&lt;li&gt;&lt;code&gt;cs2cs&lt;/code&gt;: for transformation from one CRS to another CRS.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;geod&lt;/code&gt;: for geodesic (great circle) computations.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;cct&lt;/code&gt;: for generic Coordinate Conversions and Transformations.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;gie&lt;/code&gt;: the Geospatial Integrity Investigation Environment.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;projinfo&lt;/code&gt;: for geodetic object and coordinate operation queries&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;More information on the utilities can be found on the &lt;a href="https://proj.org/apps" rel="nofollow"&gt;PROJ website&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;&lt;a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Installation&lt;/h2&gt;
&lt;h3&gt;&lt;a id="user-content-build-dependencies" class="anchor" aria-hidden="true" href="#build-dependencies"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Build dependencies&lt;/h3&gt;
&lt;p&gt;PROJ requires C and C++11 compilers.
It also requires SQLite3 (headers, library and executable).  The minimum
version of SQLite3 required is 3.11&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-building-with-cmake" class="anchor" aria-hidden="true" href="#building-with-cmake"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Building with CMake&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;cd proj
mkdir build
cd build
cmake ..
cmake --build .
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;On Windows, one may need to specify generator:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cmake -G "Visual Studio 15 2017" ..
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If the SQLite3 dependency is installed in a custom location, specify the
paths to the include directory and the library:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cmake -DSQLITE3_INCLUDE_DIR=/opt/SQLite/include -DSQLITE3_LIBRARY=/opt/SQLite/lib/libsqlite3.so ..
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Tests are run with&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ctest
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The test suite requires that the proj-datumgrid package is installed
in &lt;code&gt;PROJ_LIB&lt;/code&gt;.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-building-on-unixlinux" class="anchor" aria-hidden="true" href="#building-on-unixlinux"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Building on Unix/Linux&lt;/h3&gt;
&lt;p&gt;FSF's configuration procedure is used to ease installation of the
PROJ system.&lt;/p&gt;
&lt;p&gt;The default destination path prefix for installed files is &lt;code&gt;/usr/local&lt;/code&gt;.
Results from the installation script will be placed into subdirectories
&lt;code&gt;bin&lt;/code&gt;, &lt;code&gt;include&lt;/code&gt;, &lt;code&gt;lib&lt;/code&gt;, &lt;code&gt;man/man1&lt;/code&gt; and &lt;code&gt;man/man3&lt;/code&gt;.
If this default path prefix is proper, then execute:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./configure
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;See the note below if you are building PROJ directly from the git repository.&lt;/p&gt;
&lt;p&gt;If another path prefix is required, then execute:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./configure --prefix=/my/path
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In either case, the directory of the prefix path must exist and be
writable by the installer.
After executing configure, execute:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make
make install
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The install target will create, if necessary, all required sub-directories.&lt;/p&gt;
&lt;p&gt;Tests are run with&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make check
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The test suite requires that the proj-datumgrid package is installed
in &lt;code&gt;PROJ_LIB&lt;/code&gt;.&lt;/p&gt;
&lt;h4&gt;&lt;a id="user-content-building-from-the-git-repository" class="anchor" aria-hidden="true" href="#building-from-the-git-repository"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Building from the git repository&lt;/h4&gt;
&lt;p&gt;If you are building from the git repository you have to first run&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./autogen.sh
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;which will generate a configure script that can be used as described above.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-distribution-files-and-format" class="anchor" aria-hidden="true" href="#distribution-files-and-format"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Distribution files and format&lt;/h3&gt;
&lt;p&gt;Sources are distributed in one or more files.  The principle elements
of the system are stored in a compressed tar file named &lt;code&gt;proj-x.y.z.tar.gz&lt;/code&gt; where
"x" will indicate the major release number, "y" indicates the minor release
number, and "z" indicates the patch number of the release.&lt;/p&gt;
&lt;p&gt;In addition to the PROJ software package, distributions of datum
conversion grid files and PROJ parameter files are also available.
The grid package is distributed under the name &lt;code&gt;proj-datumgrid-x.y.zip&lt;/code&gt;,
where "x" is the major release version and "y" is the minor release
version numbers. Similarly regional packages are distributed. The
regional packages contain resources that are not essential to the
functionality of PROJ but still of value to users in the region
specific to the package. All grids that were in proj-datumgrids-1.6
remain in proj-datumgrids-1.7; the regional datumgrid files contain
grids for datums not previously supported (prior to PROJ 5.0.0).&lt;/p&gt;
&lt;p&gt;The resource packages can be downloaded from the &lt;a href="https://proj.org/download.html" rel="nofollow"&gt;PROJ website&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;More info on the contents of the various resource packages can be
found at the
&lt;a href="https://github.com/OSGeo/proj-datumgrid"&gt;proj-datumgrid GitHub repository&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The resource file packages should be extracted to &lt;code&gt;PROJ_LIB&lt;/code&gt;
where PROJ will find them after installation. The default location of
&lt;code&gt;PROJ_LIB&lt;/code&gt; on UNIX-based systems is &lt;code&gt;/usr/local/share/proj&lt;/code&gt; but it may
be changed to a different directory. On Windows you have to define
&lt;code&gt;PROJ_LIB&lt;/code&gt; yourself.&lt;/p&gt;
&lt;h3&gt;&lt;a id="user-content-citing-proj-in-publications" class="anchor" aria-hidden="true" href="#citing-proj-in-publications"&gt;&lt;svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"&gt;&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Citing PROJ in publications&lt;/h3&gt;
&lt;p&gt;See &lt;a href="CITATION"&gt;CITATION&lt;/a&gt;&lt;/p&gt;
&lt;/article&gt;&lt;/div&gt;</description><author>OSGeo</author><guid isPermaLink="false">https://github.com/OSGeo/PROJ</guid><pubDate>Sat, 04 Jan 2020 00:05:00 GMT</pubDate></item></channel></rss>